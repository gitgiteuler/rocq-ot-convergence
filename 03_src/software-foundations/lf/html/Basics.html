<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>論理の基礎</title>
</head>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>

<body>

<div id="page">

<div id="header">
<a href='../index.html'>
<img src='common/media/image/sf_logo_sm.png'></a>
</br><a href='index.html'><span class='booktitleinheader'>第 1 巻: 論理の基礎</span></a><br></br>
<ul id='menu'>
   <a href='toc.html'><li class='section_name'>目次</li></a>
   <a href='coqindex.html'><li class='section_name'>索引</li></a>
   <a href='deps.html'><li class='section_name'>全体図</li></a>
</ul>
</div>

<div id="main">
<h1 class="libtitle">Basics: 関数プログラミングとプログラムの証明</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>
</div>

<div class="doc">
再掲：
<pre>
          ############################################################
          ### 誰もが見えるところに課題の解答を置かないでください！ ###
          ############################################################
</pre>
   （理由については <span class="inlinecode"><span class="id" title="var">Preface</span></span> を参照)
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab18"></a><h1 class="section">導入</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
関数型プログラミングスタイルは単純な数学的直観を基礎としています。
    手続きやメソッドが副作用を持たなければ、（効率を無視すれば）理解に必要なのは入力をどの出力に割り当てるかだけです。
    つまり、手続きやメソッドを、数学的な関数を計算する具体的な手法として理解することとも考えられます。
    これが「関数型プログラミング(functional programming)」における「関数型(functional)」という語の意図の一つです。
    プログラムと数学的な対象を直接関係づけることは、正当性の形式的証明やプログラムの挙動の健全な非形式的解釈という両面で役に立ちます。

<div class="paragraph"> </div>

    もう一つの関数型プログラミングが「関数型」であるという意図は、関数（やメソッド）を「一級(<i>first class</i>)」値として扱うことから来ます。
    ここで、一級値であるとは、関数の引数にしたり、関数の結果として返したり、データ構造に含めたり、といったことができることを意味します。
    関数をデータとして取り扱えることで、有用かつ強力な表現が可能になります。

<div class="paragraph"> </div>

    このほかの関数型言語に存在する機能としては、「代数的データ型(<i>algebraic data type</i>)」や「パターンマッチ(<i>pattern matching</i>)」があります。
    これらは、データ構造の構成と操作を容易にしてくれます。
    また、「多相型システム(<i>polymorphic type system</i>)」という、抽象化やコードの再利用に有用な機能もあります。
    上に挙げた機能は全てCoqに含まれています。

<div class="paragraph"> </div>

    本章の最初半分は <i>Gallina</i> と呼ばれるCoqの関数型プログラミング言語としての基本部分の紹介となります。
    後ろ半分は、Coqのプログラムの性質を示すために使う、基本的な「タクティック(<i>tactic</i>)」を説明します。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab19"></a><h1 class="section">データと関数</h1>

</div>
<div class="code">
</div>

<div class="doc">
<a name="lab20"></a><h2 class="section">列挙型</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Coqに組み込まれた機能は、「極限まで」小さいものです。
    ブール値や自然数、文字列といった基本データ型を提供する代わりに、Coqには新しい型やそれを処理するための強力な機構が用意されています。
    この機構により、よくあるデータ型は全て定義することができます。

<div class="paragraph"> </div>

    当然、配布されているCoqにはブール値や数値、リストやハッシュテーブルといったよく使われるデータ構造を定義した大規模な標準ライブラリが付属しています。
    しかし、このライブラリの定義には魔法や基底型のようなものは使われていません。
    これを説明するために、この資料では、必要となる定義をライブラリから暗黙的に得るのではなく、明示的に再現します。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab21"></a><h2 class="section">曜日の表し方</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
機構がどのように動くかを知るために、簡単な例から始めましょう。
    次の宣言によって、Coqに新しいデータの集合である「型(<i>type</i>)」を定義します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="day"><span class="id" title="inductive">day</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="monday"><span class="id" title="constructor">monday</span></a><br/>
&nbsp;&nbsp;| <a name="tuesday"><span class="id" title="constructor">tuesday</span></a><br/>
&nbsp;&nbsp;| <a name="wednesday"><span class="id" title="constructor">wednesday</span></a><br/>
&nbsp;&nbsp;| <a name="thursday"><span class="id" title="constructor">thursday</span></a><br/>
&nbsp;&nbsp;| <a name="friday"><span class="id" title="constructor">friday</span></a><br/>
&nbsp;&nbsp;| <a name="saturday"><span class="id" title="constructor">saturday</span></a><br/>
&nbsp;&nbsp;| <a name="sunday"><span class="id" title="constructor">sunday</span></a>.<br/>

<br/>
</div>

<div class="doc">
型の名前は<span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>で、要素は<span class="inlinecode"><a class="idref" href="Basics.html#monday"><span class="id" title="constructor">monday</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#tuesday"><span class="id" title="constructor">tuesday</span></a></span>...などです。

<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>が何かを定義できれば、それを利用した関数を書くこともできます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="next_weekday"><span class="id" title="definition">next_weekday</span></a> (<span class="id" title="var">d</span>:<a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a>) : <a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#monday"><span class="id" title="constructor">monday</span></a>    =&gt; <a class="idref" href="Basics.html#tuesday"><span class="id" title="constructor">tuesday</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#tuesday"><span class="id" title="constructor">tuesday</span></a>   =&gt; <a class="idref" href="Basics.html#wednesday"><span class="id" title="constructor">wednesday</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#wednesday"><span class="id" title="constructor">wednesday</span></a> =&gt; <a class="idref" href="Basics.html#thursday"><span class="id" title="constructor">thursday</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#thursday"><span class="id" title="constructor">thursday</span></a>  =&gt; <a class="idref" href="Basics.html#friday"><span class="id" title="constructor">friday</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#friday"><span class="id" title="constructor">friday</span></a>    =&gt; <a class="idref" href="Basics.html#monday"><span class="id" title="constructor">monday</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#saturday"><span class="id" title="constructor">saturday</span></a>  =&gt; <a class="idref" href="Basics.html#monday"><span class="id" title="constructor">monday</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#sunday"><span class="id" title="constructor">sunday</span></a>    =&gt; <a class="idref" href="Basics.html#monday"><span class="id" title="constructor">monday</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
一つ注意しておかなければならないことがあります。
    この関数の定義では、引数の型と戻り値の型が明示されていることです。
    他の多くの関数型プログラミング言語と同様、Coqはこのように型を明示的に書かずともちゃんと動くようになっています。
    つまりCoqは「型推論(<i>type inference</i>)」が可能なのですが、この講義ではプログラムを読みやすいように、常に型を明示することにします。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
関数の定義ができたら、いくつかの例を挙げてそれが正しいものであることをチェックしなければなりません。
    それを実現するために、Coqには三つの方法が用意されています。
    一つ目は <span class="inlinecode"><span class="id" title="keyword">Compute</span></span> コマンドを使って、関数<span class="inlinecode"><a class="idref" href="Basics.html#next_weekday"><span class="id" title="definition">next_weekday</span></a></span>を含んだ式を評価させることです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Basics.html#next_weekday"><span class="id" title="definition">next_weekday</span></a> <a class="idref" href="Basics.html#friday"><span class="id" title="constructor">friday</span></a>).<br/>

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Basics.html#next_weekday"><span class="id" title="definition">next_weekday</span></a> (<a class="idref" href="Basics.html#next_weekday"><span class="id" title="definition">next_weekday</span></a> <a class="idref" href="Basics.html#saturday"><span class="id" title="constructor">saturday</span></a>)).<br/>

<br/>
</div>

<div class="doc">
（もし今手元にコンピュータがあるなら、CoqのIDEのうち好きなもの（CoqIdeやProofGeneralなど）を選んで起動し、実際に上のコマンドを入力し動かしてみるといいでしょう。
    この本に付随するCoqのソースから <span class="inlinecode"><span class="id" title="var">Basics.v</span></span> を開き、上のサンプルを探してCoqに読み込ませ、結果を観察してください。） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
二番目の方法は、評価の結果として我々が期待しているものをCoqに対してあらかじめ以下のような形で例示しておくというものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_next_weekday"><span class="id" title="definition">test_next_weekday</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#next_weekday"><span class="id" title="definition">next_weekday</span></a> (<a class="idref" href="Basics.html#next_weekday"><span class="id" title="definition">next_weekday</span></a> <a class="idref" href="Basics.html#saturday"><span class="id" title="constructor">saturday</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#tuesday"><span class="id" title="constructor">tuesday</span></a>.<br/>

<br/>
</div>

<div class="doc">
この宣言は二つのことを行っています。
    ひとつは、<span class="inlinecode"><a class="idref" href="Basics.html#saturday"><span class="id" title="constructor">saturday</span></a></span>の次の次にあたる平日が、<span class="inlinecode"><a class="idref" href="Basics.html#tuesday"><span class="id" title="constructor">tuesday</span></a></span>であるということを確認する必要があるということを示すこと。
    もう一つは、後で参照しやすいように、その確認事項に<span class="inlinecode"><a class="idref" href="Basics.html#test_next_weekday"><span class="id" title="definition">test_next_weekday</span></a></span>という名前を与えていることです。
    この確認事項を記述すれば、次のようなコマンドを流すだけで、Coqによって正しさを検証できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
この文について細かいことは今は置いておきますが（じきに戻ってきます）、本質的には以下のような意味になります。
    「我々が作成した確認事項は等式の両辺が同じものに簡約されることで証明できます。」

<div class="paragraph"> </div>

    三番目の方法は、Coqで（<span class="inlinecode"><span class="id" title="keyword">Definition</span></span>を使って）定義したものから、もう少し普通の言語（OCamlやScheme、Haskell）のプログラムを「抽出(<i>extract</i>)」してしまうことです。
    この機能はGallinaで記述し、正しいと証明されたアルゴリズムを、効率的な機械語まで持っていくことができるという意味でとても興味深いものです。
    （もちろん、OCaml、Haskell、Schemeなどのコンパイラや、抽出機能そのものを信頼すれば、というものではあります。
    しかし、現在のソフトウェア開発からは大きな一歩であることには違いありません。）
    これはCoqの開発動機の一つです。
    この話については後の章で詳しく見ます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab22"></a><h2 class="section">宿題提出のガイドライン</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
「ソフトウェアの基礎」を講義で使用する場合、おそらく講師が宿題の採点用自動スクリプトを使うでしょう。
    このスクリプトが正常に動くように（皆さんの解答が適切に採点されるように）、以下の規則を守ってください。
<ul class="doclist">
<li> 採点スクリプトは、<span class="inlinecode">.<a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a></span>ファイルのなかから、マークのついた箇所を抜き出して採点します。
        演習問題についている「マーク付け」を変更しないでください。
        マークは、演習問題のヘッダ、名前、末尾の「空の角括弧」などです。
        これらのマークを編集したりしないでください。

</li>
<li> 演習問題自体を消さないでください。
        もし（オプションとなっていたり、解けなかったりして）演習問題を飛ばしたとしても、そのまま<span class="inlinecode">.<a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a></span>のなかに残して問題ありません。
        ただし、この場合は（<span class="inlinecode"><span class="id" title="keyword">Abort</span></span>などではなく）<span class="inlinecode"><span class="id" title="var">Admitted</span></span>で終わるようにしてください。

</li>
<li> 解答に追加の定義（補助関数、補題、など）を書くのは全く問題ありません。
        これらは課題の宣言から証明を書く場所の間に書いてください。

</li>
</ul>

<div class="paragraph"> </div>

    それぞれの章（例えば<span class="inlinecode"><span class="id" title="var">Basics.v</span></span>）には「テストスクリプト」（<span class="inlinecode"><span class="id" title="var">BasicsTest.v</span></span>）が付随しています。
    これは各章の演習問題の採点を自動で行う物です（訳注：現在の翻訳バージョンにはこのスクリプトは含まれていません）。
    このスクリプトは講師が採点を自動化するために使うのが主目的ですが、自分で規則を守っているかを確認するためにも使えます。
    ターミナルを開いて<span class="inlinecode"><span class="id" title="var">make</span></span> <span class="inlinecode"><span class="id" title="var">BasicsTest.vo</span></span>と打つか、次の二つのコマンドを打ってください。
<pre>
       coqc -Q . LF Basics.v 
       coqc -Q . LF BasicsTest.v 
</pre>
    <span class="inlinecode"><span class="id" title="var">BasicsTest.v</span></span>を編集する必要はありません（<span class="inlinecode"><span class="id" title="var">Preface.v</span></span>も不要です）。

<div class="paragraph"> </div>

    （訳注：ここには特定の課題提出システムの話がありますが、明らかに翻訳不要なので省略します） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab23"></a><h2 class="section">ブール型</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
同様にして、<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>と<span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>を値とする<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型を定義することができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="bool"><span class="id" title="inductive">bool</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a name="false"><span class="id" title="constructor">false</span></a>.<br/>

<br/>
</div>

<div class="doc">
このように我々は独自のbool型を一から作っていますが、もちろんCoqにはbool型が多くの有用な関数、補題と一緒に用意されています。
    （もし興味があるなら、Coqライブラリドキュメントの<span class="inlinecode"><span class="id" title="library">Coq.Init.Datatypes</span></span>を参照してください。）
    ここでは可能な限り標準ライブラリと同じ機能をもつ関数や定理を、同じ名前で定義していくことにしましょう。

<div class="paragraph"> </div>

    bool型を使用する関数は、Day型と同じように定義することができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="negb"><span class="id" title="definition">negb</span></a> (<span class="id" title="var">b</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="andb"><span class="id" title="definition">andb</span></a> (<span class="id" title="var">b1</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">b2</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#b1"><span class="id" title="variable">b1</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> =&gt; <a class="idref" href="Basics.html#b2"><span class="id" title="variable">b2</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="orb"><span class="id" title="definition">orb</span></a> (<span class="id" title="var">b1</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">b2</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#b1"><span class="id" title="variable">b1</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> =&gt; <a class="idref" href="Basics.html#b2"><span class="id" title="variable">b2</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
後ろ二つでは、Coqでの引数を複数持つ関数の定義の仕方を例示しています。
    対応する、複数の引数への関数適用は次の単体テスト(unit test)で示しています。
    これら単体テストは、関数<span class="inlinecode"><a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a></span>が取り得るすべての引数についての完全な仕様（真理値表）となっています。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_orb1"><span class="id" title="definition">test_orb1</span></a>:  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>  <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_orb2"><span class="id" title="definition">test_orb2</span></a>:  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_orb3"><span class="id" title="definition">test_orb3</span></a>:  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_orb4"><span class="id" title="definition">test_orb4</span></a>:  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>  <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
これらのブール演算に見慣れた表記法を導入することができます。
    <span class="inlinecode"><span class="id" title="keyword">Notation</span></span>コマンドで、定義したものに記号表記を割り当てることができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="5337a72ca9eeeb81296bec4669839306"><span class="id" title="notation">&quot;</span></a>x &amp;&amp; y" := (<a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Notation</span> <a name="7d9f7c827b426ef974af6039f1332d14"><span class="id" title="notation">&quot;</span></a>x || y" := (<a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_orb5"><span class="id" title="definition">test_orb5</span></a>:  <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#7d9f7c827b426ef974af6039f1332d14"><span class="id" title="notation">||</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#7d9f7c827b426ef974af6039f1332d14"><span class="id" title="notation">||</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
記述方法について: <span class="inlinecode">.<a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a></span> ファイルのコメントの中に Coqのコード片を含める場合には、角括弧を使用してコメントと区切ります。
    この慣習は<span class="inlinecode"><span class="id" title="var">coqdoc</span></span>というドキュメント作成ツールでも利用されているのですが、コード片を周囲のコメントから視覚的に分離することができます。
    CoqソースのHTML版では、ソースはコメントとは<span class="inlinecode">別のフォント</span>で表示されます。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="var">Admitted</span></span>コマンドにより、定義や証明を不完全な状態でひとまず埋めておくことができます。
    これは以降の練習問題で、課題として埋める箇所を示すのに使われます。
    つまり、練習問題を解くということは<span class="inlinecode"><span class="id" title="var">Admitted</span></span>と書かれた部分をちゃんとした証明に書き直す作業になります。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab24"></a><h4 class="section">練習問題: ★, standard (nandb)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="var">Admitted</span>.</span>を消し、次の関数定義を完成させなさい。
    そして<span class="inlinecode"><span class="id" title="keyword">Example</span></span>で記述された確認内容がCoqのチェックをすべて通過することを確認しなさい。
    （つまり、各テストの証明を、上の<span class="inlinecode"><a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a></span>のテストを参考にして埋めなさい。）
    この関数は引数のどちらか、もしくは両方が<span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>だったときに<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>を返すものである。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="nandb"><span class="id" title="definition">nandb</span></a> (<span class="id" title="var">b1</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">b2</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_nandb1"><span class="id" title="definition">test_nandb1</span></a>:               <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#nandb"><span class="id" title="axiom">nandb</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_nandb2"><span class="id" title="definition">test_nandb2</span></a>:               <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#nandb"><span class="id" title="axiom">nandb</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_nandb3"><span class="id" title="definition">test_nandb3</span></a>:               <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#nandb"><span class="id" title="axiom">nandb</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_nandb4"><span class="id" title="definition">test_nandb4</span></a>:               <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#nandb"><span class="id" title="axiom">nandb</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab25"></a><h4 class="section">練習問題: ★, standard (andb3)</h4>


<div class="paragraph"> </div>

    同様のことを以下の <span class="inlinecode"><a class="idref" href="Basics.html#andb3"><span class="id" title="definition">andb3</span></a></span> 関数についてしなさい。
    この関数は全ての入力が <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> である場合に <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>を返し、そうでない場合は <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span> を返すものである。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="andb3"><span class="id" title="definition">andb3</span></a> (<span class="id" title="var">b1</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">b2</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">b3</span>:<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_andb31"><span class="id" title="definition">test_andb31</span></a>:                 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#andb3"><span class="id" title="axiom">andb3</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_andb32"><span class="id" title="definition">test_andb32</span></a>:                 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#andb3"><span class="id" title="axiom">andb3</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_andb33"><span class="id" title="definition">test_andb33</span></a>:                 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#andb3"><span class="id" title="axiom">andb3</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_andb34"><span class="id" title="definition">test_andb34</span></a>:                 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#andb3"><span class="id" title="axiom">andb3</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab26"></a><h2 class="section">型</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Coqの全ての式は、どのような類のものかを表す型を持っています。
    <span class="inlinecode"><span class="id" title="keyword">Check</span></span>コマンドを使うと、Coqに、指定した式の型を表示させることができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a></span> のような関数は、それ自身が <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> や <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span> と同じように値であると考えることもできます。
    そのようにとらえた場合の値の型を「関数型(<i>function type</i>)」と呼び、以下のように矢印を使った型として表します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a></span>の型は<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>と書き、「<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>から<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>」と読み、「<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型の引数をとって<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型の戻り値を返す関数」と解釈します。
    同様に、<span class="inlinecode"><a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a></span>の型は<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>と書き、「二つの<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型の引数をとって<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型の戻り値を返す関数」と解釈します。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab27"></a><h2 class="section">既存の型から作る新しい型</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
我々がここまでで定義してきた型は「列挙型」でした。
    このような型は、有限の要素をすべて列挙することによって定義されます。
    もう少し興味深い型定義として、コンストラクタが引数を取る場合を説明します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="rgb"><span class="id" title="inductive">rgb</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="red"><span class="id" title="constructor">red</span></a><br/>
&nbsp;&nbsp;| <a name="green"><span class="id" title="constructor">green</span></a><br/>
&nbsp;&nbsp;| <a name="blue"><span class="id" title="constructor">blue</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="color"><span class="id" title="inductive">color</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="black"><span class="id" title="constructor">black</span></a><br/>
&nbsp;&nbsp;| <a name="white"><span class="id" title="constructor">white</span></a><br/>
&nbsp;&nbsp;| <a name="primary"><span class="id" title="constructor">primary</span></a> (<span class="id" title="var">p</span> : <a class="idref" href="Basics.html#rgb"><span class="id" title="inductive">rgb</span></a>).<br/>

<br/>
</div>

<div class="doc">
この例を少し細かく見ていきましょう。

<div class="paragraph"> </div>

    それぞれ帰納的に定義された型（<span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>、 <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>、 <span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>、 <span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>、などなど）は<span class="inlinecode"><span class="id" title="tactic">red</span></span>や<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#monday"><span class="id" title="constructor">monday</span></a></span>などの「コンストラクタ(<i>constructor</i>)」から作られる「コンストラクタ式(<i>constructor expressions</i>)」を含んでいます。

<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>の定義はそれぞれの型に含まれる式がどのように作られるかを表しています。

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="tactic">red</span></span>や<span class="inlinecode"><a class="idref" href="IndPrinciples.html#green"><span class="id" title="constructor">green</span></a></span>、<span class="inlinecode"><a class="idref" href="IndPrinciples.html#blue"><span class="id" title="constructor">blue</span></a></span>は<span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>のコンストラクタです。

</li>
<li> <span class="inlinecode"><a class="idref" href="Basics.html#black"><span class="id" title="constructor">black</span></a></span>や<span class="inlinecode"><a class="idref" href="ImpParser.html#white"><span class="id" title="constructor">white</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span>は<span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>のコンストラクタです。

</li>
<li> <span class="inlinecode"><span class="id" title="tactic">red</span></span>という式は<span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>の集合に属します。
      <span class="inlinecode"><a class="idref" href="IndPrinciples.html#green"><span class="id" title="constructor">green</span></a></span>や<span class="inlinecode"><a class="idref" href="IndPrinciples.html#blue"><span class="id" title="constructor">blue</span></a></span>も同様です。

</li>
<li> <span class="inlinecode"><a class="idref" href="Basics.html#black"><span class="id" title="constructor">black</span></a></span>や<span class="inlinecode"><a class="idref" href="ImpParser.html#white"><span class="id" title="constructor">white</span></a></span>といった式は<span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>の集合に属します。

</li>
<li> もし<span class="inlinecode"><a class="idref" href="Induction.html#p"><span class="id" title="variable">p</span></a></span>が<span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>に属する式ならば、<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span> <span class="inlinecode"><a class="idref" href="Induction.html#p"><span class="id" title="variable">p</span></a></span>（"引数<span class="inlinecode"><a class="idref" href="Induction.html#p"><span class="id" title="variable">p</span></a></span>に適用されたコンストラクタ<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span>"と読みます）は<span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>の集合に属します。

</li>
<li> これらによって作られる式「だけ」が<span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>の集合に含まれます。 
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>に対するものと同じように、色に関するパターンマッチを用いた関数が定義できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="monochrome"><span class="id" title="definition">monochrome</span></a> (<span class="id" title="var">c</span> : <a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#black"><span class="id" title="constructor">black</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#white"><span class="id" title="constructor">white</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a> <span class="id" title="var">q</span> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
構築子の一つである<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span>は引数を取るので、<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span>に関するパターンマッチは変数（上記の<span class="inlinecode"><a class="idref" href="Induction.html#q"><span class="id" title="variable">q</span></a></span>のように -- なお、名前は他の名前と重ならない限り自由につけられます）か、または適切な型の定数を含めなければなりません。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="isred"><span class="id" title="definition">isred</span></a> (<span class="id" title="var">c</span> : <a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#black"><span class="id" title="constructor">black</span></a> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#white"><span class="id" title="constructor">white</span></a> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a> <a class="idref" href="Basics.html#red"><span class="id" title="constructor">red</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
最後のパターン<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span> <span class="inlinecode"><span class="id" title="var">_</span></span>は「<span class="inlinecode"><a class="idref" href="Basics.html#primary"><span class="id" title="constructor">primary</span></a></span>を<span class="inlinecode"><a class="idref" href="IndPrinciples.html#rgb"><span class="id" title="inductive">rgb</span></a></span>型の<span class="inlinecode"><span class="id" title="tactic">red</span></span>以外の構築子に適用していた場合」の略記です。
    （ワイルドカードパターン <span class="inlinecode"><span class="id" title="var">_</span></span> は <span class="inlinecode"><a class="idref" href="Basics.html#monochrome"><span class="id" title="definition">monochrome</span></a></span> の定義にあるような使わない変数 <span class="inlinecode"><a class="idref" href="Induction.html#p"><span class="id" title="variable">p</span></a></span> を書くことと同じです。） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab28"></a><h2 class="section">Tuples</h2>

<div class="paragraph"> </div>

 A single constructor with multiple parameters can be used
    to create a tuple type. As an example, consider representing
    the four bits in a nybble (half a byte). We first define
    a datatype <span class="inlinecode"><a class="idref" href="Basics.html#bit"><span class="id" title="inductive">bit</span></a></span> that resembles <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> (using the
    constructors <span class="inlinecode"><a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a></span> and <span class="inlinecode"><a class="idref" href="Basics.html#B1"><span class="id" title="constructor">B1</span></a></span> for the two possible bit values),
    and then define the datatype <span class="inlinecode"><a class="idref" href="Basics.html#nybble"><span class="id" title="inductive">nybble</span></a></span>, which is essentially
    a tuple of four bits. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="bit"><span class="id" title="inductive">bit</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="B0"><span class="id" title="constructor">B0</span></a><br/>
&nbsp;&nbsp;| <a name="B1"><span class="id" title="constructor">B1</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="nybble"><span class="id" title="inductive">nybble</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="bits"><span class="id" title="constructor">bits</span></a> (<span class="id" title="var">b0</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> <span class="id" title="var">b3</span> : <a class="idref" href="Basics.html#bit"><span class="id" title="inductive">bit</span></a>).<br/>

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Basics.html#bits"><span class="id" title="constructor">bits</span></a> <a class="idref" href="Basics.html#B1"><span class="id" title="constructor">B1</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B1"><span class="id" title="constructor">B1</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a>).<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><a class="idref" href="Basics.html#bits"><span class="id" title="constructor">bits</span></a></span> constructor acts as a wrapper for its contents.
    Unwrapping can be done by pattern-matching, as in the <span class="inlinecode"><a class="idref" href="Basics.html#all_zero"><span class="id" title="definition">all_zero</span></a></span>
    function which tests a nybble to see if all its bits are O.
    Note that we are using underscore (_) as a <i>wildcard pattern</i> to
    avoid inventing variable names that will not be used. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="all_zero"><span class="id" title="definition">all_zero</span></a> (<span class="id" title="var">nb</span> : <a class="idref" href="Basics.html#nybble"><span class="id" title="inductive">nybble</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#nb"><span class="id" title="variable">nb</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<a class="idref" href="Basics.html#bits"><span class="id" title="constructor">bits</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a>) =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<a class="idref" href="Basics.html#bits"><span class="id" title="constructor">bits</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Basics.html#all_zero"><span class="id" title="definition">all_zero</span></a> (<a class="idref" href="Basics.html#bits"><span class="id" title="constructor">bits</span></a> <a class="idref" href="Basics.html#B1"><span class="id" title="constructor">B1</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B1"><span class="id" title="constructor">B1</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a>)).<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Basics.html#all_zero"><span class="id" title="definition">all_zero</span></a> (<a class="idref" href="Basics.html#bits"><span class="id" title="constructor">bits</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a> <a class="idref" href="Basics.html#B0"><span class="id" title="constructor">B0</span></a>)).<br/>

<br/>
</div>

<div class="doc">
<a name="lab29"></a><h2 class="section">モジュール</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Coqは大規模な開発を支援するために「モジュールシステム」を提供しています。
    このコースではこれらはほとんど必要のないものですが、一つだけ有用な機能があります。
    プログラムの中のいくつかの要素を<span class="inlinecode"><span class="id" title="keyword">Module</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><span class="id" title="keyword">End</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>で囲んでおくと、<span class="inlinecode"><span class="id" title="keyword">End</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>以降の部分からは、囲まれた中で<span class="inlinecode"><a class="idref" href="Imp.html#AExp.foo"><span class="id" title="lemma">foo</span></a></span>と定義したものを<span class="inlinecode"><a class="idref" href="Imp.html#AExp.foo"><span class="id" title="lemma">foo</span></a></span>ではなく<span class="inlinecode"><span class="id" title="var">X.foo</span></span>という形で呼び出すようになります。
    という訳で、今回はこの機能を使って<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>という型を内部モジュールに定義します。
    そうすることで、標準ライブラリの同じ名前の定義に干渉せずに済みます。
    （というのも、標準ライブラリの<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>には便利な記法があるので、これを使うためです。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="NatPlayground"><span class="id" title="module">NatPlayground</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab30"></a><h2 class="section">数値</h2>

<div class="paragraph"> </div>

 The types we have defined so far, "enumerated types" such as
    <span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>, <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>, and <span class="inlinecode"><a class="idref" href="Basics.html#bit"><span class="id" title="inductive">bit</span></a></span>, and tuple types such as <span class="inlinecode"><a class="idref" href="Basics.html#nybble"><span class="id" title="inductive">nybble</span></a></span> built
    from them, share the property that each type has a finite set of
    values. The natural numbers are an infinite set, and we need to
    represent all of them in a datatype with a finite number of
    constructors. There are many representations of numbers to choose
    from. We are most familiar with decimal notation (base 10), using
    the digits 0 through 9, for example, to form the number 123.  You
    may have encountered hexadecimal notation (base 16), in which the
    same number is represented as 7B, or octal (base 8), where it is
    173, or binary (base 2), where it is 1111011. Using an enumerated
    type to represent digits, we could use any of these to represent
    natural numbers. There are circumstances where each of these
    choices can be useful.

<div class="paragraph"> </div>

    Binary is valuable in computer hardware because it can in turn be
    represented with two voltage levels, resulting in simple
    circuitry. Analogously, we wish here to choose a representation
    that makes <i>proofs</i> simpler.

<div class="paragraph"> </div>

    Indeed, there is a representation of numbers that is even simpler
    than binary, namely unary (base 1), in which only a single digit
    is used (as one might do while counting days in prison by scratching
    on the walls). To represent unary with a Coq datatype, we use
    two constructors. The capital-letter <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> constructor represents zero.
    When the <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> constructor is applied to the representation of the
    natural number <i>n</i>, the result is the representation of <i>n+1</i>.
    (<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> stands for "successor", or "scratch" if one is in prison.)
    Here is the complete datatype definition. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="NatPlayground.nat"><span class="id" title="inductive">nat</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="NatPlayground.O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;| <a name="NatPlayground.S"><span class="id" title="constructor">S</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="Basics.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>

<br/>
</div>

<div class="doc">
With this definition, 0 is represented by <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>, 1 by <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>,
    2 by <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>)</span>, and so on. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
この定義の各句は、以下のように解釈できます。
<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>は自然数である（<span class="inlinecode">0</span>（数字のゼロ）ではなく<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>（アルファベットのオー）であることに注意）。

</li>
<li> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>は自然数の前に置くことで別の自然数を生成できる。つまり、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が自然数なら<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>も自然数である。 
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
もう一度この定義をより詳細に見ていきましょう。
    <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>の定義は、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>の要素となる式がどのように構築されるかを表しています。

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>と<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>はコンストラクタである。

</li>
<li> 式<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>（オー）は、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に属する。

</li>
<li> もし<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に属するならば、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>もまた<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に属する。

</li>
<li> これら二つの方法で表された式のみが<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に属するものの全てである。
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
同様のルールが<span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#color"><span class="id" title="inductive">color</span></a></span>などにも当てはまります。

<div class="paragraph"> </div>

    これらの条件によって、帰納的(<span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>)な宣言を厳格に定義しています。
    条件から、式 <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>、式 <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>、式  <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>)</span>、式 <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>))</span>...が全て<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に属する式であることがわかります。
    また同時に、<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>)</span>、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a>))</span>が<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に属さないことも明確にされています。

<div class="paragraph"> </div>

    重要な点は、ここでは数の「表現(<i>representation</i>)」、つまり書き下し方を定義したに過ぎないと言うことです。
    <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>という名前は特別な意味があるわけではなく、なんでもよいのです。
    これらは単に数を書くための異なる二つの記号でしかありません。
    （それに付随して、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>が<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>の前に並ぶことで任意の<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>が記述されるという規則もありますが。）
    望むなら、同じ定義を次のように書いても良いのです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="NatPlayground.nat'"><span class="id" title="inductive">nat'</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="NatPlayground.stop"><span class="id" title="constructor">stop</span></a><br/>
&nbsp;&nbsp;| <a name="NatPlayground.tick"><span class="id" title="constructor">tick</span></a> (<span class="id" title="var">foo</span> : <a class="idref" href="Basics.html#nat'"><span class="id" title="inductive">nat'</span></a>).<br/>

<br/>
</div>

<div class="doc">
これらの記号の「解釈(<i>interpretation</i>)」は計算でどのように使用するかによって決まります。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
そのために、<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#day"><span class="id" title="inductive">day</span></a></span>のとき同様にパターンマッチを使って、自然数の表現に対する関数を書いてみましょう。
    例えば、一つ前(predecessor)の<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>を返す関数は以下のよう書けます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatPlayground.pred"><span class="id" title="definition">pred</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
この２番目の句は「もし<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が何らかの<span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>を用いて<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>と表せるなら、<span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>を返す」と読めます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Basics.html#NatPlayground"><span class="id" title="module">NatPlayground</span></a>.<br/>

<br/>
</div>

<div class="doc">
自然数というのは非常に一般的な型なので、Coqは自然数を扱ったり表したりするときに若干特別な扱いをします。
    <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>を使った「1進数(<i>unary</i>)」表記の代わりに一般的に使われる10進数表記を使うことができます。
    実際、Coqは数値を表示する際、デフォルトでは10進数表記を用います。  訳注：1進数は記号を並べた長さで数の大きさを表します。ここでは<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>の数がそれに当たります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>)))).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="minustwo"><span class="id" title="definition">minustwo</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span>) =&gt; <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Basics.html#minustwo"><span class="id" title="definition">minustwo</span></a> 4).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>のコンストラクタ<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>は<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>型に属します。
    <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.pred"><span class="id" title="definition">pred</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#minustwo"><span class="id" title="definition">minustwo</span></a></span>などの関数と同じ型になっています。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Basics.html#minustwo"><span class="id" title="definition">minustwo</span></a>.<br/>

<br/>
</div>

<div class="doc">
これらが表しているのは、いずれの関数も数を引数にとって数を生成できる、ということです。
    しかしながら最初の一つと残り二つには根本的な違いがあります。
    <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.pred"><span class="id" title="definition">pred</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#minustwo"><span class="id" title="definition">minustwo</span></a></span>といった関数には「計算ルール(<i>computation rule</i>)」というものが定義されています。
    例えば、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.pred"><span class="id" title="definition">pred</span></a></span>の定義は、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.pred"><span class="id" title="definition">pred</span></a></span> <span class="inlinecode">2</span>が<span class="inlinecode">1</span>に簡約されることを記述したものですが、一方<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>にはそのような定義がありません。
    コンストラクタは引数に適用するという面では関数と同様ではありますが、コンストラクタは「何も」しないのです！
    コンストラクタは単に数を書くための手段でしかありません。
    （10進数表記を思い浮かべてください。
    <span class="inlinecode">1</span>という数字は計算方法などを表すのではなく、ただのデータ片にすぎません。
    <span class="inlinecode">111</span>を百十一の意味で書いているとき、百十一の具体的な表現として<span class="inlinecode">1</span>という数字を三回使っているだけなのです。）
    （訳注：ここでは「数」と「数字」を明確に使い分けています。数字はただの文字であり値ではありません。）

<div class="paragraph"> </div>

    数値を扱う多くの関数は、単なるパターンマッチだけでは記述できず、再帰が必要になってきます。
    例えば、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が偶数かどうかを調べて返す関数<span class="inlinecode"><a class="idref" href="Basics.html#evenb"><span class="id" title="definition">evenb</span></a></span>は、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>-2</span>が偶数であるかどうかを調べる、という再帰的な定義を必要とします。
    そういう関数を定義する場合、<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>というキーワードを使用します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="evenb"><span class="id" title="definition">evenb</span></a> (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>        =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>      =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span>) =&gt; <a class="idref" href="Basics.html#evenb"><span class="id" title="definition">evenb</span></a> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
同じように<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>を使って関数<span class="inlinecode"><a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a></span>を定義することもできますが、ここでは次のようにもっとシンプルな方法で作ります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="oddb"><span class="id" title="definition">oddb</span></a> (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>   :=   <a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="Basics.html#evenb"><span class="id" title="definition">evenb</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>).<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_oddb1"><span class="id" title="definition">test_oddb1</span></a>:    <a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_oddb2"><span class="id" title="definition">test_oddb2</span></a>:    <a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a> 4 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
（1ステップずつ実行していくと、ここでは<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>がゴールに何も起こしていないことに気づくかもしれません。
    実際のところ、この証明は<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>が全てを担っています。
    なぜこうなるのかすぐ後で述べます。）

<div class="paragraph"> </div>

    当然ながら、引数を複数持つ関数も再帰的に定義することができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="NatPlayground2"><span class="id" title="module">NatPlayground2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatPlayground2.plus"><span class="id" title="definition">plus</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#plus"><span class="id" title="definition">plus</span></a> <span class="id" title="var">n'</span> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
3に2を加えた結果は、5になるべきですね。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Basics.html#NatPlayground2.plus"><span class="id" title="definition">plus</span></a> 3 2).<br/>

<br/>
</div>

<div class="doc">
Coqがこの計算をどう進めて（簡約して）結論を導くかは以下のように表現できます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>))) (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>))<br/>
==&gt; <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>)) (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> の二つ目の節での置き換え<br/>
==&gt; <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>) (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> の二つ目の節での置き換え<br/>
==&gt; <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> の二つ目の節での置き換え<br/>
==&gt; <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> の一つ目の節での置き換え
<div class="paragraph"> </div>

</span> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
表記を簡便にするため、複数の引数が同じ型を持つときは、型の記述をまとめることができます。
    <span class="inlinecode">(<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a>)</span>は<span class="inlinecode">(<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a>)</span> <span class="inlinecode">(<a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a>)</span>と書いたのとまったく同じ意味になります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatPlayground2.mult"><span class="id" title="definition">mult</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt; <a class="idref" href="Basics.html#NatPlayground2.plus"><span class="id" title="definition">plus</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> (<a class="idref" href="Basics.html#mult"><span class="id" title="definition">mult</span></a> <span class="id" title="var">n'</span> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatPlayground2.test_mult1"><span class="id" title="definition">test_mult1</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#NatPlayground2.mult"><span class="id" title="definition">mult</span></a> 3 3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 9.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
matchに引数を与える際、複数の引数を次のようにカンマで区切って一度に渡すことができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatPlayground2.minus"><span class="id" title="definition">minus</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>, <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>   , <span class="id" title="var">_</span>    =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">_</span> , <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a>    =&gt; <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m'</span> =&gt; <a class="idref" href="Basics.html#minus"><span class="id" title="definition">minus</span></a> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Basics.html#NatPlayground2"><span class="id" title="module">NatPlayground2</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="exp"><span class="id" title="definition">exp</span></a> (<span class="id" title="var">base</span> <span class="id" title="var">power</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#power"><span class="id" title="variable">power</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">p</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#mult"><span class="id" title="abbreviation">mult</span></a> <a class="idref" href="Basics.html#base"><span class="id" title="variable">base</span></a> (<a class="idref" href="Basics.html#exp"><span class="id" title="definition">exp</span></a> <a class="idref" href="Basics.html#base"><span class="id" title="variable">base</span></a> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab31"></a><h4 class="section">演習問題: ★, standard (factorial)</h4>


<div class="paragraph"> </div>

    数学での一般的な階乗(factorical)関数の定義を思い出してください :
<pre>
       factorial(0)  =  1 
       factorial(n)  =  n * factorial(n-1)     (if n&gt;0) 
</pre>
    これをCoqでの定義に書き直しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="factorial"><span class="id" title="definition">factorial</span></a> (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_factorial1"><span class="id" title="definition">test_factorial1</span></a>:          <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#factorial"><span class="id" title="axiom">factorial</span></a> 3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 6.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_factorial2"><span class="id" title="definition">test_factorial2</span></a>:          <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#factorial"><span class="id" title="axiom">factorial</span></a> 5<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#mult"><span class="id" title="abbreviation">mult</span></a> 10 12<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
表記法を利用して、加算、減算、乗算のような数値を扱う式をずっと読みやすく、書きやすくしておきます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">&quot;</span></a>x + y" := (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">&quot;</span></a>x - y" := (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#minus"><span class="id" title="abbreviation">minus</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">&quot;</span></a>x * y" := (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#mult"><span class="id" title="abbreviation">mult</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">nat_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a>0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 1).<br/>

<br/>
</div>

<div class="doc">
（<span class="inlinecode"><span class="id" title="keyword">level</span></span>、<span class="inlinecode"><span class="id" title="keyword">associativity</span></span>、<span class="inlinecode"><span class="id" title="var">nat_scope</span></span>という記述は、Coqのパーザーにこれらの表記法をどう扱うかを指示するものです。
    詳細は重要ではないのですが、もし興味があれば本章の末尾にある「表記法をより詳しく」の項を読んでください。）

<div class="paragraph"> </div>

    これらは、これまで我々が定義してきたものを何ら変えるわけではありません。
    NotationはCoqのパーサに対して<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>を<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>と解釈させたり、逆に<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>を<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>と表記させたりするためのものです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
最初の方で、Coqにはほとんど何も用意されていない、という話をしましたが、実際に、数値を比較する関数すら自分で作れる演算なのです！

<div class="paragraph"> </div>

    では自然数を比較して等しい(<span class="inlinecode"><a class="idref" href="ProofObjects.html#MyEquality.eq"><span class="id" title="inductive">eq</span></a></span>uality)かを<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span>ool値で返す<span class="inlinecode"><a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a></span>関数を定義します。
    入れ子になった<span class="inlinecode"><span class="id" title="keyword">match</span></span>に気をつけて、以下のソースを読んでください。
    （<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground2.minus"><span class="id" title="definition">minus</span></a></span>同様に、二つの変数を一度に<span class="inlinecode"><span class="id" title="keyword">match</span></span>させる方法でも書けます。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="eqb"><span class="id" title="definition">eqb</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m'</span> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m'</span> =&gt; <a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
似たようにして、<span class="inlinecode"><a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a></span>関数は一つ目の自然数が二つ目の自然数より小さい(less than)か等しい(equal)か、ということをbool値で返します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="leb"><span class="id" title="definition">leb</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m'</span> =&gt; <a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a> <span class="id" title="var">n'</span> <span class="id" title="var">m'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_leb1"><span class="id" title="definition">test_leb1</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a> 2 2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_leb2"><span class="id" title="definition">test_leb2</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a> 2 4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_leb3"><span class="id" title="definition">test_leb3</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a> 4 2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Since we'll be using these (especially <span class="inlinecode"><a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a></span>) a lot, let's give
    them infix notations. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">&quot;</span></a>x =? y" := (<a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&quot;</span></a>x &lt;=? y" := (<a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">nat_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_leb3'"><span class="id" title="definition">test_leb3'</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a>4 <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab32"></a><h4 class="section">練習問題: ★, standard (ltb)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Basics.html#ltb"><span class="id" title="definition">ltb</span></a></span>関数は、二つの自然数を比較して小さい(<span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span>ess-<span class="inlinecode"><a class="idref" href="ImpParser.html#t"><span class="id" title="variable">t</span></a></span>han)か、ということを<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span>ool値で返します。
    <span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>を使用して1から作成するのではなく、すでにこれまで定義した関数を利用して定義しなさい。
    （他の関数一つで定義できますが、二つ使ってもかまいません。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="ltb"><span class="id" title="definition">ltb</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="558f8b76d149cdb311ec341fe9014aa8"><span class="id" title="notation">&quot;</span></a>x &lt;? y" := (<a class="idref" href="Basics.html#ltb"><span class="id" title="axiom">ltb</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">nat_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_ltb1"><span class="id" title="definition">test_ltb1</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#ltb"><span class="id" title="axiom">ltb</span></a> 2 2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_ltb2"><span class="id" title="definition">test_ltb2</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#ltb"><span class="id" title="axiom">ltb</span></a> 2 4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_ltb3"><span class="id" title="definition">test_ltb3</span></a>:             <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#ltb"><span class="id" title="axiom">ltb</span></a> 4 2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab33"></a><h1 class="section">簡約を用いた証明</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
ここまでに、いくつかの型や関数を定義してきました。
    が、ここからは少し目先を変えて、こういった型や関数の特性や振る舞いをどうやって記述、証明していくかを考えてみることにしましょう。
    実際には、すでにこれまでやってきたことでも、その一部に触れています。
    例えば、これまでのセクションの<span class="inlinecode"><span class="id" title="keyword">Example</span></span>は、ある関数にある特定の値を入力した時の振る舞いについて、あらかじめ想定していたものと正確に一致していると主張してくれます。
    それらの主張が証明しているものは、以下のものと同じです。
    「<span class="inlinecode">=</span>の両側の式を簡約した結果が一致しているかを調べるために、<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>を使って両辺を簡単にして、<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>を使いなさい。」

<div class="paragraph"> </div>

    このような「簡約を用いた証明」は、関数のさらに興味深い性質をうまく証明することができます。
    例えば、<span class="inlinecode">0</span>が自然数の加算における左単位元（左から加えても値が変わらない値）であることの証明は、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が何であっても<span class="inlinecode">0</span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>を注意深く縮小（簡約）したものが<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>になることを、<span class="inlinecode">+</span>という関数が「最初の引数を引き継いで再帰的に定義されている」ということを考慮した上で示せればいいということです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_O_n"><span class="id" title="lemma">plus_O_n</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>, 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
（訳注：原文ではここでHTMLと<span class="inlinecode">.<a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a></span>ファイルの見え方の違いが説明されているのですが、日本語訳ではHTML側での大きな表記の変更を行わないようにしています。
    翻訳版の特徴として、HTMLには表示されませんが、<span class="inlinecode">.<a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a></span>ファイルには、（begin hide/end hideというコメントで挟まれた）英語の原文と訳文が交互に記述されています。
    もし訳文を読みづらい、内容が怪しいと感じた場合には、直前にある原文も参照してみてください。）

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>はこれまでの使い方よりももっと強力です。
    ここまでの例では<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>を使っていましたが、実際にはこれは必要ではありません。
    <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>は両辺が等しいかを確かめる際にある程度自動で簡約します。
    <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>は単に、証明終了前の簡約後の途中状態をみるために書いています。
    以下は証明をより短く書いたものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_O_n'"><span class="id" title="lemma">plus_O_n'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>, 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>は<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>より多くの簡約を行います。
    例えば、定義した項を定義の右辺に置き換える「展開(unfolding)」を行います。
    こう言った差が発生する理由は、<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>が成功するなら、簡約結果がどうなっているかを出す必要がないからです。
    <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>の場合はこうは行かず、簡約した結果を画面に出すため、定義をむやみに展開したりしません。

<div class="paragraph"> </div>

    この定理と証明の様式は、以前示した例とほとんど同じですが、いくつか違いがあります。

<div class="paragraph"> </div>

    まず、<span class="inlinecode"><span class="id" title="keyword">Example</span></span>の代わりに<span class="inlinecode"><span class="id" title="keyword">Theorem</span></span>キーワードが使用されていることです。
    これはほとんど単なるスタイルの違いで、<span class="inlinecode"><span class="id" title="keyword">Example</span></span>と<span class="inlinecode"><span class="id" title="keyword">Theorem</span></span>（他にも<span class="inlinecode"><span class="id" title="keyword">Lemma</span></span>、<span class="inlinecode"><span class="id" title="keyword">Fact</span></span>、<span class="inlinecode"><span class="id" title="keyword">Remark</span></span>など）はCoqから見るとすべてほぼ同じ意味です。

<div class="paragraph"> </div>

    他に、量化子（<span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>:<a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>）が加えられていることが挙げられます。
    これにより、定理は「全ての」自然数<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>について言及できます。
    非形式的には、こういった定理の証明ではまず「ある数<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が存在して...」と始めます。
    形式的には、この動きは<span class="inlinecode"><span class="id" title="tactic">intros</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>によって実現できます。
    実際には、これは量化子をゴールから仮定の「文脈(<i>context</i>)」に移動しています。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">intros</span></span>や<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>、<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>は「タクティック(<i>tactic</i>)」の例です。
    タクティックは、<span class="inlinecode"><span class="id" title="keyword">Proof</span></span>と<span class="inlinecode"><span class="id" title="keyword">Qed</span></span>の間に記述され、示そうとしている言明を確かめる方法を表します。
    本章の残りでは、まだ出てきていないタクティックのうちのいくつかを紹介していきましょう。
    さらにその後の講義ではもっと色々出てきます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
似た定理も、同じパターンで証明できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_1_l"><span class="id" title="lemma">plus_1_l</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>, 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="mult_0_l"><span class="id" title="lemma">mult_0_l</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>, 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
定理の名前についている<span class="inlinecode"><span class="id" title="var">_l</span></span>という接尾辞は、「左の」と読みます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
文脈やゴールがどのように変化していくかを見ていきましょう。
    <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>を<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>の前に呼ぶことで、等価かを判定する前に簡約できます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab34"></a><h1 class="section">書き換え（<span class="inlinecode"><span class="id" title="var">Rewriting</span></span>）による証明</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
ここまでの定理より、もう少し面白い定理を見てみましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_id_example"><span class="id" title="lemma">plus_id_example</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a>.<br/>

<br/>
</div>

<div class="doc">
この定理は、あらゆる<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>について成り立つと言っているわけではなく、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>が成り立つときに限って成立する、というものです。
    この矢印は"ならば"と読みます。

<div class="paragraph"> </div>

    前と同じように、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>と<span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>をある数として仮定する必要があります。
    また、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>という仮定を置く必要もあります。
    <span class="inlinecode"><span class="id" title="tactic">intros</span></span>タクティックはこれら三つを全てゴールから仮定の文脈に移動します。

<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>と<span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>が両方とも任意の数なのですから、これまでの証明でやってきたように簡約することはできません。
    その代わりに、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>ならば、イコールの両側の<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>を<span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>に書き換えても等しさは変わらない、というところに注目します。
    このような書き換えをしてくれるのが<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>タクティックです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
証明の1行目は、全称量化子（forall）がついた、つまり「あらゆる<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>,<span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>について」の部分をコンテキストに移しています。
    2行目は、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>ならば、という仮定をコンテキストに移し、<span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span>という名前をこれに与えています。
    3行目は、ゴールになっている式(<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>)に仮定<span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span>の左側を右側にするような書き換えを施しています。

<div class="paragraph"> </div>

    （<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>の矢印は含意とは関係ありません。
    左側を右側に置き換えよ、という指示を出しているだけです。
    逆に右側を左側に置き換えたい場合は、<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span> <span class="inlinecode">&lt;-</span>と書きます。
    この逆の置き換えも上の証明で試して、どのように変わるかを観察してください。） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab35"></a><h4 class="section">練習問題: ★, standard (plus_id_exercise)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="var">Admitted</span>.</span>を削除し、証明を完成させなさい。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_id_exercise"><span class="id" title="lemma">plus_id_exercise</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> <span class="id" title="var">o</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#o"><span class="id" title="variable">o</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">Admitted</span></span>コマンドは、Coqに対して「この証明はあきらめたので、この定理はこれでいいことにしてください」と指示するものです。
    この機能は、より長い証明をする際に便利です。
    何か大きな論証を構築しているときには、今のところ信用している補足的な命題を示したいことがあります。
    そんな時、<span class="inlinecode"><span class="id" title="var">Admitted</span></span>を使用すると、その命題を一時的に信用できることにして、主としている論証がうまくいくまで続けられます。
    そしてそれが完成したのち、あらためて保留していた命題の証明を埋めればいいのです。
    ただし注意して下さい。
    <span class="inlinecode"><span class="id" title="var">Admitted</span></span>を使用することは、一時的にドアを開けて、「全て形式的なチェックを受け証明済みの、信用するに足るCoqの世界」から、信用に値しない下界へ足を踏み出していることに他なりません。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>タクティックを使うときには、仮定の代わりに、前もって証明された定理も利用できます。
    以下のように、利用する定理の言明が量化子付きの場合、Coqがゴールに合う形に具体化しようとします。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="mult_0_plus"><span class="id" title="lemma">mult_0_plus</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a>0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -&gt; <a class="idref" href="Basics.html#plus_O_n"><span class="id" title="lemma">plus_O_n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab36"></a><h4 class="section">練習問題: ★★, standard (mult_S_1)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="mult_S_1"><span class="id" title="lemma">mult_S_1</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a>1 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
（注意：この証明は<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>以外のタクティックでできますが、ここでは課題のためと思って<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>を使ってください。）

<div class="paragraph"> </div>

    <font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab37"></a><h1 class="section">場合分け(Case Analysis)による証明</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
もちろん、どんな命題でも簡単な計算や書き換えだけで証明できるという訳ではありません。
    一般に、未知だったり仮定の値（任意の自然数、bool値、リストなど）は、簡単化を止めてしまいます。
    例えば、下の命題を<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>タクティックだけで証明しようとすると、すぐに行き詰まってしまいます。
    （そういう場合は諦めたことを表すために<span class="inlinecode"><span class="id" title="keyword">Abort</span></span>コマンドを使います。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_1_neq_0_firsttry"><span class="id" title="lemma">plus_1_neq_0_firsttry</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 1<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
その原因は、<span class="inlinecode"><a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a></span>と<span class="inlinecode">+</span>の定義で、共に最初の引数が<span class="inlinecode"><span class="id" title="keyword">match</span></span>に渡されていることです。
    つまり、<span class="inlinecode">+</span>に渡す最初の引数は<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>という未知数な上に、<span class="inlinecode"><a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a></span>の引数は<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1</span>という複合式になっているため、そのまま簡約できないのです。

<div class="paragraph"> </div>

    証明を進めるには、<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>を何らかの条件に分割できないかの検討が必要です。
    もし<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>なら、<span class="inlinecode">(<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1)</span> <span class="inlinecode">=?</span> <span class="inlinecode">0</span>の結果を得ることはできます。
    もちろん結果は<span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>です。
    もし<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が何かの<span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>を使って<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>と表せる場合、我々は<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1</span>の値を得ることはできません。
    ただ、少なくともその式が一つの<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>で始まることはわかります。
    これが分かれば、<span class="inlinecode">(<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1)</span> <span class="inlinecode">=?</span> <span class="inlinecode">0</span>の結果が<span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>になることまでは計算できます。

<div class="paragraph"> </div>

    このことから、求められるタクティックはCoqに<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>の場合と<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>の場合に分けて考えるように求めるもので、これを実現するのが<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>タクティックです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_1_neq_0"><span class="id" title="lemma">plus_1_neq_0</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 1<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n'</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
この証明では、<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>タクティックは二つのサブゴールを作っています。
    その両方を別々に証明することで、全体が定理として認められます。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>についている注釈"<span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode">[|</span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a>]</span>"は、「イントロパターン(<i>intro pattern</i>)」と呼ばれるものです。
    これはCoqに対して、サブゴール毎に出てくる変数をどんな変数名で扱うかを指示するものです。
    一般的に<span class="inlinecode">[]</span>の間にあるものは <span class="inlinecode">|</span> によって区切った「名前のリスト」のリストです。
    今回のリストの最初の要素は空ですが、これは<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>の最初のコンストラクタである<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>が引数をとらないからです。
    二つ目のコンストラクタ<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>は引数を一つ取りますので、二つ目の要素では変数名を一つ、<span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>を指定しています。

<div class="paragraph"> </div>

    それぞれのサブゴールで、Coqは<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span>だったか、それともある<span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>に対して<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>と表されるのだったかを覚えています。
    <span class="inlinecode"><span class="id" title="var">eqn</span>:<span class="id" title="var">E</span></span>という注釈はこの等式を<span class="inlinecode"><span class="id" title="var">E</span></span>という名前で覚えておくように<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>に要求します。
    （<span class="inlinecode"><span class="id" title="var">eqn</span>:<span class="id" title="var">E</span></span>を書かない場合、Coqはこれらの等式を覚えておきません。
    もしこの等式を使わないのであれば覚えないのは合理的なのですが、実際にはサブゴールで何を示そうとしているのかを明記するために覚えさせた方がよいでしょう。）

<div class="paragraph"> </div>

    二行目と三行目にある<span class="inlinecode">-</span>という記号は「バレット(<i>bullet</i>)」と呼ばれるもので、ある時点で存在したサブゴールそれぞれの証明の開始を表しています。
    バレットの後ろに続く証明スクリプトは、あるサブゴールの一連の証明になります。
    この例では、どちらのサブゴールも単に<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>による簡単化と比較で証明できています。
    例えば、二つ目は <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1)</span> を <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1)</span> に書き換え、 <span class="inlinecode"><a class="idref" href="Basics.html#eqb"><span class="id" title="definition">eqb</span></a></span> の定義を展開し、最後に <span class="inlinecode"><span class="id" title="keyword">match</span></span> を簡単化することで、 <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode">1)</span> <span class="inlinecode">?=</span> <span class="inlinecode">0</span> 全体を <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span> に簡単化します。

<div class="paragraph"> </div>

    バレットを付けるのは必須ではありません。
    もしバレットがないと、Coqは単に、順に次々とサブゴールの証明を求めます。
    しかし、バレットを使っておくと、証明の構成がはっきり見え、読みやすくなります。
    また、バレットによって、次のサブゴールに行く前に、一つ前のサブゴールが証明完了していることを確かめることができ、証明が混ざったりすることを防げます。
    大規模になると、証明が壊れたときのデバッグが非常に難しくなるため、こういった要素が重要になります。

<div class="paragraph"> </div>

    Coqでの証明の書き方の、厳格なルールというものはありません。
    特に、どこで行を折り返すか、証明のネストを表すための字下げをどの単位で行うか、などは全く決まっていません。
    しかし、複数のゴールができたときにバレットを明示すれば、他の部分をどうしても大体読みやすくなるでしょう。

<div class="paragraph"> </div>

    一行の長さについて少し語っておきます。
    Coq初心者の中には極端な人がいて、一行に一つのタクティックしか書かない人や、一行に全ての証明を詰め込む人がいます。
    好い加減というのは、大体その間にあります。
    一行を80文字に押さえるというのは扱いやすい慣習の一つです。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>タクティックは帰納的に定義された型に対して使用できます。
    例として、bool値の否定が対合(<i>involutive</i>)であること、つまり否定の否定が元と同じになることを証明してみましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="negb_involutive"><span class="id" title="lemma">negb_involutive</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
ここで使われている<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>には<span class="inlinecode"><span class="id" title="keyword">as</span></span>句がありませんが、ここで展開している<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span>の型<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>の二つのコンストラクタが両方とも引数をとらないため、名前を指定する必要がないのです。
    このような場合、"<span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode">[|]</span>"や"<span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode">[]</span>"のように書くこともできます。
    実は、<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>の<span class="inlinecode"><span class="id" title="keyword">as</span></span>句はどんなときでも省略可能です。
    その際はCoqの側で自動的に変数名をつけてくれます。
    しかし、これはあまりよくない書き方でもあります。
    Coqに任せておくと、しばしば混乱しやすい名前を付けるからです。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>を、まだ他のサブゴールが残っている状態で使うこともあります。
    このとき、バレットを使うときは異なる「レベル」を表すために異なる記号をバレットとして使います。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="andb_commutative"><span class="id" title="lemma">andb_commutative</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Eb</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
2つ並んだ<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>は、その直前の行の<span class="inlinecode"><span class="id" title="tactic">destruct</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span>を実行することで作られたサブゴールに対応しています。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
バレットとしては、<span class="inlinecode">-</span>や<span class="inlinecode">+</span>の他に<span class="inlinecode">*</span> （アスタリスク）が使用できます。
    また、証明のブロックを波括弧（<span class="inlinecode">{}</span>）で囲むこともできます。
    これは、3つ以上のレベルでサブゴールが出来てしまった場合に有用です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="andb_commutative'"><span class="id" title="lemma">andb_commutative'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Eb</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">reflexivity</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
この例のように、波括弧で証明の始めと終わりを囲むことで、ネストしてレベルを表現することができます。
    また、波括弧で囲むことで、既にバレットとして使ってしまった記号を再利用することができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="andb3_exchange"><span class="id" title="lemma">andb3_exchange</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>, <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> (<a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a>) <a class="idref" href="Basics.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> (<a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#d"><span class="id" title="variable">d</span></a>) <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">b</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Eb</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ec</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">d</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ed</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
この章を締めくくる前に、便利な記法を一つ挙げておきます。
    既に気づいたかもしれませんが、変数の場合分けは、以下のように変数の導入直後に行われることが多々あります。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>. <span class="id" title="tactic">destruct</span> <a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">as</span> [|<a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>] <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.
<div class="paragraph"> </div>

</span>    この書き方があまりに多いので、Coqではこの簡略版として、導入する変数を、名前の代わりにイントロパターンによって導入することができます。
    例えば上で証明した <span class="inlinecode"><a class="idref" href="Basics.html#plus_1_neq_0"><span class="id" title="lemma">plus_1_neq_0</span></a></span> にその略記法を使うと以下のようになります。
    （ただし欠点もあります。
    この略記法では、これまで <span class="inlinecode"><span class="id" title="var">eqn</span>:<span class="id" title="var">E</span></span> を使って覚えていた等式が残らなくなってしまいます。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus_1_neq_0'"><span class="id" title="lemma">plus_1_neq_0'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 1<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [|<span class="id" title="var">n</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
もし全ての場合で名前を付ける必要がないのなら、<span class="inlinecode">[]</span>と書くことができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="andb_commutative''"><span class="id" title="lemma">andb_commutative''</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [] [].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab38"></a><h4 class="section">練習問題: ★★, standard (andb_true_elim2)</h4>


<div class="paragraph"> </div>

    以下の言明を、<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>を使ったときの場合分けそれぞれにバレットを使用して証明しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="andb_true_elim2"><span class="id" title="lemma">andb_true_elim2</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab39"></a><h4 class="section">練習問題: ★, standard (zero_nbeq_plus_1)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="zero_nbeq_plus_1"><span class="id" title="lemma">zero_nbeq_plus_1</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;0 <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 1<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab40"></a><h2 class="section">オプション：表記法をより詳しく</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
（「オプション」と付けた節は、他の章で同じく「オプション」と付いている節以外には必須ではありません。
    初めて読むときは、今後のために軽く目を通すくらいにしておくと良いでしょう。）

<div class="paragraph"> </div>

    中置記法の加算と乗算の記法の定義を再掲します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">&quot;</span></a>x + y" := (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">&quot;</span></a>x * y" := (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#mult"><span class="id" title="abbreviation">mult</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">nat_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Coqで表記法を定義する際、「優先度(<i>precedence level</i>)」と「結合性(<i>associativity</i>)」を定義できます。
    優先度に <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> を割り当てる際には<span class="inlinecode"><span class="id" title="tactic">at</span></span> <span class="inlinecode"><span class="id" title="keyword">level</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>のように書きます。
    優先度は、Coqが複雑な式を解釈するのに使います。
    結合性は同じ表記法が複数回現れたときの解釈を定めるために付けます。
    例えば、この章では<span class="inlinecode">+</span>と<span class="inlinecode">*</span>を定義しましたので、<span class="inlinecode">1+2*3*4</span>を<span class="inlinecode">(1+((2*3)*4))</span>の略記版として利用できます。
    Coqでは優先度として0から100のレベルを、また結合性として「左結合(left)」「右結合(right)」または「結合性なし(no)」を指定できます。
    これ以降、例えば<span class="inlinecode"><span class="id" title="library">Lists</span></span>の章などで、これらの宣言が多数使われます。

<div class="paragraph"> </div>

    Coqでの表記法は、それぞれが「表記スコープ(<i>notation scope</i>)」と関連します。
    今どの表記スコープで書かれているかは、Coqが自動で判定しようとします。
    例えば<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a>(<a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>*<a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a>)</span>と書いていれば<span class="inlinecode"><span class="id" title="var">nat_scope</span></span>だと判定し、デカルト積（タプル）型（後の章で出ます）である<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>*<a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>という記述からは<span class="inlinecode"><span class="id" title="var">type_scope</span></span>と判定します。
    判定を誤ることもあるので、パーセント記号を使って、<span class="inlinecode">(<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>*<a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>)%<a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>のように明示しないといけないこともあります。
    また、Coqが特定の表記スコープでの表記法であることを明示するために<span class="inlinecode">%<a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>という記法を使うこともあります。

<div class="paragraph"> </div>

    表記スコープは<span class="inlinecode">3</span>,<span class="inlinecode">4</span>,<span class="inlinecode">5</span>などの数の表記法にも使われます。
    例えば<span class="inlinecode">0%<a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>と書くと本章で使っている自然数（<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>）の<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>を意味しますが、<span class="inlinecode">0%<a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a></span>と書くと標準ライブラリで提供されている整数（<span class="inlinecode"><a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a></span>）のゼロを意味します。

<div class="paragraph"> </div>

    プロ向け情報：Coqの表記法の記法はそれほど強力ではありません。
    過剰な期待はやめましょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab41"></a><h2 class="section">オプション：<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>と構造的再帰</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
加算の定義をそのまま持ってきました。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="plus'"><span class="id" title="definition">plus'</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">n'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Basics.html#plus'"><span class="id" title="definition">plus'</span></a> <span class="id" title="var">n'</span> <a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
上の定義をCoqが検査すると、<span class="inlinecode"><a class="idref" href="Basics.html#plus'"><span class="id" title="definition">plus'</span></a></span>が「第一引数が減少している（"decreasing on 1st argument"）」というメッセージを出します。
    これは引数<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>に関する「構造的再帰(<i>structural recursion</i>)」を行っていることを意味します。
    つまり、再帰呼び出しの際には、必ず<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>が厳密に小さくなっているということです。
    これにより、どんな引数でも<span class="inlinecode"><a class="idref" href="Basics.html#plus'"><span class="id" title="definition">plus'</span></a></span>の呼び出しが必ずいつか終了することを保証できます。
    Coqは<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>での定義で、ある特定の引数が「減少している」ことを求めます。

<div class="paragraph"> </div>

    この要求はCoqの設計の基礎部分から来ています。
    この要求により、Coqで定義できる関数が、どんな入力に対しても終了することを保証できます。
    しかし、Coqの「減少性解析」はそれほど洗練されていないため、場合によっては関数を不自然な形で書かなければならないこともあります。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab42"></a><h4 class="section">練習問題: ★★, standard, optional (decreasing)</h4>


<div class="paragraph"> </div>

    これを具体的に感じるため、（自然数の単純な関数でかまわないので）全ての入力で停止するが、Coqが制限のため受け入れないような<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>による定義の書き方を見つけなさい。
    （もしこれを宿題として解く場合は、Coqがこのファイルを受け入れられるように、回答をコメントアウトしなさい。） 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab43"></a><h1 class="section">発展課題</h1>

<div class="paragraph"> </div>

 Each SF chapter comes with a tester file (e.g.  <span class="inlinecode"><span class="id" title="var">BasicsTest.v</span></span>),
    containing scripts that check most of the exercises. You can run
    <span class="inlinecode"><span class="id" title="var">make</span></span> <span class="inlinecode"><span class="id" title="var">BasicsTest.vo</span></span> in a terminal and check its output to make
    sure you didn't miss anything. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab44"></a><h4 class="section">練習問題: ★, standard (identity_fn_applied_twice)</h4>


<div class="paragraph"> </div>

    ここまでで学んだタクティックを使い、次のブール関数についての定理を証明しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="identity_fn_applied_twice"><span class="id" title="lemma">identity_fn_applied_twice</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">f</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><span class="id" title="keyword">forall</span> (<span class="id" title="var">x</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>), <a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>), <a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab45"></a><h4 class="section">Exercise: ★, standard (negation_fn_applied_twice)</h4>


<div class="paragraph"> </div>

    また、<span class="inlinecode"><span class="id" title="var">negation_fn_applied_twice</span></span>という名前で、
    上の定理とほとんど同じで、二つ目の<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>に関する仮定が<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>になっている定理を記述し、証明しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#"><span class="id" title="library">String</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_negation_fn_applied_twice"><span class="id" title="definition">manual_grade_for_negation_fn_applied_twice</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab46"></a><h4 class="section">練習問題: ★★★, standard, optional (andb_eq_orb)</h4>


<div class="paragraph"> </div>

    次の定理を証明しなさい。
    （ヒント：証明方針によっては、かなりトリッキーな手法が必要になるでしょう。
    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>と<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>のどちらも必要でしょうが、手当たり次第に展開するのは良策ではありません。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="andb_eq_orb"><span class="id" title="lemma">andb_eq_orb</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span> <span class="id" title="var">c</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#orb"><span class="id" title="definition">orb</span></a> <a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#c"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab47"></a><h4 class="section">練習問題: ★★★, standard (binary)</h4>


<div class="paragraph"> </div>

    1進数による自然数の表現と同様の考えから、二つのコンストラクタ <span class="inlinecode"><a class="idref" href="Basics.html#A"><span class="id" title="constructor">A</span></a></span> と <span class="inlinecode"><a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a></span> （それぞれ0と1を表します）が並び、<span class="inlinecode"><a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a></span>で終わる列によって、より効率的な2進数を定義できます。
    なお、1進数での自然数は、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>が並び、<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span>で終わる列で表されていました。

<div class="paragraph"> </div>

    例：
<pre>
        10進数               2進数                           1進数
           0                   Z                              O
           1                 B Z                            S O
           2              A (B Z)                        S (S O)
           3              B (B Z)                     S (S (S O))
           4           A (A (B Z))                 S (S (S (S O)))
           5           B (A (B Z))              S (S (S (S (S O))))
           6           A (B (B Z))           S (S (S (S (S (S O)))))
           7           B (B (B Z))        S (S (S (S (S (S (S O))))))
           8        A (A (A (B Z)))    S (S (S (S (S (S (S (S O)))))))
</pre>
    一般的な2進数表記とは逆に、この表現では、下位ビットが左に、上位ビットが右に来るようになっています。
    この方がCoqでは扱いやすくなります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="bin"><span class="id" title="inductive">bin</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="Z"><span class="id" title="constructor">Z</span></a><br/>
&nbsp;&nbsp;| <a name="A"><span class="id" title="constructor">A</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="Basics.html#bin"><span class="id" title="inductive">bin</span></a>)<br/>
&nbsp;&nbsp;| <a name="B"><span class="id" title="constructor">B</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="Basics.html#bin"><span class="id" title="inductive">bin</span></a>).<br/>

<br/>
</div>

<div class="doc">
(a) 以下の2進数用のインクリメント関数<span class="inlinecode"><a class="idref" href="Basics.html#incr"><span class="id" title="definition">incr</span></a></span>と、2進数から1進数へ変換する関数<span class="inlinecode"><a class="idref" href="Basics.html#bin_to_nat"><span class="id" title="definition">bin_to_nat</span></a></span>を完成させなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="incr"><span class="id" title="definition">incr</span></a> (<span class="id" title="var">m</span>:<a class="idref" href="Basics.html#bin"><span class="id" title="inductive">bin</span></a>) : <a class="idref" href="Basics.html#bin"><span class="id" title="inductive">bin</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="bin_to_nat"><span class="id" title="definition">bin_to_nat</span></a> (<span class="id" title="var">m</span>:<a class="idref" href="Basics.html#bin"><span class="id" title="inductive">bin</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
   (b) <span class="inlinecode"><span class="id" title="var">test_bin_incr1</span></span>や<span class="inlinecode"><span class="id" title="var">test_bin_incr2</span></span>といった名前で<span class="inlinecode"><a class="idref" href="Basics.html#incr"><span class="id" title="definition">incr</span></a></span>や<span class="inlinecode"><a class="idref" href="Basics.html#bin_to_nat"><span class="id" title="definition">bin_to_nat</span></a></span>に関する5つの単体テストを書きなさい。
        （ここまでやってきたとおり、Coqでの「単体テスト」とは<span class="inlinecode"><span class="id" title="keyword">Example</span></span>で書かれた、<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>だけで証明できるものです。）
        2進数をインクリメントして1進数に変換したものは、1進数に変換して1加えたものと一致するということに注意してください。 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_binary"><span class="id" title="definition">manual_grade_for_binary</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">表紙</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a><hr/>
<a href="https://github.com/sfja/sfja">ソフトウェアの基礎 日本語化プロジェクト</a>
</div>

</div>

</body>
</html>

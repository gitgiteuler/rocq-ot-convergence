<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>論理の基礎</title>
</head>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>

<body>

<div id="page">

<div id="header">
<a href='../index.html'>
<img src='common/media/image/sf_logo_sm.png'></a>
</br><a href='index.html'><span class='booktitleinheader'>第 1 巻: 論理の基礎</span></a><br></br>
<ul id='menu'>
   <a href='toc.html'><li class='section_name'>目次</li></a>
   <a href='coqindex.html'><li class='section_name'>索引</li></a>
   <a href='deps.html'><li class='section_name'>全体図</li></a>
</ul>
</div>

<div id="main">
<h1 class="libtitle">Poly: 多相性と高階関数</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-parsing".<br/>
<span class="id" title="var">From</span> <span class="id" title="var">LF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="Lists.html#"><span class="id" title="library">Lists</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab102"></a><h1 class="section">ポリモルフィズム（多相性）(Polymorphism)</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
この章では、関数型プログラミングの基本的なコンセプトを進めていきます。
    特に重要な新しいアイディアは、「多相性(<i>polymorphism</i>)」（関数が扱うデータの型に関する抽象化）と「高階関数(<i>higher-order function</i>)」（関数のデータとしての取り扱い）です。
    まず多相性から始めましょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab103"></a><h2 class="section">多相的なリスト</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
ここまでは、数値のリストについて学んできました。
    もちろん、数値以外の、文字列、ブール値、リストといったものを要素として持つリストを扱えるプログラムは、より興味深いものとなるでしょう。
    これまで学んできたことだけでも、実は新しい帰納的なデータ型を作ることはできるのです。
    例えば次のように... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="boollist"><span class="id" title="inductive">boollist</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="bool_nil"><span class="id" title="constructor">bool_nil</span></a><br/>
&nbsp;&nbsp;| <a name="bool_cons"><span class="id" title="constructor">bool_cons</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#boollist"><span class="id" title="inductive">boollist</span></a>).<br/>

<br/>
</div>

<div class="doc">
... しかし、こんなことをやっていると、すぐに嫌になってしまうでしょう。
    その理由の一つは、データ型ごとに違ったコンストラクタの名前をつけなければならないことですが、もっと大変なのは、こういったリストを扱う関数（<span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span>、<span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span>など）を、新しく対応した型ごとに作る必要が出てくることです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
この無駄な繰り返し作業を無くすため、Coqは多相的な帰納的データ型の定義をサポートしています。
    これを使うと、多相的なリストは以下のように書くことができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="list"><span class="id" title="inductive">list</span></a> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <a name="cons"><span class="id" title="constructor">cons</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>).<br/>

<br/>
</div>

<div class="doc">
これは、前の章にある<span class="inlinecode"><a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a></span>の定義とほとんどそっくりですが、コンストラクタ<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>の引数の型が<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>であったのに対し、任意の型を表す<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>がそれに変わっています。
    この<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>はヘッダに加えられた<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と結びつけられ、さらに<span class="inlinecode"><a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a></span>であったものが<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>に置き換わっています。
    （ここで、コンストラクタに<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>や<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>といった名前を付けられるのは、最初に定義した<span class="inlinecode"><a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a></span>が<span class="inlinecode"><span class="id" title="keyword">Module</span></span>の中で定義されていて、ここからはスコープの外になっているからです。）

<div class="paragraph"> </div>

    それでは、<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span>とはいったい何なのか、ということを正確に考えて見ましょう。
    これを考える一つの手がかりは、リストが「型を引数にとり、帰納的な定義を返す関数である」と考えることです。
    あるいは「型を引数にとり、型を返す関数」と考えてもいいかもしれません。
    任意の型<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>について、<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>という型は、帰納的に定義されたリストの集合で、その要素の型が<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>となっているものと考えることもできます。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a>.<br/>

<br/>
</div>

<div class="doc">
定義中の<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span>のパラメータ<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>はコンストラクタである<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>や<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>の引数にもなります。
    つまり、<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>も<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>も多相的なコンストラクタになっているということです。
    コンストラクタの使用時には、何のリストを作るかを第一引数として与える必要があります。
    例えば、<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>は<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>の空リストを構成します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>

<br/>
</div>

<div class="doc">
Similarly, <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> adds an element of type <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> to a list of
    type <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>. Here is an example of forming a list containing
    just the natural number 3. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 3 (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)).<br/>

<br/>
</div>

<div class="doc">
What might the type of <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> be? We can read off the type <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>
    from the definition, but this omits the binding for <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> which is
    the parameter to <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span>. <span class="inlinecode"><span class="id" title="keyword">Type</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> does not explain the
    meaning of <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>. <span class="inlinecode">(<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">Type</span>)</span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> comes closer. Coq's
    notation for this situation is <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="keyword">Type</span>,</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>

<br/>
</div>

<div class="doc">
Similarly, the type of <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> from the definition looks like
    <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>, but using this convention to explain the
    meaning of <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> results in the type <span class="inlinecode"><span class="id" title="keyword">forall</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a>,</span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span>
    <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a>.<br/>

<br/>
</div>

<div class="doc">
(Side note on notation: In .v files, the "forall" quantifier
    is spelled out in letters.  In the generated HTML files and in the
    way various IDEs show .v files (with certain settings of their
    display controls), <span class="inlinecode"><span class="id" title="keyword">forall</span></span> is usually typeset as the usual
    mathematical "upside down A," but you'll still see the spelled-out
    "forall" in a few places.  This is just a quirk of typesetting:
    there is no difference in meaning.) 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
リストのコンストラクタに毎回型引数を与えることは無駄な手間だと感じるかもしれません。
    すぐにこれを回避する方法について見ていきます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 2 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 1 (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>))).<br/>

<br/>
</div>

<div class="doc">
（ここでは<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>や<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>を明示的に記述していますが、それは我々がまだ<span class="inlinecode">[]</span>や<span class="inlinecode">::</span>の表記法(notation)をまだ定義していないからです。
    この後でやります） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
それでは少し話を戻して、以前書いたリスト処理関数を多相版に作り直していきましょう。
    <span class="inlinecode"><span class="id" title="tactic">repeat</span></span>関数は以下のようになります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="repeat"><span class="id" title="definition">repeat</span></a> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">count</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#count"><span class="id" title="variable">count</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0 =&gt; <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">count'</span> =&gt; <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Poly.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">count'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
As with <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> and <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>, we can use <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> by applying it
    first to a type and then to an element of this type (and a number):  <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>や<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>と同様に、<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>も型を最初に適用してからその型の要素（そして続いて数）に適用できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_repeat1"><span class="id" title="definition">test_repeat1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 4 2 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 4 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 4 (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
この<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>を別の型のリストに使いたい場合は、適切な型を与えるだけで済みます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_repeat2"><span class="id" title="definition">test_repeat2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab104"></a><h4 class="section">練習問題: ★★, standard (mumble_grumble)</h4>


<div class="paragraph"> </div>

    以下の2つの帰納的に定義された型を考える。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="MumbleGrumble"><span class="id" title="module">MumbleGrumble</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="MumbleGrumble.mumble"><span class="id" title="inductive">mumble</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="MumbleGrumble.a"><span class="id" title="constructor">a</span></a><br/>
&nbsp;&nbsp;| <a name="MumbleGrumble.b"><span class="id" title="constructor">b</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#mumble"><span class="id" title="inductive">mumble</span></a>) (<span class="id" title="var">y</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;| <a name="MumbleGrumble.c"><span class="id" title="constructor">c</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="MumbleGrumble.grumble"><span class="id" title="inductive">grumble</span></a> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="MumbleGrumble.d"><span class="id" title="constructor">d</span></a> (<span class="id" title="var">m</span> : <a class="idref" href="Poly.html#MumbleGrumble.mumble"><span class="id" title="inductive">mumble</span></a>)<br/>
&nbsp;&nbsp;| <a name="MumbleGrumble.e"><span class="id" title="constructor">e</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>).<br/>

<br/>
</div>

<div class="doc">
以下の項の中から、型が<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.grumble"><span class="id" title="inductive">grumble</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>の形で付けられるものを選びなさい。
    （「はい」か「いいえ」を各行に追加しなさい）
<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode">5)</span> 

</li>
<li> <span class="inlinecode"><a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.mumble"><span class="id" title="inductive">mumble</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode">5)</span> 

</li>
<li> <span class="inlinecode"><a class="idref" href="IndProp.html#d"><span class="id" title="definition">d</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode">5)</span> 

</li>
<li> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> 

</li>
<li> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.mumble"><span class="id" title="inductive">mumble</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">0)</span> 

</li>
<li> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">0)</span> 

</li>
<li> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span>   
</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">End</span> <a class="idref" href="Poly.html#MumbleGrumble"><span class="id" title="module">MumbleGrumble</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_mumble_grumble"><span class="id" title="definition">manual_grade_for_mumble_grumble</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab105"></a><h3 class="section">型注釈推論</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
それでは、<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>関数の定義をもう一度書いてみましょう。
    ただし今回は、引数の型を指定しないでおきます。
    Coqはこれを受け入れてくれるでしょうか？ 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="repeat'"><span class="id" title="definition">repeat'</span></a> <span class="id" title="var">X</span> <span class="id" title="var">x</span> <span class="id" title="var">count</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#count"><span class="id" title="variable">count</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0        =&gt; <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">count'</span> =&gt; <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Poly.html#repeat'"><span class="id" title="definition">repeat'</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">count'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
うまくいったようです。
    Coqが<span class="inlinecode"><a class="idref" href="Poly.html#repeat'"><span class="id" title="definition">repeat'</span></a></span>にどのような型を設定したのか確認してみましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Poly.html#repeat'"><span class="id" title="definition">repeat'</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Poly.html#repeat"><span class="id" title="definition">repeat</span></a>.<br/>

<br/>
</div>

<div class="doc">
両者は全く同じ型であることが分かります。
    Coqは「型推論(<i>type inference</i>)」という機構を持っていて、これを使い、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>と<span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span>の型が何であるべきかを、その使われ方から導き出します。
    例えば、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>が<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>の最初の引数として使われたことがあれば、<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>が最初の引数として<span class="inlinecode"><span class="id" title="keyword">Type</span></span>を期待しているのでそれに違いありません。
    さらに<span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span>が<span class="inlinecode">0</span>や<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>とマッチされているので、それは<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>に違いない、といった具合です。

<div class="paragraph"> </div>

    このパワフルな機構の存在は、型情報を常にそこら中に書かなければならないわけではない、ということを意味します。
    しかし、型を明示的に書くことは、ドキュメントとして、または整合性を確かめるという点で意味があるので、以降もほとんどは型を書いていきます。
    これからは自分の書くコードで、型指定を書くところ、書かないところのバランスを考えていく必要があります（多すぎればコードが目障りな型指定で読みにくくなりますし、少なすぎるとプログラムを読む人に型推論させなければならなくなります）。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab106"></a><h3 class="section">型引数の構成（Synthesis）</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
多相的な関数を使うには、通常の引数に加えて型を一つ以上渡さなければなりません。
    例えば、<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>関数内での再帰呼び出しには、型<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>として渡されたものをそのまま渡すことになります。
    しかし<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>の二つ目の引数が<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>型である以上、最初の引数は明らかに<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>以外あり得ないのではないか、とも考えられます。
    それならばなぜわざわざそれを書く必要があるのでしょう。

<div class="paragraph"> </div>

    幸いなことに、Coqではこの種の冗長性を避けることができます。
    型を引数に渡すところではどこでも「穴(hole)」<span class="inlinecode"><span class="id" title="var">_</span></span>を書くことができるのです。
    これは「ここにあるべきものを見つけてください」という意味です。
    もう少し正確に言うと、Coqが<span class="inlinecode"><span class="id" title="var">_</span></span>を見つけると、手近に集められる情報を集めて「単一化(<i>unify</i>)」します。
    集められる情報は、適用されている関数の型や、その適用が現れている文脈から予想される型などですが、それを使って<span class="inlinecode"><span class="id" title="var">_</span></span>と置き換えるべき具体的な型を決定するのです。

<div class="paragraph"> </div>

    これを聞くと、型推論と同じじゃないかと思われるかもしれません。
    実際、この二つの機能は水面下にあるメカニズムではつながっています。
    次のように単に引数の型を省略する代わりに
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#repeat'"><span class="id" title="definition">repeat'</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> := 
<div class="paragraph"> </div>

</span>    このように、型を<span class="inlinecode"><span class="id" title="var">_</span></span>で書くことができるということです。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#repeat'"><span class="id" title="definition">repeat'</span></a> (<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> : <span class="id" title="var">_</span>) (<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a> : <span class="id" title="var">_</span>) (<a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a> : <span class="id" title="var">_</span>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> := 
<div class="paragraph"> </div>

</span>    いずれも、Coqに、欠落している情報を推論させるもので、ちょうど引数を構成することに相当します。

<div class="paragraph"> </div>

    穴を使うと、<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>関数は以下のように書けます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="repeat''"><span class="id" title="definition">repeat''</span></a> <span class="id" title="var">X</span> <span class="id" title="var">x</span> <span class="id" title="var">count</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#count"><span class="id" title="variable">count</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0        =&gt; <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">count'</span> =&gt; <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">_</span> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Poly.html#repeat''"><span class="id" title="definition">repeat''</span></a> <span class="id" title="var">_</span> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">count'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
この例では、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>を<span class="inlinecode"><span class="id" title="var">_</span></span>に省略することをあまりしていません。
    しかし多くの場合、入力の容易さと読みやすさの両方で違いが現れます。
    例えば、<span class="inlinecode">1</span>,<span class="inlinecode">2</span>,<span class="inlinecode">3</span>の三つの数値を保持するリストを書きたい場合を考えてみましょう。
    以下のように書く代わりに... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="list123"><span class="id" title="definition">list123</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 1 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 2 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> 3 (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>))).<br/>

<br/>
</div>

<div class="doc">
...穴を使って以下のように書くことができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="list123'"><span class="id" title="definition">list123'</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">_</span> 1 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">_</span> 2 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">_</span> 3 (<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <span class="id" title="var">_</span>))).<br/>

<br/>
</div>

<div class="doc">
<a name="lab107"></a><h3 class="section">暗黙の引数</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
さらに先に進めて、プログラムにほとんど<span class="inlinecode"><span class="id" title="var">_</span></span>を書かなくてすむように、特定の関数の引数については「常に」型推論するよう指定できます。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="var">Arguments</span></span>命令は関数（や構成子）に対し、引数の名前を波括弧で覆うことで暗黙のものとすることができます。
    （構成子でよく起こるのですが、もし名前がない変数を暗黙にしたい場合はワイルドカードパターンとして<span class="inlinecode"><span class="id" title="var">_</span></span>を指定します。） 
</div>
<div class="code">

<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> {<span class="id" title="var">X</span>}.<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Poly.html#repeat"><span class="id" title="definition">repeat</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">x</span> <span class="id" title="var">count</span>.<br/>

<br/>
</div>

<div class="doc">
Now, we don't have to supply type arguments at all: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="list123''"><span class="id" title="definition">list123''</span></a> := <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 1 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 2 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 3 <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>)).<br/>

<br/>
</div>

<div class="doc">
また、関数定義の中で、引数を暗黙のものにすることもできます。
    その際は、次のように引数を丸括弧の代わりに波括弧で囲みます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="repeat'''"><span class="id" title="definition">repeat'''</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">count</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#count"><span class="id" title="variable">count</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 0        =&gt; <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">count'</span> =&gt; <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Poly.html#repeat'''"><span class="id" title="definition">repeat'''</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">count'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
（ここで注意してほしいのは、再帰呼び出しの<span class="inlinecode"><a class="idref" href="Poly.html#repeat'''"><span class="id" title="definition">repeat'''</span></a></span>ではもうすでに型を引数で指定していない、ということです。
    また、渡そうとするのは誤りとなります。）

<div class="paragraph"> </div>

    これからは、定義時に指定する後者の書き方をできるだけ使っていくことにします。
    ただし、<span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>の構成子では<span class="inlinecode"><span class="id" title="var">Arguments</span></span>を明示的に書くようにします。
    というのも、帰納型のパラメータを暗黙にするのは、型そのもののパラメータを暗黙にするのであって、構成子のパラメータだけを暗黙にするわけではないからです。
    例えば、以下のように<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span>を定義したとしましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="list'"><span class="id" title="inductive">list'</span></a> {<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>} : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="nil'"><span class="id" title="constructor">nil'</span></a><br/>
&nbsp;&nbsp;| <a name="cons'"><span class="id" title="constructor">cons'</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list'"><span class="id" title="inductive">list'</span></a>).<br/>

<br/>
</div>

<div class="doc">
Because <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> is declared as implicit for the <i>entire</i> inductive
    definition including <span class="inlinecode"><a class="idref" href="Poly.html#list'"><span class="id" title="inductive">list'</span></a></span> itself, we now have to write just
    <span class="inlinecode"><a class="idref" href="Poly.html#list'"><span class="id" title="inductive">list'</span></a></span> whether we are talking about lists of numbers or booleans
    or anything else, rather than <span class="inlinecode"><a class="idref" href="Poly.html#list'"><span class="id" title="inductive">list'</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> or <span class="inlinecode"><a class="idref" href="Poly.html#list'"><span class="id" title="inductive">list'</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span> or
    whatever; this is a step too far. 
<div class="paragraph"> </div>

 Let's finish by re-implementing a few other standard list
    functions on our new polymorphic lists... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="app"><span class="id" title="definition">app</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l1"><span class="id" title="variable">l1</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>      =&gt; <a class="idref" href="Poly.html#l2"><span class="id" title="variable">l2</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">h</span> <span class="id" title="var">t</span> =&gt; <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">h</span> (<a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a> <span class="id" title="var">t</span> <a class="idref" href="Poly.html#l2"><span class="id" title="variable">l2</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="rev"><span class="id" title="definition">rev</span></a> {<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>      =&gt; <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">h</span> <span class="id" title="var">t</span> =&gt; <a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">t</span>) (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">h</span> <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="length"><span class="id" title="definition">length</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; 0<br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <span class="id" title="var">l'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_rev1"><span class="id" title="definition">test_rev1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 1 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 2 <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 2 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 1 <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_rev2"><span class="id" title="definition">test_rev2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_length1"><span class="id" title="definition">test_length1</span></a>: <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 1 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 2 (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> 3 <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>))) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab108"></a><h3 class="section">Supplying Type Arguments Explicitly</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
引数を暗黙的に宣言することには、小さな問題が一つあります。
    時折、Coqが型を特定するために必要な情報を十分に集められない時があるのです。
    そういう場合には、その時だけ明示してやります。
    例えば、もし次のように書いたとします。 
</div>
<div class="code">

<br/>
<span class="id" title="var">Fail</span> <span class="id" title="keyword">Definition</span> <a name="mynil"><span class="id" title="definition">mynil</span></a> := <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>

<br/>
</div>

<div class="doc">
（<span class="inlinecode"><span class="id" title="keyword">Definition</span></span>の前にある<span class="inlinecode"><span class="id" title="var">Fail</span></span>という修飾子は、実行すると失敗することを表します。
    この修飾子はどのコマンドにも使えます。
    もし指定したコマンドが失敗すると、Coqがエラーメッセージを出しますが、処理を続行します。）

<div class="paragraph"> </div>

    この定義ではCoqがエラーを出します。
    <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>にどんな型を与えれば良いかわからないからです。
    このようなときは、型宣言を明示的に行うことができます（これによって<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>を何に「適用したか」という情報が与えられます）。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="mynil"><span class="id" title="definition">mynil</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> := <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>

<br/>
</div>

<div class="doc">
それとは別に、関数名の前に<span class="inlinecode">@</span>を付けることで暗黙的に宣言された引数を明示的に与えることができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> @<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="mynil'"><span class="id" title="definition">mynil'</span></a> := @<a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>

<br/>
</div>

<div class="doc">
引数の構成と暗黙の引数をつかうことで、リストに関する便利な表記法を定義できます。
    コンストラクタの型引数を暗黙的に記述すれば、Coqはその表記法を使ったときに型を自動的に推論してくれます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">&quot;</span></a>x :: y" := (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a name="e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">&quot;</span></a>[ ]" := <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a name="fef3547e19f33399017f75caf630e228"><span class="id" title="notation">&quot;</span></a>[ x ; .. ; y ]" := (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">x</span> .. (<a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">y</span> <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a>) ..).<br/>
<span class="id" title="keyword">Notation</span> <a name="1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">&quot;</span></a>x ++ y" := (<a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
</div>

<div class="doc">
これで、我々の望む書き方ができるようになりました。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="list123'''"><span class="id" title="definition">list123'''</span></a> := <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab109"></a><h3 class="section">練習問題</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab110"></a><h4 class="section">練習問題: ★★, standard, optional (poly_exercises)</h4>


<div class="paragraph"> </div>

    ここにあるいくつかの練習問題は、List.vにあったものと同じですが、多相性の練習になります。
    以下の証明を完成させなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="app_nil_r"><span class="id" title="lemma">app_nil_r</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>), <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="app_assoc"><span class="id" title="lemma">app_assoc</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> (<span class="id" title="var">l</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#A"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">)</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="app_length"><span class="id" title="lemma">app_length</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#l2"><span class="id" title="variable">l2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Poly.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Poly.html#l2"><span class="id" title="variable">l2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab111"></a><h4 class="section">Exercise: 2 stars, standard, optional (more_poly_exercises)</h4>


<div class="paragraph"> </div>

    Here are some slightly more interesting ones... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="rev_app_distr"><span class="id" title="lemma">rev_app_distr</span></a>: <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Poly.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#l2"><span class="id" title="variable">l2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Poly.html#l2"><span class="id" title="variable">l2</span></a> <a class="idref" href="Poly.html#1a1c7f13320341c3638e9edcc3e6389d"><span class="id" title="notation">++</span></a> <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Poly.html#l1"><span class="id" title="variable">l1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="rev_involutive"><span class="id" title="lemma">rev_involutive</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>, <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab112"></a><h2 class="section">多相的な対</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
次も同様に、前の章で作った数値の対を多相的な対に一般化することを考えます。
    これは「直積(<i>products</i>)」とも呼ばれます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="prod"><span class="id" title="inductive">prod</span></a> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
| <a name="pair"><span class="id" title="constructor">pair</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">y</span> : <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>).<br/>

<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Poly.html#pair"><span class="id" title="constructor">pair</span></a> {<span class="id" title="var">X</span>} {<span class="id" title="var">Y</span>} <span class="id" title="var">_</span> <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
リストと同様、型引数を暗黙にし、その表記法を定義します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">&quot;</span></a>( x , y )" := (<a class="idref" href="Poly.html#pair"><span class="id" title="constructor">pair</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
また、直積「型」の、より標準的な表記法も登録しておきます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">&quot;</span></a>X * Y" := (<a class="idref" href="Poly.html#prod"><span class="id" title="inductive">prod</span></a> <span class="id" title="var">X</span> <span class="id" title="var">Y</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
</div>

<div class="doc">
（<span class="inlinecode"><span class="id" title="var">type_scope</span></span>というアノテーションは、この省略形が、型を解析する際のみ使われることを示しています。
    これによって、<span class="inlinecode">*</span>が乗算の演算子と衝突することを避けています。
</div>
<div class="code">

<br/>
</div>

<div class="doc">
最初のうちは、<span class="inlinecode">(<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>,<a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>)</span>と<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a>*<a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>の違いに混乱するかもしれません。
    覚えてほしいのは、<span class="inlinecode">(<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>,<a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>)</span>が対の「値」を二つの値から構成するもので、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a>*<a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>は対の「型」を二つの型から構成するものだということです。
    値<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>が<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>型で、値<span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>が<span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>型なら、値<span class="inlinecode">(<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>,<a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>)</span>は<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a>*<a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>型となります。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
対の最初の要素、2番目の要素を返す射影関数は他のプログラミング言語で書いたものと大体同じになります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="fst"><span class="id" title="definition">fst</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">p</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a> <span class="id" title="var">y</span><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="snd"><span class="id" title="definition">snd</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">p</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) : <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a> <span class="id" title="var">y</span><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
次の関数は二つのリストを引数にとり、一つの"対のリスト"を作成します。
    他の関数型言語で<span class="inlinecode"><span class="id" title="var">zip</span></span>関数と呼ばれているものですが、ここではCoqの標準ライブラリに合わせる形で<span class="inlinecode"><a class="idref" href="Poly.html#combine"><span class="id" title="definition">combine</span></a></span>と呼ぶことにします。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="combine"><span class="id" title="definition">combine</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">lx</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">ly</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#lx"><span class="id" title="variable">lx</span></a>, <a class="idref" href="Poly.html#ly"><span class="id" title="variable">ly</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">x</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <span class="id" title="var">tx</span>, <span class="id" title="var">y</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <span class="id" title="var">ty</span> =&gt; <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a> <span class="id" title="var">y</span><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#combine"><span class="id" title="definition">combine</span></a> <span class="id" title="var">tx</span> <span class="id" title="var">ty</span><a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab113"></a><h4 class="section">練習問題: ★, standard, optional (combine_checks)</h4>


<div class="paragraph"> </div>

    次の質問の答えを紙に書いた後で、Coqの出した答えと同じかチェックしなさい。
<ul class="doclist">
<li> 関数<span class="inlinecode"><a class="idref" href="Poly.html#combine"><span class="id" title="definition">combine</span></a></span>の型は何でしょう （<span class="inlinecode"><span class="id" title="keyword">Check</span></span> <span class="inlinecode">@<a class="idref" href="Poly.html#combine"><span class="id" title="definition">combine</span></a></span>の出力結果は？）

</li>
<li> それでは
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Compute</span> (<a class="idref" href="Poly.html#combine"><span class="id" title="definition">combine</span></a> [1;2] [<a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>;<a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>;<a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>;<a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>]).
<div class="paragraph"> </div>

</span>      は何を出力する？

</li>
</ul>

<div class="paragraph"> </div>

    <font size=-2>&#9744;</font>  
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab114"></a><h4 class="section">練習問題: ★★, standard, recommended (split)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">split</span></span>関数は<span class="inlinecode"><a class="idref" href="Poly.html#combine"><span class="id" title="definition">combine</span></a></span>と全く逆で、ペアのリストを引数に受け取り、リストのペアを返します。
    多くの関数型言語で<span class="inlinecode"><span class="id" title="var">unzip</span></span>と呼ばれているものです。

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">split</span></span>関数の定義を完成させ、続くテストを通過することも確認しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="split"><span class="id" title="definition">split</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">)</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_split"><span class="id" title="definition">test_split</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#split"><span class="id" title="axiom">split</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a>1<a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a>2<a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab115"></a><h2 class="section">多相的なオプション</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
最後に、多相的なオプションに取り組みます。
    この型は、前の章の<span class="inlinecode"><a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a></span>を一般化したものになります。
    （<span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.option"><span class="id" title="inductive">option</span></a></span>は標準ライブラリで定義されていて、後ほどそちらを使いたいので、ここでは定義をモジュール内に入れています。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="OptionPlayground"><span class="id" title="module">OptionPlayground</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="OptionPlayground.option"><span class="id" title="inductive">option</span></a> (<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="OptionPlayground.Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;| <a name="OptionPlayground.None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Poly.html#OptionPlayground.Some"><span class="id" title="constructor">Some</span></a> {<span class="id" title="var">X</span>} <span class="id" title="var">_</span>.<br/>
<span class="id" title="var">Arguments</span> <a class="idref" href="Poly.html#OptionPlayground.None"><span class="id" title="constructor">None</span></a> {<span class="id" title="var">X</span>}.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Poly.html#OptionPlayground"><span class="id" title="module">OptionPlayground</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a></span>関数を、色々な型のリストで使えるように定義し直しましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="nth_error"><span class="id" title="definition">nth_error</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> =&gt; <span class="id" title="keyword">if</span> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span> <span class="id" title="keyword">else</span> <a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">l'</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_nth_error1"><span class="id" title="definition">test_nth_error1</span></a> : <a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>6<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>7<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> 4.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_nth_error2"><span class="id" title="definition">test_nth_error2</span></a> : <a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]]</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_nth_error3"><span class="id" title="definition">test_nth_error3</span></a> : <a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab116"></a><h4 class="section">練習問題: ★, standard, optional (hd_error_poly)</h4>


<div class="paragraph"> </div>

    前の章に出てきた<span class="inlinecode"><a class="idref" href="Poly.html#hd_error"><span class="id" title="definition">hd_error</span></a></span>関数の多相版を定義しなさい。
    次の単体テストでの確認も忘れずに。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="hd_error"><span class="id" title="definition">hd_error</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
再び、暗黙の引数を明示してみましょう。
    関数名の前に<span class="inlinecode">@</span>をつければいいのでしたね。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> @<a class="idref" href="Poly.html#hd_error"><span class="id" title="axiom">hd_error</span></a>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_hd_error1"><span class="id" title="definition">test_hd_error1</span></a> : <a class="idref" href="Poly.html#hd_error"><span class="id" title="axiom">hd_error</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> 1.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_hd_error2"><span class="id" title="definition">test_hd_error2</span></a> : <a class="idref" href="Poly.html#hd_error"><span class="id" title="axiom">hd_error</span></a>  <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]]</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab117"></a><h1 class="section">データとしての関数</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
他の多くの近代的なプログラミング言語（MLやHaskell、Scheme、Scala、Clojureなどの関数型言語を含む）同様、Coqは関数を第1級に属するものとして取り扱います。
    第1級に属するということは、他の関数の引数として渡したり、結果として返したり、データ構造の中に含めたりできる、ということです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab118"></a><h2 class="section">高階関数</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
関数を操作する関数を、一般に「高階(<i>higher-order</i>)」関数と呼びます。
    例えば次のようなものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="doit3times"><span class="id" title="definition">doit3times</span></a> {<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>:<a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">n</span>:<a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a>)).<br/>

<br/>
</div>

<div class="doc">
ここで引数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>は（<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>から<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>への）関数です。
    <span class="inlinecode"><a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a></span>の内容は、値<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>に対して関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を3回適用するものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> @<a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_doit3times"><span class="id" title="definition">test_doit3times</span></a>: <a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a> <a class="idref" href="Basics.html#minustwo"><span class="id" title="definition">minustwo</span></a> 9 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_doit3times'"><span class="id" title="definition">test_doit3times'</span></a>: <a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a> <a class="idref" href="Basics.html#negb"><span class="id" title="definition">negb</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab119"></a><h2 class="section">フィルター(Filter)関数</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
次に紹介するのは、もっと有用な高階関数です。
    これは、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>型のリストと、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>についての述語（<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>を引数にとり、<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>を返す関数）を引数にとり、リストの要素に「フィルター(filter)」をかけて、述語の結果が<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>となった要素だけのリストを返す関数です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="filter"><span class="id" title="definition">filter</span></a> {<span class="id" title="var">X</span>:<span class="id" title="keyword">Type</span>} (<span class="id" title="var">test</span>: <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) (<span class="id" title="var">l</span>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a>     =&gt; <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <span class="id" title="keyword">if</span> <a class="idref" href="Poly.html#test"><span class="id" title="variable">test</span></a> <span class="id" title="var">h</span> <span class="id" title="keyword">then</span> <span class="id" title="var">h</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Poly.html#test"><span class="id" title="variable">test</span></a> <span class="id" title="var">t</span><a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span>       <a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Poly.html#test"><span class="id" title="variable">test</span></a> <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
例えば、この<span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>関数に述語として<span class="inlinecode"><a class="idref" href="Basics.html#evenb"><span class="id" title="definition">evenb</span></a></span>と数値のリスト<span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span>を与えると、リスト<span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span>の要素のうち偶数の要素だけが含まれるリストとなって返ります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_filter1"><span class="id" title="definition">test_filter1</span></a>: <a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Basics.html#evenb"><span class="id" title="definition">evenb</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="length_is_1"><span class="id" title="definition">length_is_1</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 1.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_filter2"><span class="id" title="definition">test_filter2</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Poly.html#length_is_1"><span class="id" title="definition">length_is_1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>6<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>7<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>8<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>8<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
この<span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>を使うことで、 <span class="inlinecode"><span class="id" title="var">Lists.v</span></span>にある<span class="inlinecode"><a class="idref" href="Lists.html#NatList.countoddmembers"><span class="id" title="definition">countoddmembers</span></a></span>関数をもっと簡潔に書くことができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="countoddmembers'"><span class="id" title="definition">countoddmembers'</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>).<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_countoddmembers'1"><span class="id" title="definition">test_countoddmembers'1</span></a>:   <a class="idref" href="Poly.html#countoddmembers'"><span class="id" title="definition">countoddmembers'</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 4.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_countoddmembers'2"><span class="id" title="definition">test_countoddmembers'2</span></a>:   <a class="idref" href="Poly.html#countoddmembers'"><span class="id" title="definition">countoddmembers'</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_countoddmembers'3"><span class="id" title="definition">test_countoddmembers'3</span></a>:   <a class="idref" href="Poly.html#countoddmembers'"><span class="id" title="definition">countoddmembers'</span></a> <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab120"></a><h2 class="section">無名（匿名）関数</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
少し悲しいことに、上の例では、<span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>の引数とするために、多分以降全く使われないであろう関数<span class="inlinecode"><a class="idref" href="Poly.html#length_is_1"><span class="id" title="definition">length_is_1</span></a></span>をわざわざ定義して名付けなければなりませんでした。
    このようなことは、この例だけの問題ではありません。
    高階関数を使うときは、引数として以降では全く使わない「一度きり」の関数を渡すことがよくあります。
    こういう関数にいちいち名前を考えるのは、退屈以外の何物でもありません。

<div class="paragraph"> </div>

    幸いなことに、いい方法があります。
    関数を、トップレベルで宣言することも名前を付けることもなく、「その場で(on the fly)」作ることができるのです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_anon_fun'"><span class="id" title="definition">test_anon_fun'</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a>) 2 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 256.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The expression <span class="inlinecode">(<span class="id" title="keyword">fun</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">*</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>)</span> can be read as "the function
    that, given a number <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>, yields <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">*</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>." 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
次は<span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>の例を、無名関数を使って書き換えた例です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_filter2'"><span class="id" title="definition">test_filter2'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">l</span> =&gt; <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>6<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>7<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>8<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>8<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab121"></a><h4 class="section">練習問題: ★★, standard (filter_even_gt7)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>の代わりに<span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>関数を使い、数値のリストを入力すると、そのうち偶数でなおかつ7より大きい要素だけを取り出す<span class="inlinecode"><a class="idref" href="Poly.html#filter_even_gt7"><span class="id" title="definition">filter_even_gt7</span></a></span>関数を書きなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="filter_even_gt7"><span class="id" title="definition">filter_even_gt7</span></a> (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_filter_even_gt7_1"><span class="id" title="definition">test_filter_even_gt7_1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#filter_even_gt7"><span class="id" title="axiom">filter_even_gt7</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>6<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>9<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>10<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>12<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>8<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>10<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>12<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>8<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_filter_even_gt7_2"><span class="id" title="definition">test_filter_even_gt7_2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#filter_even_gt7"><span class="id" title="axiom">filter_even_gt7</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>6<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>19<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>129<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab122"></a><h4 class="section">練習問題: ★★★, standard (partition)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>関数を使って、<span class="inlinecode"><a class="idref" href="Poly.html#partition"><span class="id" title="definition">partition</span></a></span>関数を書きなさい。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#partition"><span class="id" title="definition">partition</span></a> : <span class="id" title="keyword">forall</span> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> : <span class="id" title="keyword">Type</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> -&gt; <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>) -&gt; <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> -&gt; <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> * <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> 
<div class="paragraph"> </div>

</span>   <span class="inlinecode"><a class="idref" href="Poly.html#partition"><span class="id" title="definition">partition</span></a></span>関数は、型<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>の値がある条件を満たすかを調べる述語（<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型の関数）と<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>の値を引数に与えると、リストの対を返します。
   対の最初の要素は、与えられたリストのうち、条件を満たす要素だけのリストで、二番目の要素は、条件を満たさないもののリストです。
   二つのリストの要素の順番は、元のリストの順と同じでなければなりません。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="partition"><span class="id" title="definition">partition</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">test</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_partition1"><span class="id" title="definition">test_partition1</span></a>: <a class="idref" href="Poly.html#partition"><span class="id" title="axiom">partition</span></a> <a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_partition2"><span class="id" title="definition">test_partition2</span></a>: <a class="idref" href="Poly.html#partition"><span class="id" title="axiom">partition</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>) <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>9<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>9<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab123"></a><h2 class="section">マップ(Map)関数</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
もう一つ、便利な高階関数として<span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>を挙げます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="map"><span class="id" title="definition">map</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>:<a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">l</span>:<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : (<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a>     =&gt; <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">h</span><a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">)</span></a> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">t</span><a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
これは、関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>とリスト<span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">[<a class="idref" href="Logic.html#n1"><span class="id" title="variable">n1</span></a>,</span> <span class="inlinecode"><a class="idref" href="Logic.html#n2"><span class="id" title="variable">n2</span></a>,</span> <span class="inlinecode"><a class="idref" href="Imp.html#n3"><span class="id" title="variable">n3</span></a>,</span> <span class="inlinecode">...]</span> <span class="inlinecode"></span>を引数にとり、関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を<span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span>の各要素に適用した<span class="inlinecode"></span> <span class="inlinecode">[<a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n1"><span class="id" title="variable">n1</span></a>,</span> <span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n2"><span class="id" title="variable">n2</span></a>,</span> <span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#n3"><span class="id" title="variable">n3</span></a>,...]</span> <span class="inlinecode"></span>というリストを返します。
    例えばこのようなものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_map1"><span class="id" title="definition">test_map1</span></a>: <a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a> 3 <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a>) <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
入力されるリストの要素の型と、出力されるリストの要素の型は同じである必要はありません。
    <span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>は、2つの型変数<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>を取ります。
    これにより、次の例では、数値のリストと、数値を受け取り<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>値を返す関数から、<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型のリストを返しています。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_map2"><span class="id" title="definition">test_map2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>は、数値のリストと、「数値から<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型のリストへの関数」を引数にとることで、「<span class="inlinecode"><a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a></span>型のリストのリスト」を返すこともできます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="test_map3"><span class="id" title="definition">test_map3</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Basics.html#evenb"><span class="id" title="definition">evenb</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#oddb"><span class="id" title="definition">oddb</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>) <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[[</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];[</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];[</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];[</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab124"></a><h3 class="section">Exercises</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab125"></a><h4 class="section">練習問題: ★★★, standard (map_rev)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>と<span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span>が可換であることを示しなさい。
    補題をたてて証明する必要があるでしょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="map_rev"><span class="id" title="lemma">map_rev</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab126"></a><h4 class="section">練習問題: ★★, standard, recommended (flat_map)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>関数は、<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>から<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>へのマップを、型<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>の関数を使って実現しています。
    同じような関数<span class="inlinecode"><a class="idref" href="Poly.html#flat_map"><span class="id" title="definition">flat_map</span></a></span>を定義しましょう。
    これは<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>から<span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>へのマップですが、<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>となる関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を使用します。
    このため、次のように要素ごとの関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>の結果を平坦化してやる必要があります。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#flat_map"><span class="id" title="definition">flat_map</span></a> (<span class="id" title="keyword">fun</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> =&gt; [<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>;<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>+1;<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>+2]) [1;5;10] <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= [1; 2; 3; 5; 6; 7; 10; 11; 12] 
<div class="paragraph"> </div>

</span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="flat_map"><span class="id" title="definition">flat_map</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>: <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">l</span>: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>)<br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_flat_map1"><span class="id" title="definition">test_flat_map1</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#flat_map"><span class="id" title="axiom">flat_map</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>) <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a> 4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
リスト以外にも<span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>関数が定義できるような帰納型はあります。
    次の定義は、<span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.option"><span class="id" title="inductive">option</span></a></span>型のために<span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>関数を定義したものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="option_map"><span class="id" title="definition">option_map</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">xo</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#xo"><span class="id" title="variable">xo</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">x</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab127"></a><h4 class="section">練習問題: ★★, standard, optional (implicit_args)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#filter"><span class="id" title="definition">filter</span></a></span>や<span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>関数を定義したり使ったりするケースでは、多くの場合暗黙的な型引数が使われます。
    暗黙の型引数定義に使われている波括弧を丸括弧に置き換え、必要なところに型引数を明示的に書くようにして、それが正しいかどうかをCoqでチェックしなさい。
    （この練習問題はここに書かないようにしましょう。
    あとで簡単に戻せるように、このファイルをコピーして編集し、終わった後捨てるのが一番楽だと思います。）

<div class="paragraph"> </div>

    <font size=-2>&#9744;</font>  
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab128"></a><h2 class="section">畳み込み（Fold）関数</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
さらにパワフルな高階関数<span class="inlinecode"><span class="id" title="tactic">fold</span></span>に話を移します。
    この関数はGoogleの分散フレームワーク「map/reduce」でいうところの「<span class="inlinecode"><span class="id" title="var">reduce</span></span>」操作の元になったものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="fold"><span class="id" title="definition">fold</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>: <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">l</span>: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">b</span>: <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="Poly.html#b"><span class="id" title="variable">b</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Poly.html#cff9c6e3fbbb9de4085b1fe1a075f16b"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">h</span> (<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">t</span> <a class="idref" href="Poly.html#b"><span class="id" title="variable">b</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
直観的に<span class="inlinecode"><span class="id" title="tactic">fold</span></span>は、与えられたリストの各要素の間に、与えられた二項演算子<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を挟み込むように挿入していくような操作です。
    例えば、<span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="tactic">fold</span></span> <span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span> <span class="inlinecode">[1,2,3,4]</span> <span class="inlinecode"></span>は、直感的に<span class="inlinecode">1+2+3+4</span>と同じ意味です。
    ただし正確には、二番めの引数に、<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>に最初に与える"初期値"が必要になります。例えば
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a> [1;2;3;4] 0 
<div class="paragraph"> </div>

</span>    は、次のように解釈されます。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 + (2 + (3 + (4 + 0))) 
<div class="paragraph"> </div>

</span>    もう少し例を見ていきましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a>).<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="fold_example1"><span class="id" title="definition">fold_example1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#mult"><span class="id" title="abbreviation">mult</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 24.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="fold_example2"><span class="id" title="definition">fold_example2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Basics.html#andb"><span class="id" title="definition">andb</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="fold_example3"><span class="id" title="definition">fold_example3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a>  <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];</span></a><a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a><a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">];[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]]</span></a> <a class="idref" href="Poly.html#e333713dc7f37e9b642b647f4a4096d2"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>1<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab129"></a><h4 class="section">練習問題: ★, advanced (fold_types_different)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">fold</span></span>関数が<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>2つの型引数をとっていて、関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>が<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>の値を引数にとり<span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>を返すようになっていることに注目してください。
    <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>と<span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>が別々の型となっていることで、便利になるような場面を考えなさい。 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_fold_types_different"><span class="id" title="definition">manual_grade_for_fold_types_different</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab130"></a><h2 class="section">関数を構築する関数</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
これまで見てきた高階関数は、ほとんどが関数を引数にとるものでした。
    ここでは、関数が別の関数の戻り値になるような例を見ていきましょう。
    まず、（型<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>の）値<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>を引数としてとり、「<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>型の引数から<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>型の戻り値を返す関数」を返す関数を考えます。
    返す関数は、与えられた<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>型の引数に関係なく、生成時に与えられた値<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>を常に返すものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="constfun"><span class="id" title="definition">constfun</span></a> {<span class="id" title="var">X</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span>: <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">k</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) =&gt; <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="ftrue"><span class="id" title="definition">ftrue</span></a> := <a class="idref" href="Poly.html#constfun"><span class="id" title="definition">constfun</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="constfun_example1"><span class="id" title="definition">constfun_example1</span></a> : <a class="idref" href="Poly.html#ftrue"><span class="id" title="definition">ftrue</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="constfun_example2"><span class="id" title="definition">constfun_example2</span></a> : (<a class="idref" href="Poly.html#constfun"><span class="id" title="definition">constfun</span></a> 5) 99 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 5.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
実は、我々がすでに見た、複数の引数を持つ関数は、関数をデータとして渡すサンプルになっているのです。
    どういうことかは、<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span>関数の型を思い出せば分かります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">-&gt;</span>は、型同士の二項演算子です。
    さらに、この演算子は右結合であるため、<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span>関数の型は<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">(<a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a>)</span>の省略です。
    これをよく読むと「<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span>は<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>型の引数を一つ取り、引数が<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>型一つで<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>型を返す関数を返す」となります。
    以前の例では<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span>に二つの引数を一緒に与えていましたが、もし望むなら最初の一つだけを与えることもできます。
    これを「部分適用(<i>partial application</i>)」といいます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="plus3"><span class="id" title="definition">plus3</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a> 3.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="Poly.html#plus3"><span class="id" title="definition">plus3</span></a>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="test_plus3"><span class="id" title="definition">test_plus3</span></a> :    <a class="idref" href="Poly.html#plus3"><span class="id" title="definition">plus3</span></a> 4 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 7.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_plus3'"><span class="id" title="definition">test_plus3'</span></a> :   <a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a> <a class="idref" href="Poly.html#plus3"><span class="id" title="definition">plus3</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 9.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="test_plus3''"><span class="id" title="definition">test_plus3''</span></a> :  <a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a> 3) 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 9.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab131"></a><h1 class="section">さらなる練習問題</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="Exercises"><span class="id" title="module">Exercises</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab132"></a><h4 class="section">練習問題: ★★, standard (fold_length)</h4>


<div class="paragraph"> </div>

    リストに関する多くの一般的な関数は<span class="inlinecode"><span class="id" title="tactic">fold</span></span>を使って実装できます。
    例えば、次に示すのは<span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span>の別な実装です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.fold_length"><span class="id" title="definition">fold_length</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#fold"><span class="id" title="definition">fold</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Poly.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> 0.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.test_fold_length1"><span class="id" title="definition">test_fold_length1</span></a> : <a class="idref" href="Poly.html#Exercises.fold_length"><span class="id" title="definition">fold_length</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>4<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>7<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.fold_length"><span class="id" title="definition">fold_length</span></a></span>が正しいことを証明しなさい。
    （ヒント：<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>は<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>よりも簡単化を進めます。
    そのため、<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>では何も起こらないのに<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>が証明してしまうようなゴールもありえます。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="Exercises.fold_length_correct"><span class="id" title="lemma">fold_length_correct</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> (<span class="id" title="var">l</span> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#Exercises.fold_length"><span class="id" title="definition">fold_length</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Poly.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab133"></a><h4 class="section">練習問題: ★★★, standard (fold_map)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a></span>関数も<span class="inlinecode"><span class="id" title="tactic">fold</span></span>を使って書くことができます。
    以下の<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.fold_map"><span class="id" title="definition">fold_map</span></a></span>を完成させなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.fold_map"><span class="id" title="definition">fold_map</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span>: <span class="id" title="keyword">Type</span>} (<span class="id" title="var">f</span>: <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) (<span class="id" title="var">l</span>: <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.fold_map"><span class="id" title="definition">fold_map</span></a></span>の正しさを示す定理をCoqで書き、証明しなさい。
    （ヒント・再掲：<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>は<span class="inlinecode"><span class="id" title="tactic">simpl</span></span>よりも簡単化を進めます。） 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.manual_grade_for_fold_map"><span class="id" title="definition">manual_grade_for_fold_map</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab134"></a><h4 class="section">練習問題: ★★, advanced (currying)</h4>


<div class="paragraph"> </div>

    Coqでは、<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#A"><span class="id" title="constructor">A</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">C</span></span>という関数の型は<span class="inlinecode"><a class="idref" href="Basics.html#A"><span class="id" title="constructor">A</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">(<a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">C</span>)</span>型と同じです。
    このことは、もし関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>に<span class="inlinecode"><a class="idref" href="Basics.html#A"><span class="id" title="constructor">A</span></a></span>の値を与えると、<span class="inlinecode"><span class="id" title="var">f'</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">C</span></span>という型の関数が戻り値として返ってくるということです。
    さらに、<span class="inlinecode"><span class="id" title="var">f'</span></span>に<span class="inlinecode"><a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a></span>の値を与えると<span class="inlinecode"><span class="id" title="var">C</span></span>の値が返ってきます。
    これは部分適用の<span class="inlinecode"><a class="idref" href="Poly.html#plus3"><span class="id" title="definition">plus3</span></a></span>でやった通りです。
    このように、複数の引数を、関数を返す関数を通じて処理することを、論理学者ハスケル・カリーにちなんで「カリー化(<i>currying</i>)」と呼んでいます。

<div class="paragraph"> </div>

    逆に、<span class="inlinecode"><a class="idref" href="Basics.html#A"><span class="id" title="constructor">A</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">C</span></span>型の関数を<span class="inlinecode">(<a class="idref" href="Basics.html#A"><span class="id" title="constructor">A</span></a></span> <span class="inlinecode">*</span> <span class="inlinecode"><a class="idref" href="Basics.html#B"><span class="id" title="constructor">B</span></a>)</span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">C</span></span>型の関数に変換することもできます。
    これを「アンカリー化(<i>uncurrying</i>)」といいます。
    アンカリー化された二項演算は、二つの引数を同時に対の形で与える必要があり、部分適用はできません。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
カリー化は以下のように定義できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.prod_curry"><span class="id" title="definition">prod_curry</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Z"><span class="id" title="variable">Z</span></a>) (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">y</span> : <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) : <a class="idref" href="Poly.html#Z"><span class="id" title="variable">Z</span></a> := <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">,</span></a> <a class="idref" href="Poly.html#y"><span class="id" title="variable">y</span></a><a class="idref" href="Poly.html#7525f6b7e3269be8ce262d7f86495f59"><span class="id" title="notation">)</span></a>.<br/>

<br/>
</div>

<div class="doc">
練習問題として、その逆の<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.prod_uncurry"><span class="id" title="definition">prod_uncurry</span></a></span>を定義し、二つの関数が互いに逆関数であることを証明しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.prod_uncurry"><span class="id" title="definition">prod_uncurry</span></a> {<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Z"><span class="id" title="variable">Z</span></a>) (<span class="id" title="var">p</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>) : <a class="idref" href="Poly.html#Z"><span class="id" title="variable">Z</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
As a (trivial) example of the usefulness of currying, we can use it
    to shorten one of the examples that we saw above: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.test_map1'"><span class="id" title="definition">test_map1'</span></a>: <a class="idref" href="Poly.html#map"><span class="id" title="definition">map</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#plus"><span class="id" title="abbreviation">plus</span></a> 3) <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>0<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>2<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">[</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>3<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">;</span></a>5<a class="idref" href="Poly.html#fef3547e19f33399017f75caf630e228"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
考える練習: 次のコマンドを実行する前に、<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.prod_curry"><span class="id" title="definition">prod_curry</span></a></span>と<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.prod_uncurry"><span class="id" title="definition">prod_uncurry</span></a></span>の型を考えなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> @<a class="idref" href="Poly.html#Exercises.prod_curry"><span class="id" title="definition">prod_curry</span></a>.<br/>
<span class="id" title="keyword">Check</span> @<a class="idref" href="Poly.html#Exercises.prod_uncurry"><span class="id" title="axiom">prod_uncurry</span></a>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="Exercises.uncurry_curry"><span class="id" title="lemma">uncurry_curry</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Z"><span class="id" title="variable">Z</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#Exercises.prod_curry"><span class="id" title="definition">prod_curry</span></a> (<a class="idref" href="Poly.html#Exercises.prod_uncurry"><span class="id" title="axiom">prod_uncurry</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a>) <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Poly.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Poly.html#y"><span class="id" title="variable">y</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="Exercises.curry_uncurry"><span class="id" title="lemma">curry_uncurry</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">X</span> <span class="id" title="var">Y</span> <span class="id" title="var">Z</span> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#Z"><span class="id" title="variable">Z</span></a>) (<span class="id" title="var">p</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a> <a class="idref" href="Poly.html#Y"><span class="id" title="variable">Y</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#Exercises.prod_uncurry"><span class="id" title="axiom">prod_uncurry</span></a> (<a class="idref" href="Poly.html#Exercises.prod_curry"><span class="id" title="definition">prod_curry</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a>) <a class="idref" href="Poly.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#p"><span class="id" title="variable">p</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab135"></a><h4 class="section">練習問題: ★★, advanced (nth_error_informal)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a></span>関数の定義を思い出してください。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> {<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> : <span class="id" title="keyword">Type</span>} (<a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> : <a class="idref" href="Poly.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a>) (<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> : <a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Poly.html#OptionPlayground.option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] =&gt; <a class="idref" href="Poly.html#OptionPlayground.None"><span class="id" title="constructor">None</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a> :: <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a> =&gt; <span class="id" title="keyword">if</span> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> =? <a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Poly.html#OptionPlayground.Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a> (<a class="idref" href="Basics.html#NatPlayground.pred"><span class="id" title="definition">pred</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.
<div class="paragraph"> </div>

</span>   次の定理の、非形式的な証明を書きなさい。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>, <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> = <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> -&gt; @<a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> = <a class="idref" href="Poly.html#OptionPlayground.None"><span class="id" title="constructor">None</span></a> 
<div class="paragraph"> </div>

</span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.manual_grade_for_informal_proof"><span class="id" title="definition">manual_grade_for_informal_proof</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="Poly.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
以降の練習問題では、自然数を定義する他の方法として、「チャーチ数(<i>Church numerals</i>)」と呼ばれる、数学者アロンゾ・チャーチ(Alonzo Church)にちなむ方法を見ていきます。
    自然数<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>を、関数<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を取り<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>回繰り返し適用するものとして表現します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="Exercises.Church"><span class="id" title="module">Church</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a> := <span class="id" title="keyword">forall</span> <span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>, <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>.<br/>

<br/>
</div>

<div class="doc">
ではこの方法でどのように数値を表すのか見ていきます。
    <span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を1回だけ適用するというのは、単に適用するだけです。
    つまり、次のようになります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.one"><span class="id" title="definition">one</span></a> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) =&gt; <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a>.<br/>

<br/>
</div>

<div class="doc">
同様に、<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a></span>は引数に2回<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>を適用するものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.two"><span class="id" title="definition">two</span></a> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) =&gt; <a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Poly.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.zero"><span class="id" title="definition">zero</span></a></span>の定義は少し変わっています。
    0回関数を適用するとは一体どういうことでしょうか？
    答えは簡単です：単に引数に何もしなければいいのです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.zero"><span class="id" title="definition">zero</span></a> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">x</span> : <a class="idref" href="Poly.html#X"><span class="id" title="variable">X</span></a>) =&gt; <a class="idref" href="Poly.html#x"><span class="id" title="variable">x</span></a>.<br/>

<br/>
</div>

<div class="doc">
一般に、数値<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>は<span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">=&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">(<a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">...</span> <span class="inlinecode">(<a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>)</span> <span class="inlinecode">...)</span>のような形で、<span class="inlinecode"><a class="idref" href="Basics.html#f"><span class="id" title="variable">f</span></a></span>が<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>回出現するものになります。
    つまり、以前定義した<span class="inlinecode"><a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a></span>関数は実はちょうどチャーチ数での<span class="inlinecode">3</span>を表していることになります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.three"><span class="id" title="definition">three</span></a> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a> := @<a class="idref" href="Poly.html#doit3times"><span class="id" title="definition">doit3times</span></a>.<br/>

<br/>
</div>

<div class="doc">
以下の関数の定義を完成させなさい。
    また、<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>を使えば証明できる以下の単体テストを通過することを確かめなさい。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab136"></a><h4 class="section">練習問題: ★, advanced (church_succ)</h4>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
自然数の+1：チャーチ数<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>について、<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.succ"><span class="id" title="definition">succ</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>は<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>回とさらにもう一回繰り返す関数です。 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.succ"><span class="id" title="definition">succ</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a>) : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.succ_1"><span class="id" title="definition">succ_1</span></a> : <a class="idref" href="Poly.html#Exercises.Church.succ"><span class="id" title="axiom">succ</span></a> <a class="idref" href="Poly.html#Exercises.Church.zero"><span class="id" title="definition">zero</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.succ_2"><span class="id" title="definition">succ_2</span></a> : <a class="idref" href="Poly.html#Exercises.Church.succ"><span class="id" title="axiom">succ</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.succ_3"><span class="id" title="definition">succ_3</span></a> : <a class="idref" href="Poly.html#Exercises.Church.succ"><span class="id" title="axiom">succ</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab137"></a><h4 class="section">練習問題: ★, advanced (church_plus)</h4>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
二つの自然数の加算： 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.plus"><span class="id" title="definition">plus</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a>) : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.plus_1"><span class="id" title="definition">plus_1</span></a> : <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.zero"><span class="id" title="definition">zero</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.plus_2"><span class="id" title="definition">plus_2</span></a> : <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.plus_3"><span class="id" title="definition">plus_3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a>) <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a> (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab138"></a><h4 class="section">練習問題: ★★, advanced (church_mult)</h4>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
乗算： 
</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.mult"><span class="id" title="definition">mult</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a>) : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.mult_1"><span class="id" title="definition">mult_1</span></a> : <a class="idref" href="Poly.html#Exercises.Church.mult"><span class="id" title="axiom">mult</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.mult_2"><span class="id" title="definition">mult_2</span></a> : <a class="idref" href="Poly.html#Exercises.Church.mult"><span class="id" title="axiom">mult</span></a> <a class="idref" href="Poly.html#Exercises.Church.zero"><span class="id" title="definition">zero</span></a> (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.zero"><span class="id" title="definition">zero</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.mult_3"><span class="id" title="definition">mult_3</span></a> : <a class="idref" href="Poly.html#Exercises.Church.mult"><span class="id" title="axiom">mult</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab139"></a><h4 class="section">練習問題: ★★, advanced (church_exp)</h4>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
冪： 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
（ヒント：ここでは多相性が非常に重要な役割を果たします。
    しかし、適切な型を指定するのは結構面倒です。
    もし"Universe inconsistency"というエラーに遭遇した場合、他の型を試してみてください。
    <span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a></span>に関して<span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a></span>で繰り返すのは問題を起こすものなのです。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Exercises.Church.exp"><span class="id" title="definition">exp</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a>) : <a class="idref" href="Poly.html#Exercises.Church.cnat"><span class="id" title="definition">cnat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.exp_1"><span class="id" title="definition">exp_1</span></a> : <a class="idref" href="Poly.html#Exercises.Church.exp"><span class="id" title="axiom">exp</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.exp_2"><span class="id" title="definition">exp_2</span></a> : <a class="idref" href="Poly.html#Exercises.Church.exp"><span class="id" title="axiom">exp</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="Poly.html#Exercises.Church.zero"><span class="id" title="definition">zero</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="Exercises.Church.exp_3"><span class="id" title="definition">exp_3</span></a> : <a class="idref" href="Poly.html#Exercises.Church.exp"><span class="id" title="axiom">exp</span></a> <a class="idref" href="Poly.html#Exercises.Church.three"><span class="id" title="definition">three</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="axiom">plus</span></a> (<a class="idref" href="Poly.html#Exercises.Church.mult"><span class="id" title="axiom">mult</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> (<a class="idref" href="Poly.html#Exercises.Church.mult"><span class="id" title="axiom">mult</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a> <a class="idref" href="Poly.html#Exercises.Church.two"><span class="id" title="definition">two</span></a>)) <a class="idref" href="Poly.html#Exercises.Church.one"><span class="id" title="definition">one</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.  <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Poly.html#Exercises.Church"><span class="id" title="module">Church</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Poly.html#Exercises"><span class="id" title="module">Exercises</span></a>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">表紙</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a><hr/>
<a href="https://github.com/sfja/sfja">ソフトウェアの基礎 日本語化プロジェクト</a>
</div>

</div>

</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>論理の基礎</title>
</head>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>

<body>

<div id="page">

<div id="header">
<a href='../index.html'>
<img src='common/media/image/sf_logo_sm.png'></a>
</br><a href='index.html'><span class='booktitleinheader'>第 1 巻: 論理の基礎</span></a><br></br>
<ul id='menu'>
   <a href='toc.html'><li class='section_name'>目次</li></a>
   <a href='coqindex.html'><li class='section_name'>索引</li></a>
   <a href='deps.html'><li class='section_name'>全体図</li></a>
</ul>
</div>

<div id="main">
<h1 class="libtitle">Lists: 直積、リスト、オプション</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>
<span class="id" title="var">From</span> <span class="id" title="var">LF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="Induction.html#"><span class="id" title="library">Induction</span></a>.<br/>
<span class="id" title="keyword">Module</span> <a name="NatList"><span class="id" title="module">NatList</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab64"></a><h1 class="section">数のペア</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> による型定義では、各構成子は任意の個数の引数を取ることができました。
    <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> や <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> のように引数のないもの、 <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> のようにひとつのもの、また、ふたつ以上取るものも <span class="inlinecode"><a class="idref" href="Basics.html#nybble"><span class="id" title="inductive">nybble</span></a></span> や以下のように定義することができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="NatList.natprod"><span class="id" title="inductive">natprod</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
| <a name="NatList.pair"><span class="id" title="constructor">pair</span></a> (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>

<br/>
</div>

<div class="doc">
この定義は以下のように読めます。
    「数のペアを構成する方法がただひとつある。それは、構成子 <span class="inlinecode"><a class="idref" href="Poly.html#pair"><span class="id" title="constructor">pair</span></a></span> を <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> 型のふたつの引数に適用することである。」 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> (<a class="idref" href="Lists.html#NatList.pair"><span class="id" title="constructor">pair</span></a> 3 5).<br/>

<br/>
</div>

<div class="doc">
ペアの第一要素と第二要素を取り出す関数を定義します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.fst"><span class="id" title="definition">fst</span></a> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.pair"><span class="id" title="constructor">pair</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.snd"><span class="id" title="definition">snd</span></a> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.pair"><span class="id" title="constructor">pair</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span> =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Lists.html#NatList.pair"><span class="id" title="constructor">pair</span></a> 3 5)).<br/>

<br/>
</div>

<div class="doc">
ペアはよく使うので、 <span class="inlinecode"><a class="idref" href="Poly.html#pair"><span class="id" title="constructor">pair</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span> ではなく、数学の標準的な記法で <span class="inlinecode">(<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>)</span> と書けるとよいでしょう。
    このような記法を使うためには <span class="inlinecode"><span class="id" title="keyword">Notation</span></span> 宣言を使います。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">&quot;</span></a>( x , y )" := (<a class="idref" href="Lists.html#NatList.pair"><span class="id" title="constructor">pair</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
こうして定義したペアの新しい記法（notation）は、式だけでなくパターンマッチに使うこともできます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Compute</span> (<a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a>3<a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a>5<a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.fst'"><span class="id" title="definition">fst'</span></a> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><span class="id" title="var">y</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.snd'"><span class="id" title="definition">snd'</span></a> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><span class="id" title="var">y</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.swap_pair"><span class="id" title="definition">swap_pair</span></a> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>) : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><span class="id" title="var">y</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a> =&gt; <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><span class="id" title="var">y</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><span class="id" title="var">x</span><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Note that pattern-matching on a pair (with parentheses: <span class="inlinecode">(<a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>)</span>)
    is not to be confused with the "multiple pattern" syntax
    (with no parentheses: <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>) that we have seen previously.

<div class="paragraph"> </div>

    The above examples illustrate pattern matching on a pair with
    elements <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> and <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>, whereas <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground2.minus"><span class="id" title="definition">minus</span></a></span> below (taken from
    <span class="inlinecode"><span class="id" title="library">Basics</span></span>) performs pattern matching on the values <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>
    and <span class="inlinecode"><a class="idref" href="Basics.html#m"><span class="id" title="variable">m</span></a></span>.

<div class="paragraph"> </div>

       Fixpoint minus (n m : nat) : nat :=
         match n, m with
         | O   , _    =&gt; O
         | S _ , O    =&gt; n
         | S n', S m' =&gt; minus n' m'
         end.

<div class="paragraph"> </div>

    The distinction is minor, but it is worth knowing that they
    are not the same. For instance, the following definitions are
    ill-formed:

<div class="paragraph"> </div>

                Definition bad_fst (p : natprod) : nat :=
          match p with
          | x, y =&gt; x
          end.

<div class="paragraph"> </div>

                Definition bad_minus (n m : nat) : nat :=
          match n, m with
          | (O   , _   ) =&gt; O
          | (S _ , O   ) =&gt; n
          | (S n', S m') =&gt; bad_minus n' m'
          end.

</div>
<div class="code">

<br/>
</div>

<div class="doc">
それでは、数のペアに関する簡単な事実をいくつか証明してみましょう。

<div class="paragraph"> </div>

    一定の形式で書いておくと、単に reflexivity（と組み込みの簡約）だけで証明できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.surjective_pairing'"><span class="id" title="lemma">surjective_pairing'</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span> <span class="id" title="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><a class="idref" href="Lists.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><a class="idref" href="Lists.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">),</span></a> <a class="idref" href="Lists.html#NatList.snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a><a class="idref" href="Lists.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">))</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
しかし、補題を以下のようにより自然な書き方をした場合、<span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span>では足りません。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.surjective_pairing_stuck"><span class="id" title="lemma">surjective_pairing_stuck</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a> <a class="idref" href="Lists.html#NatList.snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">simpl</span></span> で <span class="inlinecode"><a class="idref" href="Poly.html#fst"><span class="id" title="definition">fst</span></a></span> や <span class="inlinecode"><a class="idref" href="Poly.html#snd"><span class="id" title="definition">snd</span></a></span> の中のパターンマッチを実行できるよう、 <span class="inlinecode"><a class="idref" href="Induction.html#p"><span class="id" title="variable">p</span></a></span> の構造を明らかにする必要があります。
    これには <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> を使います。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.surjective_pairing"><span class="id" title="lemma">surjective_pairing</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a> <a class="idref" href="Lists.html#NatList.snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">n</span> <span class="id" title="var">m</span>]. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
2つのサブゴールを生成していた <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> の場合と異なり、 <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> でサブゴールが増えることはありません。
    これは、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a></span> の構成法がひとつしかないからです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab65"></a><h4 class="section">練習問題: ★, standard (snd_fst_is_swap)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="NatList.snd_fst_is_swap"><span class="id" title="lemma">snd_fst_is_swap</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">,</span></a> <a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a><a class="idref" href="Lists.html#5933d26a4c7d589260a3f2940c9b1a3c"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.swap_pair"><span class="id" title="definition">swap_pair</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab66"></a><h4 class="section">練習問題: ★, standard, optional (fst_swap_is_snd)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="NatList.fst_swap_is_snd"><span class="id" title="lemma">fst_swap_is_snd</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">p</span> : <a class="idref" href="Lists.html#NatList.natprod"><span class="id" title="inductive">natprod</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="Lists.html#NatList.swap_pair"><span class="id" title="definition">swap_pair</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="Lists.html#p"><span class="id" title="variable">p</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab67"></a><h1 class="section">数のリスト</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
ペアの定義を一般化することで、数の「リスト(<i>list</i>)」は次のように表すことができます。
    「リストは、空のリストであるか、または数と他のリストをペアにしたものである。」 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="NatList.natlist"><span class="id" title="inductive">natlist</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="NatList.nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <a name="NatList.cons"><span class="id" title="constructor">cons</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">l</span> : <a class="idref" href="Lists.html#natlist"><span class="id" title="inductive">natlist</span></a>).<br/>

<br/>
</div>

<div class="doc">
たとえば、次の定義は要素が三つのリストです 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.mylist"><span class="id" title="definition">mylist</span></a> := <a class="idref" href="Lists.html#NatList.cons"><span class="id" title="constructor">cons</span></a> 1 (<a class="idref" href="Lists.html#NatList.cons"><span class="id" title="constructor">cons</span></a> 2 (<a class="idref" href="Lists.html#NatList.cons"><span class="id" title="constructor">cons</span></a> 3 <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>)).<br/>

<br/>
</div>

<div class="doc">
ペアの場合と同じく、リストをプログラミング言語で馴染んだ記法で書くことができると便利でしょう。
    次の宣言では <span class="inlinecode">::</span> を中置の <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> 演算子として使えるようにし、角括弧をリストを構成するための外置（outfix）記法として使えるようにしています。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">&quot;</span></a>x :: l" := (<a class="idref" href="Lists.html#NatList.cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">x</span> <span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a name="5379aedf9373a87f66d3920b2018278f"><span class="id" title="notation">&quot;</span></a>[ ]" := <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a name="bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">&quot;</span></a>[ x ; .. ; y ]" := (<a class="idref" href="Lists.html#NatList.cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">x</span> .. (<a class="idref" href="Lists.html#NatList.cons"><span class="id" title="constructor">cons</span></a> <span class="id" title="var">y</span> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>) ..).<br/>

<br/>
</div>

<div class="doc">
この宣言を詳細まで理解する必要はありませんが、興味のある読者のために簡単に説明しておきます。
    <span class="inlinecode"><span class="id" title="tactic">right</span></span> <span class="inlinecode"><span class="id" title="keyword">associativity</span></span> アノテーションは複数の <span class="inlinecode">::</span> を使った式にどのように括弧を付けるか指示するものです。
    例えば、次の三つの宣言はすべて同じ意味に解釈されます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.mylist1"><span class="id" title="definition">mylist1</span></a> := 1 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">(</span></a>2 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">(</span></a>3 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a><a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">))</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.mylist2"><span class="id" title="definition">mylist2</span></a> := 1 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> 2 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> 3 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.mylist3"><span class="id" title="definition">mylist3</span></a> := <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">at</span></span> <span class="inlinecode"><span class="id" title="keyword">level</span></span> <span class="inlinecode">60</span> の部分は <span class="inlinecode">::</span> を他の中置演算子といっしょに使っている式にどのように括弧を付けるかを指示するものです。
    例えば、 <span class="inlinecode">+</span> を <span class="inlinecode"><a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a></span> に対する level 50 の中置記法として定義したので、
<br/>
<span class="inlinecode">&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> "x + y" := (<a class="idref" href="Poly.html#Exercises.Church.plus"><span class="id" title="definition">plus</span></a> <a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).
<div class="paragraph"> </div>

</span>    <span class="inlinecode">+</span> は <span class="inlinecode">::</span> よりも強く結合し、 <span class="inlinecode">1</span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> <span class="inlinecode">::</span> <span class="inlinecode">[3]</span> は期待通り、 <span class="inlinecode">1</span> <span class="inlinecode">+</span> <span class="inlinecode">(2</span> <span class="inlinecode">::</span> <span class="inlinecode">[3])</span> ではなく <span class="inlinecode">(1</span> <span class="inlinecode">+</span> <span class="inlinecode">2)</span> <span class="inlinecode">::</span> <span class="inlinecode">[3]</span> と構文解析されます。

<div class="paragraph"> </div>

    （<span class="inlinecode">.<a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a></span> ファイルを読んでいるときには "<span class="inlinecode">1</span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> <span class="inlinecode">::</span> <span class="inlinecode">[3]</span>" のような書き方は少し読みにくいように感じるでしょう。
    内側の 3 の左右の角括弧はリストを表すものですが、外側の括弧は "coqdoc" 用の命令で、角括弧内の部分をそのままのテキストではなく Coq のコードとして表示するよう指示するものです。
    この角括弧は生成された HTML には現れません。）

<div class="paragraph"> </div>

    上の二番目と三番目の <span class="inlinecode"><span class="id" title="keyword">Notation</span></span> 宣言は標準的なリストの記法を導入するためのものです。
    三番目の <span class="inlinecode"><span class="id" title="keyword">Notation</span></span> の右辺は、 n 引数の記法を二項構成子の入れ子に変換する記法を定義するための Coq の構文の例です。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab68"></a><h3 class="section">Repeat</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
リストを操作するために便利な関数がいくつかあります。
    例えば、 <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> 関数は数 <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> と <span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span> を取り、各要素が <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> で長さ <span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span> のリストを返します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.repeat"><span class="id" title="definition">repeat</span></a> (<span class="id" title="var">n</span> <span class="id" title="var">count</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#count"><span class="id" title="variable">count</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> =&gt; <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">count'</span> =&gt; <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#repeat"><span class="id" title="definition">repeat</span></a> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="var">count'</span><a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab69"></a><h3 class="section">Length</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> 関数はリストの長さを計算します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.length"><span class="id" title="definition">length</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Lists.html#length"><span class="id" title="definition">length</span></a> <span class="id" title="var">t</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab70"></a><h3 class="section">Append</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a></span> 関数はふたつのリストを連結(append)します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.app"><span class="id" title="definition">app</span></a> (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>    =&gt; <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">h</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#app"><span class="id" title="definition">app</span></a> <span class="id" title="var">t</span> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a><a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a></span> はこの後でよく使うので、中置演算子を用意しておくと便利でしょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">&quot;</span></a>x ++ y" := (<a class="idref" href="Lists.html#NatList.app"><span class="id" title="definition">app</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60).<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_app1"><span class="id" title="definition">test_app1</span></a>:             <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_app2"><span class="id" title="definition">test_app2</span></a>:             <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_app3"><span class="id" title="definition">test_app3</span></a>:             <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab71"></a><h3 class="section">先頭（デフォルト値付き）と後ろ</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
もうふたつリストを使った例を見てみましょう。
    <span class="inlinecode"><a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a></span> 関数はリストの最初の要素（先頭—— head）を返し、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.tl"><span class="id" title="definition">tl</span></a></span> は最初の要素を除いたもの（後ろ―― tail）を返します。
    空のリストには最初の要素はありませんから、その場合に返す値を引数として渡しておかなければなりません。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.hd"><span class="id" title="definition">hd</span></a> (<span class="id" title="var">default</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="Lists.html#default"><span class="id" title="variable">default</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.tl"><span class="id" title="definition">tl</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_hd1"><span class="id" title="definition">test_hd1</span></a>:             <a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a> 0 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 1.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_hd2"><span class="id" title="definition">test_hd2</span></a>:             <a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a> 0 <a class="idref" href="Lists.html#5379aedf9373a87f66d3920b2018278f"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_tl"><span class="id" title="definition">test_tl</span></a>:              <a class="idref" href="Lists.html#NatList.tl"><span class="id" title="definition">tl</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab72"></a><h3 class="section">練習問題</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab73"></a><h4 class="section">練習問題: ★★, standard, recommended (list_funs)</h4>


<div class="paragraph"> </div>

    以下の <span class="inlinecode"><a class="idref" href="Lists.html#NatList.nonzeros"><span class="id" title="definition">nonzeros</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.oddmembers"><span class="id" title="definition">oddmembers</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.countoddmembers"><span class="id" title="definition">countoddmembers</span></a></span> の定義を完成させなさい。
    どのように動くかは続くテストから考えてください。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.nonzeros"><span class="id" title="definition">nonzeros</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_nonzeros"><span class="id" title="definition">test_nonzeros</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.nonzeros"><span class="id" title="axiom">nonzeros</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.oddmembers"><span class="id" title="definition">oddmembers</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_oddmembers"><span class="id" title="definition">test_oddmembers</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.oddmembers"><span class="id" title="axiom">oddmembers</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.countoddmembers"><span class="id" title="definition">countoddmembers</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_countoddmembers1"><span class="id" title="definition">test_countoddmembers1</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.countoddmembers"><span class="id" title="axiom">countoddmembers</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 4.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_countoddmembers2"><span class="id" title="definition">test_countoddmembers2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.countoddmembers"><span class="id" title="axiom">countoddmembers</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>0<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_countoddmembers3"><span class="id" title="definition">test_countoddmembers3</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.countoddmembers"><span class="id" title="axiom">countoddmembers</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab74"></a><h4 class="section">練習問題: ★★★, advanced (alternate)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Lists.html#NatList.alternate"><span class="id" title="definition">alternate</span></a></span> の定義を完成させなさい。
    この関数は、ふたつのリストから交互に要素を取り出しひとつにまとめる関数です。
    具体的な例は下のテストを見てください。

<div class="paragraph"> </div>

    （注意: <span class="inlinecode"><a class="idref" href="Lists.html#NatList.alternate"><span class="id" title="definition">alternate</span></a></span> の自然な定義のひとつは、 Coq の要求する「<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span> による定義は『明らかに停止する』ものでなければならない」という性質を満たすことができません。
    このパターンにはまってしまったようであれば、両方のリストの要素を同時に見ていくような少し冗長な方法を探してみてください。
    新しい対を定義する必要のある解法もありますが、それ以外にもあります。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.alternate"><span class="id" title="definition">alternate</span></a> (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_alternate1"><span class="id" title="definition">test_alternate1</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.alternate"><span class="id" title="axiom">alternate</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_alternate2"><span class="id" title="definition">test_alternate2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.alternate"><span class="id" title="axiom">alternate</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_alternate3"><span class="id" title="definition">test_alternate3</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.alternate"><span class="id" title="axiom">alternate</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_alternate4"><span class="id" title="definition">test_alternate4</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.alternate"><span class="id" title="axiom">alternate</span></a> <a class="idref" href="Lists.html#5379aedf9373a87f66d3920b2018278f"><span class="id" title="notation">[]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>20<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>30<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>20<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>30<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab75"></a><h3 class="section">リストを使ったバッグ</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
バッグ（<span class="inlinecode"><a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a></span>、または多重集合—— <span class="inlinecode"><span class="id" title="var">multiset</span></span>）は集合のようなものですが、それぞれの要素が一度きりではなく複数回現れることのできるようなものを言います。
    数のバッグの表現としては数のリストがありえます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.bag"><span class="id" title="definition">bag</span></a> := <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab76"></a><h4 class="section">練習問題: ★★★, standard, recommended (bag_functions)</h4>


<div class="paragraph"> </div>

    バッグに対する <span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.sum"><span class="id" title="definition">sum</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.add"><span class="id" title="definition">add</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.member"><span class="id" title="definition">member</span></a></span> 関数の定義を完成させなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.count"><span class="id" title="definition">count</span></a> (<span class="id" title="var">v</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">s</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
下の証明はすべて <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span> だけでできます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_count1"><span class="id" title="definition">test_count1</span></a>:              <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 1 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_count2"><span class="id" title="definition">test_count2</span></a>:              <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 6 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
多重集合の <span class="inlinecode"><a class="idref" href="Lists.html#NatList.sum"><span class="id" title="definition">sum</span></a></span> （直和、または非交和）は集合の <span class="inlinecode"><span class="id" title="var">union</span></span> （和）と同じようなものです。
    <span class="inlinecode"><a class="idref" href="Lists.html#NatList.sum"><span class="id" title="definition">sum</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> は <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> と <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> の両方の要素を持つ多重集合です。
    （数学者は通常、多重集合の <span class="inlinecode"><span class="id" title="var">union</span></span> に少し異なる定義として、和(sum)を使う代わりに最大(max)を使ったものを与えます。
    それが、この関数の名前を <span class="inlinecode"><span class="id" title="var">union</span></span> にしなかった理由です。）
    <span class="inlinecode"><a class="idref" href="Lists.html#NatList.sum"><span class="id" title="definition">sum</span></a></span> のヘッダには引数の名前を与えませんでした。
    さらに、 <span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span> ではなく <span class="inlinecode"><span class="id" title="keyword">Definition</span></span> を使っています。
    ですから、引数に名前がついていたとしても再帰的な処理はできません。
    問題をこのように設定したのは、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.sum"><span class="id" title="definition">sum</span></a></span> を（定義済みの関数を使うといった）別の方法で定義できないか考えさせるためです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.sum"><span class="id" title="definition">sum</span></a> : <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_sum1"><span class="id" title="definition">test_sum1</span></a>:              <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 1 (<a class="idref" href="Lists.html#NatList.sum"><span class="id" title="axiom">sum</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.add"><span class="id" title="definition">add</span></a> (<span class="id" title="var">v</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">s</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) : <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_add1"><span class="id" title="definition">test_add1</span></a>:                <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 1 (<a class="idref" href="Lists.html#NatList.add"><span class="id" title="axiom">add</span></a> 1 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_add2"><span class="id" title="definition">test_add2</span></a>:                <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.add"><span class="id" title="axiom">add</span></a> 1 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.member"><span class="id" title="definition">member</span></a> (<span class="id" title="var">v</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">s</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_member1"><span class="id" title="definition">test_member1</span></a>:             <a class="idref" href="Lists.html#NatList.member"><span class="id" title="axiom">member</span></a> 1 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_member2"><span class="id" title="definition">test_member2</span></a>:             <a class="idref" href="Lists.html#NatList.member"><span class="id" title="axiom">member</span></a> 2 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab77"></a><h4 class="section">練習問題: ★★★, standard, optional (bag_more_functions)</h4>


<div class="paragraph"> </div>

    練習として、さらに以下の<span class="inlinecode"><a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a></span>用の関数を作成しなさい。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="definition">remove_one</span></a></span> を削除しようとしている数の入っていないバッグに適用した場合は、同じバッグを変更せずに返す。
    （この練習問題はオプション問題ですが、後ろの発展問題で <span class="inlinecode"><a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="definition">remove_one</span></a></span> の定義を必要とするものがあります。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.remove_one"><span class="id" title="definition">remove_one</span></a> (<span class="id" title="var">v</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">s</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) : <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_one1"><span class="id" title="definition">test_remove_one1</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="axiom">remove_one</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_one2"><span class="id" title="definition">test_remove_one2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="axiom">remove_one</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_one3"><span class="id" title="definition">test_remove_one3</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 4 (<a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="axiom">remove_one</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 2.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_one4"><span class="id" title="definition">test_remove_one4</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="axiom">remove_one</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 1.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.remove_all"><span class="id" title="definition">remove_all</span></a> (<span class="id" title="var">v</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">s</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) : <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_all1"><span class="id" title="definition">test_remove_all1</span></a>:  <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.remove_all"><span class="id" title="axiom">remove_all</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_all2"><span class="id" title="definition">test_remove_all2</span></a>:  <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.remove_all"><span class="id" title="axiom">remove_all</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_all3"><span class="id" title="definition">test_remove_all3</span></a>:  <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 4 (<a class="idref" href="Lists.html#NatList.remove_all"><span class="id" title="axiom">remove_all</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 2.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_remove_all4"><span class="id" title="definition">test_remove_all4</span></a>:  <a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 5 (<a class="idref" href="Lists.html#NatList.remove_all"><span class="id" title="axiom">remove_all</span></a> 5 <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 0.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.subset"><span class="id" title="definition">subset</span></a> (<span class="id" title="var">s1</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) (<span class="id" title="var">s2</span>:<a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_subset1"><span class="id" title="definition">test_subset1</span></a>:              <a class="idref" href="Lists.html#NatList.subset"><span class="id" title="axiom">subset</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_subset2"><span class="id" title="definition">test_subset2</span></a>:              <a class="idref" href="Lists.html#NatList.subset"><span class="id" title="axiom">subset</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab78"></a><h4 class="section">練習問題: ★★★, standard, recommended (bag_theorem)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span> や <span class="inlinecode"><a class="idref" href="Lists.html#NatList.add"><span class="id" title="definition">add</span></a></span> を使ったバッグに関する面白い定理を書き、それを証明しなさい。
    この問題はいわゆる自由課題で、真であっても、証明にまだ習っていない技法を使わなければならない定理を思いついてしまうかもしれません。
    証明に行き詰まってしまったら気軽に質問してください。 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.manual_grade_for_bag_theorem"><span class="id" title="definition">manual_grade_for_bag_theorem</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab79"></a><h1 class="section">リストに関する推論</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
数の場合と同じく、リスト処理関数についての簡単な事実はもっぱら簡約のみで証明できることがあります。
    たとえば、次の定理は <span class="inlinecode"><span class="id" title="tactic">reflexivity</span></span> で行われる簡約だけで証明できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.nil_app"><span class="id" title="lemma">nil_app</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#5379aedf9373a87f66d3920b2018278f"><span class="id" title="notation">[]</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
これは、 <span class="inlinecode">[]</span> が <span class="inlinecode"><a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a></span> の定義における「被検査体(scrutinee)」（パターンマッチでその値が「検査(scrutinize)」される式 / 訳注：<span class="inlinecode"><span class="id" title="keyword">match</span></span>と<span class="inlinecode"><span class="id" title="keyword">with</span></span>の間に書いた式）に代入され、パターンマッチが簡約できるようになるからです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
またこれも数の場合と同じように、未知のリストの形（空であるかどうか）に応じた場合分けも有効です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.tl_length_pred"><span class="id" title="lemma">tl_length_pred</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a> (<a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Lists.html#NatList.tl"><span class="id" title="definition">tl</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n</span> <span class="id" title="var">l'</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
ここで、 <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> の場合がうまく行くのは、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.tl"><span class="id" title="definition">tl</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> と定義したからです。
    ここでは、 <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> タクティックの <span class="inlinecode"><span class="id" title="keyword">as</span></span> で <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> と <span class="inlinecode"><a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a></span> のふたつの名前を導入しました。
    これは、リストの <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> 構成子が引数をふたつ（構成するリストの頭部と尾部）取ることに対応しています。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
ただし、リストに関する興味深い定理の証明には、帰納法が必要になるのが普通です。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab80"></a><h3 class="section">お小言</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
単にスクリプトを「読んでいる」だけでは大きな進歩は望めません！
    各スクリプトを実際に Coq で一歩一歩進め、各ステップがその証明にどのようにかかわっているか考えることが大切です。
    そうしなければ、演習に取り組んでも何の意味もありません。
    もうおわかりですよね？ 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab81"></a><h2 class="section">リスト上の帰納法</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a></span> のようなデータ型に対して帰納法で証明をするのは、普通の自然数に対する帰納法よりも馴染みにくさを感じたことでしょう。
    しかし、考え方は同様に単純です。
    <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> 宣言では、宣言した構成子を使って構築できる値の集合を定義しています。
    例えば、ブール値では <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> と <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span> のいずれかであり、数では <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> か数に対する <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> のいずれか、リストであれば <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> か数とリストに対する <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> のいずれかです。

<div class="paragraph"> </div>

    さらに言えば、帰納的に定義された集合の要素になるのは、宣言した構成子を互いに適用したものだけです。
    このことがそのまま帰納的に定義された集合に関する推論の方法になります。
    すなわち、数は <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.O"><span class="id" title="constructor">O</span></a></span> であるか、より小さい数に <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> を適用したものであるかのいずれかです。
    リストは <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> であるか、何らかの数とより小さいリストに <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> を適用したものです。
    他のものも同様です。
    ですから、あるリスト <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> に関する命題 <span class="inlinecode"><a class="idref" href="Logic.html#P"><span class="id" title="variable">P</span></a></span> があり、 <span class="inlinecode"><a class="idref" href="Logic.html#P"><span class="id" title="variable">P</span></a></span> がすべてのリストに対して成り立つことを示したい場合には、次のように推論します。

<div class="paragraph"> </div>

<ul class="doclist">
<li> まず、 <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> が <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> のとき <span class="inlinecode"><a class="idref" href="Logic.html#P"><span class="id" title="variable">P</span></a></span> が <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> について成り立つことを示す。

<div class="paragraph"> </div>


</li>
<li> それから、 <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> が <span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"><a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a></span> であるとき、ある数 <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> とより小さいリスト <span class="inlinecode"><a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a></span> に対して、 <span class="inlinecode"><a class="idref" href="Logic.html#P"><span class="id" title="variable">P</span></a></span> が <span class="inlinecode"><a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a></span> について成り立つと仮定すれば <span class="inlinecode"><a class="idref" href="Logic.html#P"><span class="id" title="variable">P</span></a></span> が <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> についても成り立つことを示す。

</li>
</ul>

<div class="paragraph"> </div>

    大きなリストはそれより小さなリストからのみ作り出され、少しずつ <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> に近付いて行きます。
    よって、このふたつの言明からすべてのリスト <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> に関して <span class="inlinecode"><a class="idref" href="Logic.html#P"><span class="id" title="variable">P</span></a></span> が真であることが言えます。
    具体的な例で説明しましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.app_assoc"><span class="id" title="lemma">app_assoc</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">)</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n</span> <span class="id" title="var">l1'</span> <span class="id" title="var">IHl1'</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="var">IHl1'</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
自然数上の帰納法と同様に、<span class="inlinecode"><span class="id" title="tactic">induction</span></span>タクティックでの<span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode">...</span>節は<span class="inlinecode"><a class="idref" href="Poly.html#cons"><span class="id" title="constructor">cons</span></a></span>の場合の残りのリストに<span class="inlinecode"><span class="id" title="var">l1'</span></span>と名前を付けるために使われています。
    蒸し返すようですが、この Coq の証明はこうして単に静的なテキストとして読んでいる限り、さほど明白で分かりやすいものではありません。
    Coq の証明は、 Coq を対話的に動かしながらポイントごとに「現在のゴールは何か」「コンテキストに何が出ているか」を見て、証明が今どうなっているかを読み下していくことで理解されるようになっています。
    しかし、このような証明の途中経過は、全てが証明結果として書き出されるわけではありません。
    だからこそ、人間向けの自然言語での証明には証明の筋道がわかるように証明の指針を書いておく必要があるのです。
    特に、読者が流れを見失わないよう、ふたつめの場合分けで使う帰納法の仮定が何だったのかわかるようにしておくのは有益なはずです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
比較するために、この定理の非形式的証明を以下に載せます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
定理: 任意のリスト <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a></span>、 <span class="inlinecode"><a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a></span> について、
    <span class="inlinecode">(<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">++</span> <span class="inlinecode"><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>)</span> <span class="inlinecode">++</span> <span class="inlinecode"><a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">++</span> <span class="inlinecode">(<a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a></span> <span class="inlinecode">++</span> <span class="inlinecode"><a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a>)</span>
    が成り立つ。

<div class="paragraph"> </div>

    証明: <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> についての帰納法で証明する

<div class="paragraph"> </div>

<ul class="doclist">
<li> まず、 <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">[]</span> と仮定して
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;([] ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a> = [] ++ (<a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a>) 
<div class="paragraph"> </div>

</span>     を示す。これは <span class="inlinecode">++</span> の定義から自明である。

<div class="paragraph"> </div>


</li>
<li> 次に <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>::<span class="id" title="var">l1'</span></span> かつ
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">l1'</span> ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a> = <span class="id" title="var">l1'</span> ++ (<a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a>) 
<div class="paragraph"> </div>

</span>     （帰納法の仮定）と仮定して
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> :: <span class="id" title="var">l1'</span>) ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a> = (<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> :: <span class="id" title="var">l1'</span>) ++ (<a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a>) 
<div class="paragraph"> </div>

</span>     を示す。 <span class="inlinecode">++</span> の定義から、この式は以下のように変形できる。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> :: ((<span class="id" title="var">l1'</span> ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a>) = <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> :: (<span class="id" title="var">l1'</span> ++ (<a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> ++ <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a>)) 
<div class="paragraph"> </div>

</span>     これは帰納法の仮定から直接導かれる。  <font size=-2>&#9744;</font> 
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab82"></a><h3 class="section">リストの反転</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
より入り組んだリストに関する帰納法による証明の例として、リストを反転させる関数<span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span>を使います。
    <span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span>の定義には<span class="inlinecode"><a class="idref" href="Poly.html#app"><span class="id" title="definition">app</span></a></span>を使うことにします。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.rev"><span class="id" title="definition">rev</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>    =&gt; <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">h</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">t</span> =&gt; <a class="idref" href="Lists.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">t</span> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a><span class="id" title="var">h</span><a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_rev1"><span class="id" title="definition">test_rev1</span></a>:            <a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_rev2"><span class="id" title="definition">test_rev2</span></a>:            <a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab83"></a><h3 class="section"><span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> の性質</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
ここまで見てきたものよりも難易度の高いものですが、リストを反転しても長さの変わらないことを証明します。
    下の方法では、ふたつめの場合分けで行き詰まってしまいます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.rev_length_firsttry"><span class="id" title="lemma">rev_length_firsttry</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n</span> <span class="id" title="var">l'</span> <span class="id" title="var">IHl'</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">IHl'</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode">++</span> と <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> に関する等式が成り立つことを示せれば証明が先に進むはずです。
    この等式を別個の補題として記述してみましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.app_length"><span class="id" title="lemma">app_length</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l1</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n</span> <span class="id" title="var">l1'</span> <span class="id" title="var">IHl1'</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="var">IHl1'</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
補題をできる限り一般的なものにするため、<span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span>の定義で出てくるような結果に対してではなく、「全ての」<span class="inlinecode"><a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a></span>に対するものとして形式化しました。
    目的としたゴールは明らかにリストの反転という状態に全く依存していないという点で、この一般化は自然なものでしょう。
    さらに、この一般的な性質の方がより簡単に証明できます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
これで、元々の証明ができるようになりました。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.rev_length"><span class="id" title="lemma">rev_length</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n</span> <span class="id" title="var">l'</span> <span class="id" title="var">IHl'</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> -&gt; <a class="idref" href="Lists.html#NatList.app_length"><span class="id" title="lemma">app_length</span></a>, <a class="idref" href="Induction.html#plus_comm"><span class="id" title="axiom">plus_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> -&gt; <span class="id" title="var">IHl'</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
対比として、この二つの定理の非形式的な証明を見てみましょう

<div class="paragraph"> </div>

    定理: 二つのリスト <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> と <span class="inlinecode"><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a></span> について、 <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode">(<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">++</span> <span class="inlinecode"><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a></span> が成り立つ。

<div class="paragraph"> </div>

    証明: <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> についての帰納法で証明する。

<div class="paragraph"> </div>

<ul class="doclist">
<li> まず、 <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">[]</span> と仮定して
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> ([] ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) = <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> [] + <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> 
<div class="paragraph"> </div>

</span>      を示す。これは <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> と <span class="inlinecode">++</span> の定義から直接導かれる。

<div class="paragraph"> </div>


</li>
<li> 次に、 <span class="inlinecode"><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>::<span class="id" title="var">l1'</span></span> かつ
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<span class="id" title="var">l1'</span> ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) = <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <span class="id" title="var">l1'</span> + <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> 
<div class="paragraph"> </div>

</span>      と仮定して、
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> ((<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>::<span class="id" title="var">l1'</span>) ++ <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) = <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>::<span class="id" title="var">l1'</span>) + <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) 
<div class="paragraph"> </div>

</span>      を示す。これは <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> と <span class="inlinecode">++</span> の定義および帰納法の仮定から明らかである。 <font size=-2>&#9744;</font> 
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
定理: 任意のリスト <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> について <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> が成り立つ。

<div class="paragraph"> </div>

    証明: <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> についての帰納法で証明する。

<div class="paragraph"> </div>

<ul class="doclist">
<li> まず、 <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">[]</span> と仮定して
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> []) = <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> [] 
<div class="paragraph"> </div>

</span>        を示す。これは <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> と <span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> の定義から直接導かれる

<div class="paragraph"> </div>


</li>
<li> 次に、 <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>::<a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a></span> かつ
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>) = <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a> 
<div class="paragraph"> </div>

</span>        と仮定して、
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> :: <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>)) = <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a> :: <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>) 
<div class="paragraph"> </div>

</span>        を示す。 <span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> の定義から次のように変形できる。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> ((<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>) ++ [<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>]) = <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>) 
<div class="paragraph"> </div>

</span>        これは、先程の補題から、次のものと同じである。
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> (<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>) + <a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> [<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>] = <a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a> <a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a>) 
<div class="paragraph"> </div>

</span>        これは、<span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> の定義および帰納法の仮定から明らかである。 <font size=-2>&#9744;</font> 
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
こういった証明のスタイルは、長ったらしく杓子定規な感じがします。
    最初の何回かは別にして、それ以後は、細かいところは省略してしまって（必要なら頭の中や紙の上で追うのは簡単ですから）、自明でないところにだけ注目した方がわかりやすいでしょう。
    そのように省略がちに書けば、上の証明は次のようになります。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
定理:
     任意のリスト <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> について <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> が成り立つ。

<div class="paragraph"> </div>

    証明: まず、任意の <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> について <span class="inlinecode"><a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode">(<a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> <span class="inlinecode">++</span> <span class="inlinecode">[<a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>])</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode">(<a class="idref" href="Poly.html#length"><span class="id" title="definition">length</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>)</span> であることに注目する（これは <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> についての帰納法から自明である）。
     もとの性質については、 <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> についての帰納法から示し、 <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a>::<a class="idref" href="Tactics.html#l'"><span class="id" title="variable">l'</span></a></span> の場合については、上の性質と帰納法の仮定から導かれる。 <font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
どちらのスタイルの方が好ましいかは、読み手の証明への馴れや、彼らが今まで触れてきた証明がどちらに近いかに依ります。
    本書の目的としては冗長なスタイルの方が無難でしょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab84"></a><h2 class="section"><span class="inlinecode"><span class="id" title="keyword">Search</span></span></h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
これまで見てきたように、定理を証明するには既に証明した定理を、例えば<span class="inlinecode"><span class="id" title="tactic">rewrite</span></span>を通じて、使うことができます。
    しかし、定理を使うためにはその名前を知らなければなりません！
    使えそうな定理の名前をすべて覚えておくのはとても大変です。
    今まで証明した定理を覚えておくだけでも大変なのに、その名前となったら尚更です。

<div class="paragraph"> </div>

    Coq の <span class="inlinecode"><span class="id" title="keyword">Search</span></span> コマンドはこのような場合にとても便利です。
    スクリプトファイルに <span class="inlinecode"><span class="id" title="keyword">Search</span></span> <span class="inlinecode"><a class="idref" href="Imp.html#AExp.foo"><span class="id" title="lemma">foo</span></a></span> と書いて評価させると、 <span class="inlinecode"><a class="idref" href="Imp.html#AExp.foo"><span class="id" title="lemma">foo</span></a></span> に関する証明がすべて表示されます。
    例えば、次の部分のコメントを外せば、これまで <span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> に関して証明した定理が表示されます。 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
続く練習問題に取り組む際や読み進める際には、常に <span class="inlinecode"><span class="id" title="keyword">Search</span></span> コマンドのことを頭の隅に置いておくといいでしょう。
    そうすることでずいぶん時間の節約ができるはずです。

<div class="paragraph"> </div>

    もし ProofGeneral を使っているのなら、 <span class="inlinecode"><span class="id" title="var">C</span>-<a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode"><span class="id" title="var">C</span>-<a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode"><span class="id" title="var">C</span>-<a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> とキー入力をすることで <span class="inlinecode"><span class="id" title="keyword">Search</span></span> コマンドを使うことができます。
    その結果をエディタに貼り付けるには <span class="inlinecode"><span class="id" title="var">C</span>-<a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode"><span class="id" title="var">C</span>-;</span> を使うことができます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab85"></a><h2 class="section">リストについての練習問題 (1)</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab86"></a><h4 class="section">練習問題: ★★★, standard (list_exercises)</h4>


<div class="paragraph"> </div>

    リストについてさらに練習しましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.app_nil_r"><span class="id" title="lemma">app_nil_r</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#5379aedf9373a87f66d3920b2018278f"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.rev_app_distr"><span class="id" title="lemma">rev_app_distr</span></a>: <span class="id" title="keyword">forall</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.rev_involutive"><span class="id" title="lemma">rev_involutive</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> (<a class="idref" href="Lists.html#NatList.rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
次の問題には簡単な解法があります。
    こんがらがってしまったようであれば、少し戻って単純な方法を探してみましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.app_assoc4"><span class="id" title="lemma">app_assoc4</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> <span class="id" title="var">l3</span> <span class="id" title="var">l4</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l4"><span class="id" title="variable">l4</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">))</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">((</span></a><a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">)</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l3"><span class="id" title="variable">l3</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">)</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l4"><span class="id" title="variable">l4</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
前に書いた <span class="inlinecode"><a class="idref" href="Lists.html#NatList.nonzeros"><span class="id" title="definition">nonzeros</span></a></span> 関数に関する練習問題です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="NatList.nonzeros_app"><span class="id" title="lemma">nonzeros_app</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.nonzeros"><span class="id" title="axiom">nonzeros</span></a> (<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.nonzeros"><span class="id" title="axiom">nonzeros</span></a> <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">)</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">++</span></a> <a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.nonzeros"><span class="id" title="axiom">nonzeros</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a><a class="idref" href="Lists.html#673a00295a7a0120427b774318fbd36a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab87"></a><h4 class="section">練習問題: ★★, standard (eqblist)</h4>


<div class="paragraph"> </div>

    次の<span class="inlinecode"><a class="idref" href="Lists.html#NatList.eqblist"><span class="id" title="definition">eqblist</span></a></span>は数のリストの等しさを計算するものです。
    定義を埋めなさい。
    また、どんなリスト<span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span>に対しても<span class="inlinecode"><a class="idref" href="Lists.html#NatList.eqblist"><span class="id" title="definition">eqblist</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span> <span class="inlinecode"><a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a></span>が<span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span>を返すことを示しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.eqblist"><span class="id" title="definition">eqblist</span></a> (<span class="id" title="var">l1</span> <span class="id" title="var">l2</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_eqblist1"><span class="id" title="definition">test_eqblist1</span></a> :<br/>
&nbsp;&nbsp;(<a class="idref" href="Lists.html#NatList.eqblist"><span class="id" title="axiom">eqblist</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>).<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_eqblist2"><span class="id" title="definition">test_eqblist2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.eqblist"><span class="id" title="axiom">eqblist</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_eqblist3"><span class="id" title="definition">test_eqblist3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.eqblist"><span class="id" title="axiom">eqblist</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>3<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>2<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.eqblist_refl"><span class="id" title="lemma">eqblist_refl</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.eqblist"><span class="id" title="axiom">eqblist</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab88"></a><h2 class="section">リストについての練習問題 (2)</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
上で見たバッグについて、いくつかの定理を証明します。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab89"></a><h4 class="section">練習問題: ★, standard (count_member_nonzero)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="NatList.count_member_nonzero"><span class="id" title="lemma">count_member_nonzero</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span> : <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>),<br/>
&nbsp;&nbsp;1 <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 1 (1 <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a>)<a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
以下の <span class="inlinecode"><a class="idref" href="Basics.html#leb"><span class="id" title="definition">leb</span></a></span> に関する補題は、この次の課題に使えるかもしれません。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.leb_n_Sn"><span class="id" title="lemma">leb_n_Sn</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">n</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">n'</span> <span class="id" title="var">IHn'</span>].<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHn'</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
次の練習問題を解く前に、<span class="inlinecode"><a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="definition">remove_one</span></a></span> の定義ができあがっていることを確認してください。 <a name="lab90"></a><h4 class="section">練習問題: ★★★, advanced (remove_does_not_increase_count)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="NatList.remove_does_not_increase_count"><span class="id" title="lemma">remove_does_not_increase_count</span></a>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span> : <a class="idref" href="Lists.html#NatList.bag"><span class="id" title="definition">bag</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 0 (<a class="idref" href="Lists.html#NatList.remove_one"><span class="id" title="axiom">remove_one</span></a> 0 <a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a>)<a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a> <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Lists.html#NatList.count"><span class="id" title="axiom">count</span></a> 0 <a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="Basics.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab91"></a><h4 class="section">練習問題: ★★★, optional (bag_count_sum)</h4>


<div class="paragraph"> </div>

    バッグについて <span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span> と <span class="inlinecode"><a class="idref" href="Lists.html#NatList.sum"><span class="id" title="definition">sum</span></a></span> を使った定理 <span class="inlinecode"><span class="id" title="var">bag_count_sum</span></span> を考え、それをCoqを使って証明しなさい。
    （<span class="inlinecode"><a class="idref" href="IndProp.html#count"><span class="id" title="definition">count</span></a></span>の定義によって証明の難易度が変わるかもしれません。） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab92"></a><h4 class="section">練習問題: ★★★★, advanced (rev_injective)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a></span> 関数が単射である、すなわち
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> : <a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a>), <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> = <a class="idref" href="Poly.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> -&gt; <a class="idref" href="Lists.html#l1"><span class="id" title="variable">l1</span></a> = <a class="idref" href="Lists.html#l2"><span class="id" title="variable">l2</span></a> 
<div class="paragraph"> </div>

</span>    であることを証明しなさい。
    （この練習問題には簡単な解法と難しい解法があります。） 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.manual_grade_for_rev_injective"><span class="id" title="definition">manual_grade_for_rev_injective</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab93"></a><h1 class="section">オプション</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
リストから<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>番目を取り出す関数を定義するとします。
    もし関数の型を<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="IndPrinciples.html#natlist"><span class="id" title="inductive">natlist</span></a></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span>にすると、リストが短すぎる（つまり<span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span>だけの場合）何かの数値を選ばなければなりません。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.nth_bad"><span class="id" title="definition">nth_bad</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> =&gt; 42  <br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> =&gt; <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> =&gt; <a class="idref" href="Lists.html#nth_bad"><span class="id" title="definition">nth_bad</span></a> <span class="id" title="var">l'</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
この方法はあまり良くありません。
    もし<span class="inlinecode"><a class="idref" href="Lists.html#NatList.nth_bad"><span class="id" title="definition">nth_bad</span></a></span>が<span class="inlinecode">42</span>を返したとしても、別の処理なしにはそれが実際にリストにあった値なのかを判断できません。
    より良い方法としては、<span class="inlinecode"><a class="idref" href="Lists.html#NatList.nth_bad"><span class="id" title="definition">nth_bad</span></a></span>の返し値の型を変更して、エラー値を扱えるようにするというものです。
    この型を<span class="inlinecode"><a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a></span>と呼ぶことにします。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="NatList.natoption"><span class="id" title="inductive">natoption</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="NatList.Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;| <a name="NatList.None"><span class="id" title="constructor">None</span></a>.<br/>

<br/>
</div>

<div class="doc">
We can then change the above definition of <span class="inlinecode"><a class="idref" href="Lists.html#NatList.nth_bad"><span class="id" title="definition">nth_bad</span></a></span> to
    return <span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.None"><span class="id" title="constructor">None</span></a></span> when the list is too short and <span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.Some"><span class="id" title="constructor">Some</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> when the
    list has enough members and <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> appears at position <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>. We call
    this new function <span class="inlinecode"><a class="idref" href="Poly.html#nth_error"><span class="id" title="definition">nth_error</span></a></span> to indicate that it may result in an
    error. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.nth_error"><span class="id" title="definition">nth_error</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="Lists.html#NatList.None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> =&gt; <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> =&gt; <a class="idref" href="Lists.html#nth_error"><span class="id" title="definition">nth_error</span></a> <span class="id" title="var">l'</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_nth_error1"><span class="id" title="definition">test_nth_error1</span></a> : <a class="idref" href="Lists.html#NatList.nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>7<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> 4.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_nth_error2"><span class="id" title="definition">test_nth_error2</span></a> : <a class="idref" href="Lists.html#NatList.nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>7<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> 3 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> 7.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_nth_error3"><span class="id" title="definition">test_nth_error3</span></a> : <a class="idref" href="Lists.html#NatList.nth_error"><span class="id" title="definition">nth_error</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>4<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>7<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> 9 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
（HTML版では上の例での証明部分の常套句が消えています。
    もし見たければ直後の四角をクリックしてください。）

<div class="paragraph"> </div>

    この機会に、 Coq のプログラミング言語としての機能として、条件式を紹介しておきましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="NatList.nth_error'"><span class="id" title="definition">nth_error'</span></a> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) (<span class="id" title="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.nil"><span class="id" title="constructor">nil</span></a> =&gt; <a class="idref" href="Lists.html#NatList.None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="Lists.html#d858c414b8a4cf4fa2d591e272c1f4fb"><span class="id" title="notation">::</span></a> <span class="id" title="var">l'</span> =&gt; <span class="id" title="keyword">if</span> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#O"><span class="id" title="constructor">O</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Lists.html#nth_error'"><span class="id" title="definition">nth_error'</span></a> <span class="id" title="var">l'</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#pred"><span class="id" title="abbreviation">pred</span></a> <a class="idref" href="Lists.html#n"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Coq の条件式（if式）は他の言語に見られるものとほとんど同じですが、少しだけ一般化されています。
    Coq には 組み込みのブーリアン型がないため、 Coq の条件式では、実際には、構成子のふたつある任意の帰納型に対する分岐ができます。
    条件部の式が <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> の定義の最初の構成子に評価された場合には真、ふたつめの構成子に評価された場合には偽と見做されます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
次の関数は、 <span class="inlinecode"><a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a></span> 型から <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> の値を取り出し、 <span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.None"><span class="id" title="constructor">None</span></a></span> の場合には与えられたデフォルト値を返します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.option_elim"><span class="id" title="definition">option_elim</span></a> (<span class="id" title="var">d</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">o</span> : <a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#o"><span class="id" title="variable">o</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#NatList.None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="Lists.html#d"><span class="id" title="variable">d</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab94"></a><h4 class="section">練習問題: ★★, standard (hd_error)</h4>


<div class="paragraph"> </div>

    同じ考え方で、以前定義した <span class="inlinecode"><a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a></span> 関数を修正し、 <span class="inlinecode"><a class="idref" href="Poly.html#nil"><span class="id" title="constructor">nil</span></a></span> の場合に返す値を渡さなくて済むようにしなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="NatList.hd_error"><span class="id" title="definition">hd_error</span></a> (<span class="id" title="var">l</span> : <a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) : <a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_hd_error1"><span class="id" title="definition">test_hd_error1</span></a> : <a class="idref" href="Lists.html#NatList.hd_error"><span class="id" title="axiom">hd_error</span></a> <a class="idref" href="Lists.html#5379aedf9373a87f66d3920b2018278f"><span class="id" title="notation">[]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.None"><span class="id" title="constructor">None</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_hd_error2"><span class="id" title="definition">test_hd_error2</span></a> : <a class="idref" href="Lists.html#NatList.hd_error"><span class="id" title="axiom">hd_error</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>1<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> 1.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="NatList.test_hd_error3"><span class="id" title="definition">test_hd_error3</span></a> : <a class="idref" href="Lists.html#NatList.hd_error"><span class="id" title="axiom">hd_error</span></a> <a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">[</span></a>5<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">;</span></a>6<a class="idref" href="Lists.html#bfc30fcd015c2a885d24f82c695312f8"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> 5.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab95"></a><h4 class="section">Exercise: 1 star, standard, optional (option_elim_hd)</h4>


<div class="paragraph"> </div>

    This exercise relates your new <span class="inlinecode"><a class="idref" href="Poly.html#hd_error"><span class="id" title="definition">hd_error</span></a></span> to the old <span class="inlinecode"><a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a></span>. 
</div>
<div class="code">
</div>

<div class="doc">
<a name="lab96"></a><h4 class="section">練習問題: ★, standard, optional (option_elim_hd)</h4>


<div class="paragraph"> </div>

    新しい <span class="inlinecode"><a class="idref" href="Poly.html#hd_error"><span class="id" title="definition">hd_error</span></a></span> と古い <span class="inlinecode"><a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a></span> の関係についての練習問題です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="NatList.option_elim_hd"><span class="id" title="lemma">option_elim_hd</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>:<a class="idref" href="Lists.html#NatList.natlist"><span class="id" title="inductive">natlist</span></a>) (<span class="id" title="var">default</span>:<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#NatList.hd"><span class="id" title="definition">hd</span></a> <a class="idref" href="Lists.html#default"><span class="id" title="variable">default</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.option_elim"><span class="id" title="definition">option_elim</span></a> <a class="idref" href="Lists.html#default"><span class="id" title="variable">default</span></a> (<a class="idref" href="Lists.html#NatList.hd_error"><span class="id" title="axiom">hd_error</span></a> <a class="idref" href="Lists.html#l"><span class="id" title="variable">l</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Lists.html#NatList"><span class="id" title="module">NatList</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab97"></a><h1 class="section">Partial Maps</h1>

<div class="paragraph"> </div>

 As a final illustration of how data structures can be defined in
    Coq, here is a simple <i>partial map</i> data type, analogous to the
    map or dictionary data structures found in most programming
    languages. 
<div class="paragraph"> </div>

 First, we define a new inductive datatype <span class="inlinecode"><a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a></span> to serve as the
    "keys" of our partial maps. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="id"><span class="id" title="inductive">id</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="Id"><span class="id" title="constructor">Id</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>).<br/>

<br/>
</div>

<div class="doc">
Internally, an <span class="inlinecode"><a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a></span> is just a number.  Introducing a separate type
    by wrapping each nat with the tag <span class="inlinecode"><a class="idref" href="Lists.html#Id"><span class="id" title="constructor">Id</span></a></span> makes definitions more
    readable and gives us the flexibility to change representations
    later if we wish. 
<div class="paragraph"> </div>

 We'll also need an equality test for <span class="inlinecode"><a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a></span>s: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="eqb_id"><span class="id" title="definition">eqb_id</span></a> (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#x1"><span class="id" title="variable">x1</span></a>, <a class="idref" href="Lists.html#x2"><span class="id" title="variable">x2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#Id"><span class="id" title="constructor">Id</span></a> <span class="id" title="var">n1</span>, <a class="idref" href="Lists.html#Id"><span class="id" title="constructor">Id</span></a> <span class="id" title="var">n2</span> =&gt; <span class="id" title="var">n1</span> <a class="idref" href="Basics.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <span class="id" title="var">n2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab98"></a><h4 class="section">Exercise: 1 star, standard (eqb_id_refl)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="eqb_id_refl"><span class="id" title="lemma">eqb_id_refl</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#eqb_id"><span class="id" title="definition">eqb_id</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

 Now we define the type of partial maps: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="PartialMap"><span class="id" title="module">PartialMap</span></a>.<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">NatList</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="PartialMap.partial_map"><span class="id" title="inductive">partial_map</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="PartialMap.empty"><span class="id" title="constructor">empty</span></a><br/>
&nbsp;&nbsp;| <a name="PartialMap.record"><span class="id" title="constructor">record</span></a> (<span class="id" title="var">i</span> : <a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="Lists.html#partial_map"><span class="id" title="inductive">partial_map</span></a>).<br/>

<br/>
</div>

<div class="doc">
この宣言は次のように読めます。
    「<span class="inlinecode"><a class="idref" href="Maps.html#partial_map"><span class="id" title="definition">partial_map</span></a></span> を構成する方法はふたつある。
      構成子 <span class="inlinecode"><a class="idref" href="Maps.html#empty"><span class="id" title="definition">empty</span></a></span> で空の部分写像を表現するか、構成子 <span class="inlinecode"><a class="idref" href="Lists.html#PartialMap.record"><span class="id" title="constructor">record</span></a></span> をキーと値と既存の <span class="inlinecode"><a class="idref" href="Maps.html#partial_map"><span class="id" title="definition">partial_map</span></a></span> に適用してキーと値の対応を追加した <span class="inlinecode"><a class="idref" href="Maps.html#partial_map"><span class="id" title="definition">partial_map</span></a></span> を構成するかのいずれかである。」 
<div class="paragraph"> </div>

 The <span class="inlinecode"><a class="idref" href="Maps.html#update"><span class="id" title="definition">update</span></a></span> function overrides the entry for a given key in a
    partial map by shadowing it with a new one (or simply adds a new
    entry if the given key is not already present). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="PartialMap.update"><span class="id" title="definition">update</span></a> (<span class="id" title="var">d</span> : <a class="idref" href="Lists.html#PartialMap.partial_map"><span class="id" title="inductive">partial_map</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> : <a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a>) (<span class="id" title="var">value</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Lists.html#PartialMap.partial_map"><span class="id" title="inductive">partial_map</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Lists.html#PartialMap.record"><span class="id" title="constructor">record</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#value"><span class="id" title="variable">value</span></a> <a class="idref" href="Lists.html#d"><span class="id" title="variable">d</span></a>.<br/>

<br/>
</div>

<div class="doc">
最後に、 <span class="inlinecode"><a class="idref" href="Lists.html#PartialMap.find"><span class="id" title="definition">find</span></a></span> 関数は、 <span class="inlinecode"><a class="idref" href="Maps.html#partial_map"><span class="id" title="definition">partial_map</span></a></span> から与えられたキーに対応する値を探し出すものです。
    キーが見つからなかった場合には <span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.None"><span class="id" title="constructor">None</span></a></span> を返し、キーが <span class="inlinecode"><span class="id" title="var">val</span></span> に結び付けられていた場合には <span class="inlinecode"><a class="idref" href="Poly.html#OptionPlayground.Some"><span class="id" title="constructor">Some</span></a></span> <span class="inlinecode"><span class="id" title="var">val</span></span> を返します。
    同じキーが複数の値に結び付けられている場合には、最初に見つけた値を返します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="PartialMap.find"><span class="id" title="definition">find</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a>) (<span class="id" title="var">d</span> : <a class="idref" href="Lists.html#PartialMap.partial_map"><span class="id" title="inductive">partial_map</span></a>) : <a class="idref" href="Lists.html#NatList.natoption"><span class="id" title="inductive">natoption</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Lists.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#PartialMap.empty"><span class="id" title="constructor">empty</span></a>         =&gt; <a class="idref" href="Lists.html#NatList.None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Lists.html#PartialMap.record"><span class="id" title="constructor">record</span></a> <span class="id" title="var">y</span> <span class="id" title="var">v</span> <span class="id" title="var">d'</span> =&gt; <span class="id" title="keyword">if</span> <a class="idref" href="Lists.html#eqb_id"><span class="id" title="definition">eqb_id</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Lists.html#find"><span class="id" title="definition">find</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">d'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab99"></a><h4 class="section">Exercise: 1 star, standard (update_eq)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="PartialMap.update_eq"><span class="id" title="lemma">update_eq</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">d</span> : <a class="idref" href="Lists.html#PartialMap.partial_map"><span class="id" title="inductive">partial_map</span></a>) (<span class="id" title="var">x</span> : <a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a>) (<span class="id" title="var">v</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Lists.html#PartialMap.find"><span class="id" title="definition">find</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Lists.html#PartialMap.update"><span class="id" title="definition">update</span></a> <a class="idref" href="Lists.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#NatList.Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Lists.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab100"></a><h4 class="section">Exercise: 1 star, standard (update_neq)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="PartialMap.update_neq"><span class="id" title="lemma">update_neq</span></a> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">d</span> : <a class="idref" href="Lists.html#PartialMap.partial_map"><span class="id" title="inductive">partial_map</span></a>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <a class="idref" href="Lists.html#id"><span class="id" title="inductive">id</span></a>) (<span class="id" title="var">o</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Lists.html#eqb_id"><span class="id" title="definition">eqb_id</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Lists.html#PartialMap.find"><span class="id" title="definition">find</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> (<a class="idref" href="Lists.html#PartialMap.update"><span class="id" title="definition">update</span></a> <a class="idref" href="Lists.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Lists.html#o"><span class="id" title="variable">o</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Lists.html#PartialMap.find"><span class="id" title="definition">find</span></a> <a class="idref" href="Lists.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Lists.html#d"><span class="id" title="variable">d</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">
<span class="id" title="keyword">End</span> <a class="idref" href="Lists.html#PartialMap"><span class="id" title="module">PartialMap</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab101"></a><h4 class="section">Exercise: 2 stars, standard (baz_num_elts)</h4>


<div class="paragraph"> </div>

    Consider the following inductive definition: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="baz"><span class="id" title="inductive">baz</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="Baz1"><span class="id" title="constructor">Baz1</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Lists.html#baz"><span class="id" title="inductive">baz</span></a>)<br/>
&nbsp;&nbsp;| <a name="Baz2"><span class="id" title="constructor">Baz2</span></a> (<span class="id" title="var">y</span> : <a class="idref" href="Lists.html#baz"><span class="id" title="inductive">baz</span></a>) (<span class="id" title="var">b</span> : <a class="idref" href="Basics.html#bool"><span class="id" title="inductive">bool</span></a>).<br/>

<br/>
</div>

<div class="doc">
How <i>many</i> elements does the type <span class="inlinecode"><a class="idref" href="Lists.html#baz"><span class="id" title="inductive">baz</span></a></span> have? (Explain in words,
    in a comment.) 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_baz_num_elts"><span class="id" title="definition">manual_grade_for_baz_num_elts</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">表紙</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a><hr/>
<a href="https://github.com/sfja/sfja">ソフトウェアの基礎 日本語化プロジェクト</a>
</div>

</div>

</body>
</html>

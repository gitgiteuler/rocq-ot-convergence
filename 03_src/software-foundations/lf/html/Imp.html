<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="common/css/sf.css" rel="stylesheet" type="text/css"/>
<title>論理の基礎</title>
</head>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/lf.css" rel="stylesheet" type="text/css"/>

<body>

<div id="page">

<div id="header">
<a href='../index.html'>
<img src='common/media/image/sf_logo_sm.png'></a>
</br><a href='index.html'><span class='booktitleinheader'>第 1 巻: 論理の基礎</span></a><br></br>
<ul id='menu'>
   <a href='toc.html'><li class='section_name'>目次</li></a>
   <a href='coqindex.html'><li class='section_name'>索引</li></a>
   <a href='deps.html'><li class='section_name'>全体図</li></a>
</ul>
</div>

<div id="main">
<h1 class="libtitle">Imp: 単純な命令型プログラム</h1>

<div class="code">
</div>

<div class="doc">

</div>
<div class="code">

<br/>
</div>

<div class="doc">
この章では、学習のためにCoqを使う方法に焦点を当てます。
    ここで学ぶ対象は、Imp と呼ばれる単純な命令型プログラミング言語です。
    Imp は C や Java のような標準的に広く使われている言語の中心部分の機能だけを取り出したものです。
    下の例は、おなじみの数学的関数を Imp で書いたものです。
<pre>
       Z ::= X;;  
       Y ::= 1;;  
       WHILE ~(Z = 0) DO  
         Y ::= Y * Z;;  
         Z ::= Z - 1  
       END  
</pre>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
この章ではImpの構文(<i>syntax</i>)と意味(<i>semantics</i>)の定義方法について学びます。
    「プログラミング言語の基礎(<i>Programming Language Foundations</i>)」（ソフトウェアの基礎(<i>Software Foundations</i>)、第二巻）の章では、プログラムの同値性(<i>program equivalence</i>)の理論を構築し、命令型プログラムについての推論のための論理として一番知られているホーア論理(<i>Hoare Logic</i>)を導入します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-parsing".<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Bool.Bool.html#"><span class="id" title="library">Bool.Bool</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#"><span class="id" title="library">Init.Nat</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Arith.Arith.html#"><span class="id" title="library">Arith.Arith</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Arith.EqNat.html#"><span class="id" title="library">Arith.EqNat</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.omega.Omega.html#"><span class="id" title="library">omega.Omega</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#"><span class="id" title="library">Lists.List</span></a>.<br/>
<span class="id" title="var">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#"><span class="id" title="library">Strings.String</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
<span class="id" title="var">From</span> <span class="id" title="var">LF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Maps.html#"><span class="id" title="library">Maps</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab321"></a><h1 class="section">算術式とブール式</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Impを三つの部分に分けて示します：
    最初に算術式(<i>arithmetic expressions</i>)とブール式(<i>boolean expressions</i>)、次にこれらの式に変数(<i>variables</i>)を加えたもの、
    そして最後に代入(assignment)、条件分岐(conditions)、コマンド合成(sequencing)、ループ(loops)を持つコマンド(<i>commands</i>)の言語です。
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab322"></a><h2 class="section">構文</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="AExp"><span class="id" title="module">AExp</span></a>.<br/>

<br/>
</div>

<div class="doc">
次の2つの定義は、算術式とブール式の抽象構文(<i>abstract syntax</i>)を定めます。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AExp.aexp"><span class="id" title="inductive">aexp</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="AExp.ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.AMult"><span class="id" title="constructor">AMult</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AExp.bexp"><span class="id" title="inductive">bexp</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="AExp.BTrue"><span class="id" title="constructor">BTrue</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.BFalse"><span class="id" title="constructor">BFalse</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.BEq"><span class="id" title="constructor">BEq</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.BLe"><span class="id" title="constructor">BLe</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.BNot"><span class="id" title="constructor">BNot</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.BAnd"><span class="id" title="constructor">BAnd</span></a> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>).<br/>

<br/>
</div>

<div class="doc">
この章では、プログラマが実際に書く具象構文から抽象構文木への変換はほとんど省略します。
    例えば、文字列<span class="inlinecode">&quot;1</span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> <span class="inlinecode">*</span> <span class="inlinecode">3&quot;</span>をAST（Abstract Syntax Tree, 抽象構文木）
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> 1) (<a class="idref" href="Imp.html#AMult"><span class="id" title="constructor">AMult</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> 2) (<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> 3))
<div class="paragraph"> </div>

</span>    にする変換のことです。
    この変換に使う単純な字句解析器と構文解析器をオプションの章<span class="inlinecode"><span class="id" title="library">ImpParser</span></span>で実装します。
    この章を理解するのに<span class="inlinecode"><span class="id" title="library">ImpParser</span></span>章の理解は必要ではありませんが、もしこれらの技術について（例えばコンパイラの講義などで）触れたことがないならば、ざっと見てみるのも良いでしょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
比較のため、同じ抽象構文を定義する慣習的なBNF(Backus-Naur Form)文法を以下に示します:
<pre>
    a ::= nat 
        | a + a 
        | a - a 
        | a * a 
 
    b ::= true 
        | false 
        | a = a 
        | a &lt;= a 
        | ~ b 
        | b &amp;&amp; b 
</pre>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
上述のCoq版と比較して...

<div class="paragraph"> </div>

<ul class="doclist">
<li> BNFはより非形式的です。
         例えば、BNFは式の表面的な構文についていくらかの情報（可算は中置記号<span class="inlinecode">+</span>を使って記述される、など）を与えていますが、字句解析と構文解析の他の面（<span class="inlinecode">+</span>、<span class="inlinecode">-</span>、<span class="inlinecode">*</span>の優先順位、括弧による部分式のくくりだし、など）は定めないままになっています。
         コンパイラを実装するときなどは、この記述を形式的定義にするために、追加の情報（および人間の知性）が必要でしょう。

<div class="paragraph"> </div>

         Coq版はこれらの情報を整合的に省略し、抽象構文だけに集中します。

<div class="paragraph"> </div>


</li>
<li> 逆に、BNF版はより軽くて、読むのがより簡単です。
         非形式的であることで柔軟性を持っているので、黒板を使って議論する場面などでは特段に有効です。
         そういう場面では、細部をいちいち正確に確定させていくことより、全体的アイデアを伝えることが重要だからです。

<div class="paragraph"> </div>

         実際、BNFのような記法は山ほどあり、人は皆、それらの間を自由に行き来しますし、通常はそれらのうちのどのBNFを使っているかを気にしません。
         その必要がないからです。
         おおざっぱな非形式的な理解だけが必要なのです。

</li>
</ul>

<div class="paragraph"> </div>

    両方の記法に通じているのは良いことです。
    非形式的なものは人間とのコミュニケーションに、形式的なものは実装と証明に便利です。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab323"></a><h2 class="section">評価</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
算術式を評価する(<i>evaluating</i>)と、式から1つの数を生成します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="AExp.aeval"><span class="id" title="definition">aeval</span></a> (<span class="id" title="var">a</span> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a>  <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.AMult"><span class="id" title="constructor">AMult</span></a>  <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="AExp.test_aeval1"><span class="id" title="definition">test_aeval1</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 2) (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 2)) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 4.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
同様に、ブール式を評価するとブール値になります。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="AExp.beval"><span class="id" title="definition">beval</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#AExp.bexp"><span class="id" title="inductive">bexp</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.BTrue"><span class="id" title="constructor">BTrue</span></a>       =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.BFalse"><span class="id" title="constructor">BFalse</span></a>      =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.BEq"><span class="id" title="constructor">BEq</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>   =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.BLe"><span class="id" title="constructor">BLe</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>   =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.BNot"><span class="id" title="constructor">BNot</span></a> <span class="id" title="var">b1</span>     =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <span class="id" title="var">b1</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.BAnd"><span class="id" title="constructor">BAnd</span></a> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>  =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <span class="id" title="var">b1</span>) (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab324"></a><h2 class="section">最適化(Optimization)</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
ここまで定義したものはわずかですが、その定義から既にいくらかのものを得ることができます。
    算術式をとって、それを少し簡単化する関数を定義するとします。
    すべての <span class="inlinecode">0</span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> （つまり<span class="inlinecode"><a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a></span> <span class="inlinecode">(<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a></span> <span class="inlinecode">0)</span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span>）を単に<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span>にするものです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> (<span class="id" title="var">a</span>:<a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span> =&gt; <a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 0) <span class="id" title="var">e2</span> =&gt; <a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a>  <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a>  (<a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="Imp.html#AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> (<a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AExp.AMult"><span class="id" title="constructor">AMult</span></a>  <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> =&gt; <a class="idref" href="Imp.html#AExp.AMult"><span class="id" title="constructor">AMult</span></a>  (<a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e1</span>) (<a class="idref" href="Imp.html#optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
この最適化が正しいことをすることを確認するために、
    いくつかの例についてテストして出力がよさそうかを見てみることができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="AExp.test_optimize_0plus"><span class="id" title="definition">test_optimize_0plus</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> (<a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 0) (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 1))))<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 2) (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> 1).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
しかし、もし最適化が正しいことを確認したいならば、つまり、最適化した式がオリジナルの式と同じ評価結果を返すことを確認したいならば、証明すべきです。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.optimize_0plus_sound"><span class="id" title="lemma">optimize_0plus_sound</span></a>: <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ea1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">En</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*   <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*  <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab325"></a><h1 class="section">Coq の自動化</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
前の証明の最後の繰り返しはちょっと面倒です。
    証明対象の言語や最適化の健全性証明が今に比べて著しく複雑だったら、現実的な問題になるでしょう。

<div class="paragraph"> </div>

    ここまで、Coq のタクティックのほんのひとつかみだけですべての証明をしてきていて、証明を自動的に構成する非常に強力な機構を完全に無視してきました。
    このセクションではこれらの機構のいくつかを紹介します。
    それ以上のものを、以降のいくつかの章で次第に見ることになるでしょう。
    それらに慣れるには多少エネルギーが必要でしょう。
 Coq の自動化は電動工具です。--
    しかし自動化機構を使うことで、より複雑な定義や、より興味深い性質について、退屈で繰り返しの多いローレベルな詳細に飲み込まれることなく、作業をスケールアップできます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab326"></a><h2 class="section">タクティカル(Tacticals)</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
タクティカル(<i>tactical</i>)は Coq の用語で、他のタクティックを引数に取るタクティックのことです。
    「高階タクティック(higher-order tactics)」と言っても良いでしょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab327"></a><h3 class="section"><span class="inlinecode"><span class="id" title="tactic">try</span></span>タクティカル</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>がタクティックのとき、タクティック <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> は<span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>と同様ですが、<span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>が失敗するとき<span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> は（失敗する代わりに）成功として何もしない点が違います。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.silly1"><span class="id" title="lemma">silly1</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">ae</span>, <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#ae"><span class="id" title="variable">ae</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#ae"><span class="id" title="variable">ae</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.  <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.silly2"><span class="id" title="lemma">silly2</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>), <a class="idref" href="Imp.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#P"><span class="id" title="variable">P</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">HP</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>. &nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HP</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
There is no real reason to use <span class="inlinecode"><span class="id" title="tactic">try</span></span> in completely manual
    proofs like these, but it is very useful for doing automated
    proofs in conjunction with the <span class="inlinecode">;</span> tactical, which we show
    next. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab328"></a><h3 class="section"><span class="inlinecode">;</span>タクティカル（基本形）</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
一番よくある形として、<span class="inlinecode">;</span> タクティカルは二つのタクティックを引数として取ります。
    <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>と<span class="inlinecode"><span class="id" title="var">T'</span></span>がタクティックのとき、<span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a>;<span class="id" title="var">T'</span></span> はタクティックで、最初に<span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>を行い、<span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>が生成した「サブゴールそれぞれ」に<span class="inlinecode"><span class="id" title="var">T'</span></span>を行います。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
例えば、次の簡単な補題を考えます: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="AExp.foo"><span class="id" title="lemma">foo</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-  <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;-  <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
上の証明を<span class="inlinecode">;</span>タクティカルを使って簡単化できます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="AExp.foo'"><span class="id" title="lemma">foo'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">try</span></span>と<span class="inlinecode">;</span>の両方を使うと、ちょっと前に悩まされた証明の繰り返しを取り除くことができます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.optimize_0plus_sound'"><span class="id" title="lemma">optimize_0plus_sound'</span></a>: <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ea1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHa1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">En</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
Coqの専門家は、<span class="inlinecode"><span class="id" title="tactic">try</span></span>を<span class="inlinecode"><span class="id" title="tactic">induction</span></span>のようなタクティックと一緒に使うことで、多くの似たような「簡単な」場合を一度に処理します。
    これは自然に非形式的な証明に対応します。
    例えば、この定理の形式的な証明の構造にマッチする非形式的な証明は次の通りです:

<div class="paragraph"> </div>

    「定理」: すべての算術式<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span>について
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a>) = <a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a>
<div class="paragraph"> </div>

</span>    「証明」: <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span>についての帰納法を使う。
    ほとんどの場合は帰納仮定から直ちに得られる。
    残るのは以下の場合である:

<div class="paragraph"> </div>

<ul class="doclist">
<li> ある<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>について <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> とする。示すべきことは次の通りである:
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>)) = <a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a>)
<div class="paragraph"> </div>

</span>        これは<span class="inlinecode"><a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a></span>の定義からすぐに得られる。

<div class="paragraph"> </div>


</li>
<li> ある<span class="inlinecode"><a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a></span>と<span class="inlinecode"><a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a></span>について <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a></span> とする。
        示すべきことは次の通りである:
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> (<a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a>)) = <a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a>)
<div class="paragraph"> </div>

</span>        <span class="inlinecode"><a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a></span>のとり得る形を考える。
        そのほとんどの場合、<span class="inlinecode"><a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a></span>は部分式について単に自分自身を再帰的に呼び出し、<span class="inlinecode"><a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a></span>と同じ形の新しい式を再構成する。
        これらの場合、結果は帰納仮定からすぐに得られる。

<div class="paragraph"> </div>

        興味深い場合は、ある<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>について <span class="inlinecode"><a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> であるときである。
        このとき <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span> ならば次が成立する:
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> (<a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Logic.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a>) = <a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a> 
<div class="paragraph"> </div>

</span>        そして<span class="inlinecode"><a class="idref" href="Logic.html#a2"><span class="id" title="variable">a2</span></a></span>についての帰納仮定がまさに求めるものである。
        一方、ある<span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span>について <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Logic.html#n'"><span class="id" title="variable">n'</span></a></span> ならば、<span class="inlinecode"><a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a></span>はやはり自分自身を再帰的に呼び出し、結果は帰納仮定から得られる。 <font size=-2>&#9744;</font> 
</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
しかし、この証明はさらに改良できます。
    最初の場合（<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.a"><span class="id" title="constructor">a</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> のとき）はかなり自明です。
    帰納仮定からすぐに得られるとわざわざ言う必要もないくらい自明でしょう。
    それなのに完全に記述しています。
    これを消して、単に最初に
    「ほとんどの場合、すぐに、あるいは帰納仮定から直接得られる。興味深いのは<span class="inlinecode"><a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a></span>の場合だけである...」
    と言った方がより良く、より明快でしょう。
    同じ改良を形式的な証明にも行うことができます。
    以下のようになります: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.optimize_0plus_sound''"><span class="id" title="lemma">optimize_0plus_sound''</span></a>: <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">a1</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">IHa1</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+  <span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab329"></a><h3 class="section">The <span class="inlinecode">;</span> Tactical (General Form)</h3>

<div class="paragraph"> </div>

 The <span class="inlinecode">;</span> tactical also has a more general form than the simple
    <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a>;<span class="id" title="var">T'</span></span> we've seen above.  If <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>, <span class="inlinecode"><span class="id" title="var">T1</span></span>, ..., <span class="inlinecode"><span class="id" title="var">Tn</span></span> are tactics,
    then

<div class="paragraph"> </div>

      T; <span class="inlinecode"><span class="id" title="var">T1</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">T2</span></span> <span class="inlinecode">|</span> <span class="inlinecode">...</span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">Tn</span></span>

<div class="paragraph"> </div>

    is a tactic that first performs <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> and then performs <span class="inlinecode"><span class="id" title="var">T1</span></span> on the
    first subgoal generated by <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>, performs <span class="inlinecode"><span class="id" title="var">T2</span></span> on the second
    subgoal, etc.

<div class="paragraph"> </div>

    So <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a>;<span class="id" title="var">T'</span></span> is just special notation for the case when all of the
    <span class="inlinecode"><span class="id" title="var">Ti</span></span>'s are the same tactic; i.e., <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a>;<span class="id" title="var">T'</span></span> is shorthand for:

<div class="paragraph"> </div>

      T; <span class="inlinecode"><span class="id" title="var">T'</span></span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">T'</span></span> <span class="inlinecode">|</span> <span class="inlinecode">...</span> <span class="inlinecode">|</span> <span class="inlinecode"><span class="id" title="var">T'</span></span>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab330"></a><h3 class="section">The <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> Tactical</h3>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> tactical takes another tactic and keeps applying this
    tactic until it fails. Here is an example showing that <span class="inlinecode">10</span> is in
    a long list using repeat. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.In10"><span class="id" title="lemma">In10</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> 10 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>5<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>6<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>7<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>8<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>9<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>10<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> (<span class="id" title="tactic">left</span>; <span class="id" title="tactic">reflexivity</span>); <span class="id" title="tactic">right</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> never fails: if the tactic <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> doesn't apply
    to the original goal, then repeat still succeeds without changing
    the original goal (i.e., it repeats zero times). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.In10'"><span class="id" title="lemma">In10'</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> 10 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>5<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>6<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>7<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>8<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>9<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>10<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">left</span>; <span class="id" title="tactic">reflexivity</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">right</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">left</span>; <span class="id" title="tactic">reflexivity</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> also does not have any upper bound on the
    number of times it applies <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span>.  If <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> is a tactic that always
    succeeds, then repeat <span class="inlinecode"><a class="idref" href="Logic.html#T"><span class="id" title="variable">T</span></a></span> will loop forever (e.g., <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> <span class="inlinecode"><span class="id" title="tactic">simpl</span></span>
    loops, since <span class="inlinecode"><span class="id" title="tactic">simpl</span></span> always succeeds).  While evaluation in Coq's
    term language, Gallina, is guaranteed to terminate, tactic
    evaluation is not!  This does not affect Coq's logical
    consistency, however, since the job of <span class="inlinecode"><span class="id" title="tactic">repeat</span></span> and other tactics
    is to guide Coq in constructing proofs; if the construction
    process diverges (i.e., it does not terminate), this simply means
    that we have failed to construct a proof, not that we have
    constructed a wrong one. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab331"></a><h4 class="section">練習問題: ★★★, standard (optimize_0plus_b_sound)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a></span>の変換が<span class="inlinecode"><a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a></span>の値を変えないことから、<span class="inlinecode"><a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a></span>の値を変えずに、<span class="inlinecode"><a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a></span>に現れる<span class="inlinecode"><a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a></span>をすべて変換するために<span class="inlinecode"><a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a></span>が適用できるべきでしょう。
    <span class="inlinecode"><a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a></span>についてこの変換をする関数を記述しなさい。
    そして、それが健全であることを証明しなさい。
    ここまで見てきたタクティカルを使って証明を可能な限りエレガントにしなさい。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="AExp.optimize_0plus_b"><span class="id" title="definition">optimize_0plus_b</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#AExp.bexp"><span class="id" title="inductive">bexp</span></a>) : <a class="idref" href="Imp.html#AExp.bexp"><span class="id" title="inductive">bexp</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.optimize_0plus_b_sound"><span class="id" title="lemma">optimize_0plus_b_sound</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.beval"><span class="id" title="definition">beval</span></a> (<a class="idref" href="Imp.html#AExp.optimize_0plus_b"><span class="id" title="axiom">optimize_0plus_b</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#AExp.beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab332"></a><h4 class="section">練習問題: ★★★★, standard, optional (optimize)</h4>


<div class="paragraph"> </div>

    設計練習: 定義した<span class="inlinecode"><a class="idref" href="Imp.html#AExp.optimize_0plus"><span class="id" title="definition">optimize_0plus</span></a></span>関数で実装された最適化は、算術式やブール式に対して考えられるいろいろな最適化の単なる1つに過ぎません。
    より洗練された最適化関数を記述し、その正しさを証明しなさい。
    （本当に簡単な最適化を作って証明し、それを少しずつ面白いものに仕立て上げていくと良いでしょう。） 
</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab333"></a><h2 class="section">新しいタクティック記法を定義する</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Coqはまた、タクティックスクリプトを「プログラミングする」いろいろな方法も提供します。

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="keyword">Tactic</span></span> <span class="inlinecode"><span class="id" title="keyword">Notation</span></span> コマンドは、「略記法タクティック("shorthand tactics")」を定義する簡単な方法を提供します。
      「略記法タクティック」は、呼ばれると、いろいろなタクティックを一度に適用します。

<div class="paragraph"> </div>


</li>
<li> より洗練されたプログラミングのために、Coqは<span class="inlinecode"><span class="id" title="keyword">Ltac</span></span>と呼ばれる小さな組込みの言語と、証明の状態を調べたり変更したりするための<span class="inlinecode"><span class="id" title="keyword">Ltac</span></span>のプリミティブを提供します。
      その詳細はここで説明するにはちょっと複雑過ぎます（しかも、<span class="inlinecode"><span class="id" title="keyword">Ltac</span></span>はCoqの設計の一番美しくない部分だというのが共通見解です!）。
      しかし、詳細はリファレンスマニュアルにありますし、Coqの標準ライブラリには、読者が参考にできる<span class="inlinecode"><span class="id" title="keyword">Ltac</span></span>の定義のたくさんの例があります。

<div class="paragraph"> </div>


</li>
<li> Coqの内部構造のより深いレベルにアクセスする新しいタクティックを作ることができるOCaml API も存在します。
      しかしこれは、普通のCoqユーザにとっては、苦労が報われることはほとんどありません。

</li>
</ul>

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="keyword">Tactic</span></span> <span class="inlinecode"><span class="id" title="keyword">Notation</span></span> 機構は取り組むのに一番簡単で、多くの目的に十分なパワーを発揮します。
    例を挙げます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Tactic Notation</span> "simpl_and_try" <span class="id" title="var">tactic</span>(<span class="id" title="var">c</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">c</span>.<br/>

<br/>
</div>

<div class="doc">
これは1つのタクティック<span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span>を引数としてとる<span class="inlinecode"><span class="id" title="var">simpl_and_try</span></span>という新しいタクティカルを定義しています。
    <span class="inlinecode"><span class="id" title="var">simpl_and_try</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> はタクティック <span class="inlinecode"><span class="id" title="tactic">simpl</span>;</span> <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> と同値です。
    例えば、証明内で"<span class="inlinecode"><span class="id" title="var">simpl_and_try</span></span> <span class="inlinecode"><span class="id" title="tactic">reflexivity</span>.</span>"と書くことは「<span class="inlinecode"><span class="id" title="tactic">simpl</span>;</span> <span class="inlinecode"><span class="id" title="tactic">try</span></span> <span class="inlinecode"><span class="id" title="tactic">reflexivity</span>.</span>」と書くことと同じでしょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab334"></a><h2 class="section"><span class="inlinecode"><span class="id" title="tactic">omega</span></span>タクティック</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">omega</span></span>タクティックは「プレスバーガー算術」(<i>Presburger arithmetic</i>、「プレスブルガー算術」とも)と呼ばれる一階述語論理のサブセットの決定手続き(decision procedure)を実装します。
    William Pugh が発明したOmegaアルゴリズム <span class="inlinecode"><span class="id" title="var">Pugh</span></span> <span class="inlinecode">1991</span> （Bib.v 参照）に基いています。

<div class="paragraph"> </div>

    ゴールが以下の要素から構成された全称限量された論理式とします。以下の要素とは:

<div class="paragraph"> </div>

<ul class="doclist">
<li> 数値定数、加算（<span class="inlinecode">+</span>と<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.S"><span class="id" title="constructor">S</span></a></span>）、減算（<span class="inlinecode">-</span>と<span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.pred"><span class="id" title="definition">pred</span></a></span>）、定数の乗算（これがプレスバーガー算術である条件です）、

<div class="paragraph"> </div>


</li>
<li> 等式（<span class="inlinecode">=</span>と<span class="inlinecode">&lt;&gt;</span>）および不等式（<span class="inlinecode">&lt;=</span>）、

<div class="paragraph"> </div>


</li>
<li> 論理演算子<span class="inlinecode">/\</span>, <span class="inlinecode">\/</span>, <span class="inlinecode">~</span>, <span class="inlinecode">-&gt;</span>

</li>
</ul>

<div class="paragraph"> </div>

    です。
    このとき、<span class="inlinecode"><span class="id" title="tactic">omega</span></span>を呼ぶと、ゴールを解くか、失敗によりそのゴールが偽であることを表すか、いずれかになります。
    （ただしゴールが上記の形「ではない」場合にも<span class="inlinecode"><span class="id" title="tactic">omega</span></span>は失敗します。） 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="AExp.silly_presburger_example"><span class="id" title="definition">silly_presburger_example</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> <span class="id" title="var">o</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9b077c369e19739ef880736ba34623ff"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <a class="idref" href="Imp.html#o"><span class="id" title="variable">o</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 3 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#p"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 3 <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9b077c369e19739ef880736ba34623ff"><span class="id" title="notation">&lt;=</span></a> <a class="idref" href="Imp.html#p"><span class="id" title="variable">p</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
(Note the <span class="inlinecode"><span class="id" title="var">From</span></span> <span class="inlinecode"><span class="id" title="var">Coq</span></span> <span class="inlinecode"><span class="id" title="keyword">Require</span></span> <span class="inlinecode"><span class="id" title="keyword">Import</span></span> <span class="inlinecode"><span class="id" title="library">omega.Omega</span>.</span> at the top of
    the file.) 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab335"></a><h2 class="section">便利なタクティックをさらにいくつか</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
最後に、役に立ちそうないろいろなタクティックをいくつか紹介します。

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="tactic">clear</span></span> <span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span>: 仮定<span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span>をコンテキストから消去します。

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>: 変数<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>について、コンテキストから仮定 <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> または <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> を発見し、<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>をコンテキストおよび現在のゴールのすべての場所で<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span>に置き換え、この仮定を消去します。

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">subst</span></span>: <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> および <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> の形（<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>は変数）のすべての仮定を置換します。

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">rename</span>...</span> <span class="inlinecode"><span class="id" title="var">into</span>...</span>: 証明コンテキストの仮定の名前を変更します。
       例えば、コンテキストが<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>という名前の変数を含んでいるとき、<span class="inlinecode"><span class="id" title="tactic">rename</span></span> <span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span> <span class="inlinecode"><span class="id" title="var">into</span></span> <span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span> は、すべての<span class="inlinecode"><a class="idref" href="Basics.html#x"><span class="id" title="variable">x</span></a></span>の出現を<span class="inlinecode"><a class="idref" href="Lists.html#y"><span class="id" title="variable">y</span></a></span>に変えます。

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">assumption</span></span>: ゴールにちょうどマッチする仮定<span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span>をコンテキストから探そうとします。
       発見されたときは <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span> と同様に振る舞います。

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="var">contradiction</span></span>: <span class="inlinecode"><a class="idref" href="ProofObjects.html#Props.False"><span class="id" title="inductive">False</span></a></span>と同値の仮定<span class="inlinecode"><a class="idref" href="ProofObjects.html#H"><span class="id" title="variable">H</span></a></span>をコンテキストから探そうとします。
       発見されたときはゴールを解きます。

<div class="paragraph"> </div>


</li>
<li> <span class="inlinecode"><span class="id" title="tactic">constructor</span></span>: 現在のゴールを解くのに使えるコンストラクタ<span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span>を（現在の環境の<span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>による定義から）探そうとします。
       発見されたときは <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> と同様に振る舞います。

</li>
</ul>

<div class="paragraph"> </div>

    進むにしたがって、これら全てについてたくさんの例を見ることになります。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab336"></a><h1 class="section">関係としての評価</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a></span>と<span class="inlinecode"><a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a></span>を<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>によって定義された関数として示しました。
    評価について考える別の方法は、それを式と値との間の関係(<i>relation</i>)と見ることです。
    この方法は、多くの場合<span class="inlinecode"><span class="id" title="keyword">Fixpoint</span></span>を用いたものより柔軟です。
    この考えに立つと、算術式についてCoqの<span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>による以下の定義が自然に出てきます... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="AExp.aevalR_first_try"><span class="id" title="module">aevalR_first_try</span></a>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AExp.aevalR_first_try.aevalR"><span class="id" title="inductive">aevalR</span></a> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.E_ANum"><span class="id" title="constructor">E_ANum</span></a> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.E_APlus"><span class="id" title="constructor">E_APlus</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>: <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a>) (<a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.E_AMinus"><span class="id" title="constructor">E_AMinus</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>: <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a>) (<a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.E_AMult"><span class="id" title="constructor">E_AMult</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>: <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.AMult"><span class="id" title="constructor">AMult</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a>) (<a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>).<br/>

<br/>
<span class="id" title="keyword">Module</span> <a name="AExp.aevalR_first_try.TooHardToRead"><span class="id" title="module">TooHardToRead</span></a>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AExp.aevalR_first_try.TooHardToRead.aevalR"><span class="id" title="inductive">aevalR</span></a> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.TooHardToRead.E_ANum"><span class="id" title="constructor">E_ANum</span></a> <span class="id" title="var">n</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.TooHardToRead.E_APlus"><span class="id" title="constructor">E_APlus</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>: <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H1</span> : <a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H2</span> : <a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a>) (<a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.TooHardToRead.E_AMinus"><span class="id" title="constructor">E_AMinus</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>: <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H1</span> : <a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H2</span> : <a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a>) (<a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>)<br/>
&nbsp;&nbsp;| <a name="AExp.aevalR_first_try.TooHardToRead.E_AMult"><span class="id" title="constructor">E_AMult</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>: <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span>: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H1</span> : <a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H2</span> : <a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> (<a class="idref" href="Imp.html#AExp.AMult"><span class="id" title="constructor">AMult</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a>) (<a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a>).<br/>

<br/>
</div>

<div class="doc">
Instead, we've chosen to leave the hypotheses anonymous, just
    giving their types.  This style gives us less control over the
    names that Coq chooses during proofs involving <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span>, but it
    makes the definition itself quite a bit lighter. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Imp.html#AExp.aevalR_first_try.TooHardToRead"><span class="id" title="module">TooHardToRead</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span>の中置記法を定義するのと便利です。
    算術式<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span>が値<span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>に評価されることを <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode">\\</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> と書きます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="2c3678d89f96f1676814e064cac34bd7"><span class="id" title="notation">&quot;</span></a>e '\\' n"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= (<a class="idref" href="Imp.html#AExp.aevalR_first_try.aevalR"><span class="id" title="inductive">aevalR</span></a> <span class="id" title="var">e</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Imp.html#AExp.aevalR_first_try"><span class="id" title="module">aevalR_first_try</span></a>.<br/>

<br/>
</div>

<div class="doc">
実際は、Coqには<span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span>自身の定義中でこの記法を使う方法があります。
    これにより、<span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode">\\</span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> の形の主張を含む証明で、<span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.e"><span class="id" title="constructor">e</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>という形の定義に戻らなければならない状況にならずに済みます。

<div class="paragraph"> </div>

    このためには、最初に記法を「予約」し、それから定義と、記法が何を意味するかの宣言とを一緒に行います。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;e '\\' n" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 90, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AExp.aevalR"><span class="id" title="inductive">aevalR</span></a> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="AExp.E_ANum"><span class="id" title="constructor">E_ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.E_APlus"><span class="id" title="constructor">E_APlus</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.E_AMinus"><span class="id" title="constructor">E_AMinus</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.AMinus"><span class="id" title="constructor">AMinus</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="AExp.E_AMult"><span class="id" title="constructor">E_AMult</span></a> (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span> : <a class="idref" href="Imp.html#AExp.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#AExp.AMult"><span class="id" title="constructor">AMult</span></a> <a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a> <a class="idref" href="Imp.html#e2"><span class="id" title="variable">e2</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">)</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a name="37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">&quot;</span></a>e '\\' n" := (<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <span class="id" title="var">e</span> <span class="id" title="var">n</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab337"></a><h2 class="section">Inference Rule Notation</h2>

<div class="paragraph"> </div>

 In informal discussions, it is convenient to write the rules
    for <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span> and similar relations in the more readable graphical
    form of <i>inference rules</i>, where the premises above the line
    justify the conclusion below the line (we have already seen them
    in the <span class="inlinecode"><span class="id" title="library">IndProp</span></span> chapter). 
<div class="paragraph"> </div>

 For example, the constructor <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.E_APlus"><span class="id" title="constructor">E_APlus</span></a></span>...

<div class="paragraph"> </div>

      | E_APlus : forall (e1 e2: aexp) (n1 n2: nat),
          aevalR e1 n1 -&gt;
          aevalR e2 n2 -&gt;
          aevalR (APlus e1 e2) (n1 + n2)

<div class="paragraph"> </div>

    ...would be written like this as an inference rule:

<div class="paragraph"> </div>

                               e1 \\ n1
                               e2 \\ n2
<hr/>
                (E_APlus)
                         APlus e1 e2 \\ n1+n2

<div class="paragraph"> </div>

 Formally, there is nothing deep about inference rules: they
    are just implications.  You can read the rule name on the right as
    the name of the constructor and read each of the linebreaks
    between the premises above the line (as well as the line itself)
    as <span class="inlinecode">-&gt;</span>.  All the variables mentioned in the rule (<span class="inlinecode"><a class="idref" href="Imp.html#e1"><span class="id" title="variable">e1</span></a></span>, <span class="inlinecode"><a class="idref" href="Logic.html#n1"><span class="id" title="variable">n1</span></a></span>,
    etc.) are implicitly bound by universal quantifiers at the
    beginning. (Such variables are often called <i>metavariables</i> to
    distinguish them from the variables of the language we are
    defining.  At the moment, our arithmetic expressions don't include
    variables, but we'll soon be adding them.)  The whole collection
    of rules is understood as being wrapped in an <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>
    declaration.  In informal prose, this is either elided or else
    indicated by saying something like "Let <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span> be the smallest
    relation closed under the following rules...". 
<div class="paragraph"> </div>

 For example, <span class="inlinecode">\\</span> is the smallest relation closed under these
    rules:
<hr/>
                               (E_ANum)
                             ANum n \\ n

<div class="paragraph"> </div>

                               e1 \\ n1
                               e2 \\ n2
<hr/>
                         (E_APlus)
                         APlus e1 e2 \\ n1+n2

<div class="paragraph"> </div>

                               e1 \\ n1
                               e2 \\ n2
<hr/>
                        (E_AMinus)
                        AMinus e1 e2 \\ n1-n2

<div class="paragraph"> </div>

                               e1 \\ n1
                               e2 \\ n2
<hr/>
                         (E_AMult)
                         AMult e1 e2 \\ n1*n2

<div class="paragraph"> </div>

<a name="lab338"></a><h4 class="section">Exercise: 1 star, standard, optional (beval_rules)</h4>


<div class="paragraph"> </div>

    Here, again, is the Coq definition of the <span class="inlinecode"><a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a></span> function:

<div class="paragraph"> </div>

  Fixpoint beval (e : bexp) : bool :=
    match e with
    | BTrue       =&gt; true
    | BFalse      =&gt; false
    | BEq a1 a2   =&gt; (aeval a1) =? (aeval a2)
    | BLe a1 a2   =&gt; (aeval a1) &lt;=? (aeval a2)
    | BNot b1     =&gt; negb (beval b1)
    | BAnd b1 b2  =&gt; andb (beval b1) (beval b2)
    end.

<div class="paragraph"> </div>

    Write out a corresponding definition of boolean evaluation as a
    relation (in inference rule notation). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="AExp.manual_grade_for_beval_rules"><span class="id" title="definition">manual_grade_for_beval_rules</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab339"></a><h2 class="section">Equivalence of the Definitions</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
評価の、関係による定義と関数による定義が一致することを証明するのは簡単です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.aeval_iff_aevalR"><span class="id" title="lemma">aeval_iff_aevalR</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHaevalR1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHaevalR2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHaevalR1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHaevalR2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHaevalR1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHaevalR2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#AExp.E_ANum"><span class="id" title="constructor">E_ANum</span></a>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#AExp.E_APlus"><span class="id" title="constructor">E_APlus</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#AExp.E_AMinus"><span class="id" title="constructor">E_AMinus</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;+ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#AExp.E_AMult"><span class="id" title="constructor">E_AMult</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
さらにタクティカルを使うことで証明をより短くできます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="AExp.aeval_iff_aevalR'"><span class="id" title="lemma">aeval_iff_aevalR'</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="Imp.html#37a644f1a2cdc5d98a964be4ae191daa"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Imp.html#AExp.aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa1</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab340"></a><h4 class="section">練習問題: ★★★, standard (bevalR)</h4>


<div class="paragraph"> </div>

    関係<span class="inlinecode"><a class="idref" href="Imp.html#AExp.bevalR"><span class="id" title="inductive">bevalR</span></a></span>を<span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span>と同じスタイルで記述し、それが<span class="inlinecode"><a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a></span>と同値であることを証明しなさい。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="AExp.bevalR"><span class="id" title="inductive">bevalR</span></a>: <a class="idref" href="Imp.html#AExp.bexp"><span class="id" title="inductive">bexp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<br/>
.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a name="AExp.beval_iff_bevalR"><span class="id" title="lemma">beval_iff_bevalR</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">bv</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#AExp.bevalR"><span class="id" title="inductive">bevalR</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#bv"><span class="id" title="variable">bv</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Imp.html#AExp.beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#bv"><span class="id" title="variable">bv</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Imp.html#AExp"><span class="id" title="module">AExp</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab341"></a><h2 class="section">Computational vs. Relational Definitions</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
算術式とブール式の評価の定義について、関数を使うか関係を使うかはほとんど趣味の問題です。
    どちらでも問題ありません。

<div class="paragraph"> </div>

    しかしながら、評価の定義として、関係による定義が関数による定義よりはるかに望ましい状況があります。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="aevalR_division"><span class="id" title="module">aevalR_division</span></a>.<br/>

<br/>
</div>

<div class="doc">
For example, suppose that we wanted to extend the arithmetic
    operations with division: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="aevalR_division.aexp"><span class="id" title="inductive">aexp</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="aevalR_division.ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_division.APlus"><span class="id" title="constructor">APlus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_division.AMinus"><span class="id" title="constructor">AMinus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_division.AMult"><span class="id" title="constructor">AMult</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_division.ADiv"><span class="id" title="constructor">ADiv</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>). 
<br/>
</div>

<div class="doc">
Extending the definition of <span class="inlinecode"><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a></span> to handle this new operation
    would not be straightforward (what should we return as the result
    of <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_division.ADiv"><span class="id" title="constructor">ADiv</span></a></span> <span class="inlinecode">(<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a></span> <span class="inlinecode">5)</span> <span class="inlinecode">(<a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a></span> <span class="inlinecode">0)</span>?).  But extending <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span> is
    straightforward. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;e '\\' n"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 90, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="aevalR_division.aevalR"><span class="id" title="inductive">aevalR</span></a> : <a class="idref" href="Imp.html#aevalR_division.aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="aevalR_division.E_ANum"><span class="id" title="constructor">E_ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_division.ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_division.E_APlus"><span class="id" title="constructor">E_APlus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_division.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_division.APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_division.E_AMinus"><span class="id" title="constructor">E_AMinus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_division.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_division.AMinus"><span class="id" title="constructor">AMinus</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_division.E_AMult"><span class="id" title="constructor">E_AMult</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_division.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_division.AMult"><span class="id" title="constructor">AMult</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_division.E_ADiv"><span class="id" title="constructor">E_ADiv</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_division.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> <span class="id" title="var">n3</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#19ab5cfd7e4f60fa14f22b576013bd96"><span class="id" title="notation">&gt;</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#mult"><span class="id" title="abbreviation">mult</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a> <a class="idref" href="Imp.html#n3"><span class="id" title="variable">n3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_division.ADiv"><span class="id" title="constructor">ADiv</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n3"><span class="id" title="variable">n3</span></a><br/>
<br/>
<span class="id" title="keyword">where</span> <a name="d1f82f4b804de7d86f48130585ed02c9"><span class="id" title="notation">&quot;</span></a>a '\\' n" := (<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <span class="id" title="var">a</span> <span class="id" title="var">n</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Imp.html#aevalR_division"><span class="id" title="module">aevalR_division</span></a>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <a name="aevalR_extended"><span class="id" title="module">aevalR_extended</span></a>.<br/>

<br/>
</div>

<div class="doc">
Or suppose that we want to extend the arithmetic operations by a
    nondeterministic number generator <span class="inlinecode"><span class="id" title="var">any</span></span> that, when evaluated, may
    yield any number.  (Note that this is not the same as making a
    <i>probabilistic</i> choice among all possible numbers -- we're not
    specifying any particular probability distribution for the
    results, just saying what results are <i>possible</i>.) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;e '\\' n" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 90, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="aevalR_extended.aexp"><span class="id" title="inductive">aexp</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="aevalR_extended.AAny"><span class="id" title="constructor">AAny</span></a>                           <br/>
&nbsp;&nbsp;| <a name="aevalR_extended.ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_extended.APlus"><span class="id" title="constructor">APlus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_extended.AMinus"><span class="id" title="constructor">AMinus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="aevalR_extended.AMult"><span class="id" title="constructor">AMult</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>).<br/>

<br/>
</div>

<div class="doc">
Again, extending <span class="inlinecode"><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a></span> would be tricky, since now evaluation is
    <i>not</i> a deterministic function from expressions to numbers, but
    extending <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span> is no problem... 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a> : <a class="idref" href="Imp.html#aevalR_extended.aexp"><span class="id" title="inductive">aexp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="aevalR_extended.E_Any"><span class="id" title="constructor">E_Any</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aevalR_extended.AAny"><span class="id" title="constructor">AAny</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a>                        <br/>
&nbsp;&nbsp;| <a name="aevalR_extended.E_ANum"><span class="id" title="constructor">E_ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_extended.ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_extended.E_APlus"><span class="id" title="constructor">E_APlus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_extended.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_extended.APlus"><span class="id" title="constructor">APlus</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_extended.E_AMinus"><span class="id" title="constructor">E_AMinus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_extended.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_extended.AMinus"><span class="id" title="constructor">AMinus</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="aevalR_extended.E_AMult"><span class="id" title="constructor">E_AMult</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aevalR_extended.aexp"><span class="id" title="inductive">aexp</span></a>) (<span class="id" title="var">n1</span> <span class="id" title="var">n2</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aevalR_extended.AMult"><span class="id" title="constructor">AMult</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#a2"><span class="id" title="variable">a2</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">\\</span></a> <a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#n1"><span class="id" title="variable">n1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#n2"><span class="id" title="variable">n2</span></a><a class="idref" href="Imp.html#926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">)</span></a><br/>
<br/>
<span class="id" title="keyword">where</span> <a name="926a82e7f18ede53916aadf1888cdcd9"><span class="id" title="notation">&quot;</span></a>a '\\' n" := (<a class="idref" href="Imp.html#aevalR"><span class="id" title="inductive">aevalR</span></a> <span class="id" title="var">a</span> <span class="id" title="var">n</span>) : <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Imp.html#aevalR_extended"><span class="id" title="module">aevalR_extended</span></a>.<br/>

<br/>
</div>

<div class="doc">
At this point you maybe wondering: which style should I use by
    default?  In the examples we've just seen, relational definitions
    turned out to be more useful than functional ones.  For situations
    like these, where the thing being defined is not easy to express
    as a function, or indeed where it is <i>not</i> a function, there is no
    real choice.  But what about when both styles are workable?

<div class="paragraph"> </div>

    One point in favor of relational definitions is that they can be
    more elegant and easier to understand.

<div class="paragraph"> </div>

    Another is that Coq automatically generates nice inversion and
    induction principles from <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> definitions. 
<div class="paragraph"> </div>

 On the other hand, functional definitions can often be more
    convenient:
<ul class="doclist">
<li> Functions are by definition deterministic and defined on all
       arguments; for a relation we have to show these properties
       explicitly if we need them.

</li>
<li> With functions we can also take advantage of Coq's computation
       mechanism to simplify expressions during proofs.

</li>
</ul>

<div class="paragraph"> </div>

    Furthermore, functions can be directly "extracted" from Gallina to
    executable code in OCaml or Haskell. 
<div class="paragraph"> </div>

 Ultimately, the choice often comes down to either the specifics of
    a particular situation or simply a question of taste.  Indeed, in
    large Coq developments it is common to see a definition given in
    <i>both</i> functional and relational styles, plus a lemma stating that
    the two coincide, allowing further proofs to switch from one point
    of view to the other at will. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab342"></a><h1 class="section">変数を持つ式</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Impの定義に戻りましょう。
    次にしなければならないことは、算術式とブール式に変数を拡張することです。
    話を単純にするため、すべての変数はグローバルで、数値だけを持つとしましょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab343"></a><h2 class="section">状態</h2>

<div class="paragraph"> </div>

 Since we'll want to look variables up to find out their current
    values, we'll reuse maps from the <span class="inlinecode"><span class="id" title="library">Maps</span></span> chapter, and 
    <span class="inlinecode"><a class="idref" href="IndProp.html#string"><span class="id" title="definition">string</span></a></span>s will be used to represent variables in Imp.

<div class="paragraph"> </div>

    A <i>machine state</i> (or just <i>state</i>) represents the current values
    of <i>all</i> variables at some point in the execution of a program. 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
簡単にするため、どのようなプログラムも有限個の変数しか使いませんが、状態はすべての変数について定義されているものとします。
    状態はメモリ中に格納されている全ての情報を持ちます。
    Imp で書かれたプログラムでは全ての変数が自然数だけを格納することから、状態を文字列から <span class="inlinecode"><a class="idref" href="Basics.html#NatPlayground.nat"><span class="id" title="inductive">nat</span></a></span> への写像で表現できます。
    このとき状態の初期値は<span class="inlinecode">0</span>ということにしておきます。
    複雑なプログラミング言語では、状態はより複雑な構造となるでしょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="state"><span class="id" title="definition">state</span></a> := <a class="idref" href="Maps.html#total_map"><span class="id" title="definition">total_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab344"></a><h2 class="section">構文</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
前に定義した算術式に、単にもう1つコンストラクタを追加することで変数を追加できます: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="aexp"><span class="id" title="inductive">aexp</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="ANum"><span class="id" title="constructor">ANum</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;| <a name="AId"><span class="id" title="constructor">AId</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>)              <br/>
&nbsp;&nbsp;| <a name="APlus"><span class="id" title="constructor">APlus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AMinus"><span class="id" title="constructor">AMinus</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="AMult"><span class="id" title="constructor">AMult</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>).<br/>

<br/>
</div>

<div class="doc">
Defining a few variable names as notational shorthands will make
    examples easier to read: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="W"><span class="id" title="definition">W</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "W".<br/>
<span class="id" title="keyword">Definition</span> <a name="X"><span class="id" title="definition">X</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "X".<br/>
<span class="id" title="keyword">Definition</span> <a name="Y"><span class="id" title="definition">Y</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "Y".<br/>
<span class="id" title="keyword">Definition</span> <a name="Z"><span class="id" title="definition">Z</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "Z".<br/>

<br/>
</div>

<div class="doc">
（プログラム変数のこの慣習（<span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>, <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>, <span class="inlinecode"><a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a></span>）は、大文字は型を表すのに使うという使用法と衝突します。
    Impを構成していく章では多相性を多用はしないので、このことが混乱を招くことはないはずです。） 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a></span>の定義は（新しい<span class="inlinecode"><a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a></span>を使うこと以外）変わっていません: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="bexp"><span class="id" title="inductive">bexp</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="BTrue"><span class="id" title="constructor">BTrue</span></a><br/>
&nbsp;&nbsp;| <a name="BFalse"><span class="id" title="constructor">BFalse</span></a><br/>
&nbsp;&nbsp;| <a name="BEq"><span class="id" title="constructor">BEq</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="BLe"><span class="id" title="constructor">BLe</span></a> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="BNot"><span class="id" title="constructor">BNot</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="BAnd"><span class="id" title="constructor">BAnd</span></a> (<span class="id" title="var">b1</span> <span class="id" title="var">b2</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab345"></a><h2 class="section">Notations</h2>

<div class="paragraph"> </div>

 To make Imp programs easier to read and write, we introduce some
    notations and implicit coercions.

<div class="paragraph"> </div>

    You do not need to understand exactly what these declarations do.
    Briefly, though, the <span class="inlinecode"><span class="id" title="keyword">Coercion</span></span> declaration in Coq stipulates that
    a function (or constructor) can be implicitly used by the type
    system to coerce a value of the input type to a value of the
    output type.  For instance, the coercion declaration for <span class="inlinecode"><a class="idref" href="Imp.html#AId"><span class="id" title="constructor">AId</span></a></span>
    allows us to use plain strings when an <span class="inlinecode"><a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a></span> is expected; the
    string will implicitly be wrapped with <span class="inlinecode"><a class="idref" href="Imp.html#AId"><span class="id" title="constructor">AId</span></a></span>. 
<div class="paragraph"> </div>

 The notations below are declared in specific <i>notation scopes</i>, in
    order to avoid conflicts with other interpretations of the same
    symbols.  Again, it is not necessary to understand the details,
    but it is important to recognize that we are defining <i>new</i>
    intepretations for some familiar operators like <span class="inlinecode">+</span>, <span class="inlinecode">-</span>, <span class="inlinecode">*</span>,
    <span class="inlinecode">=.,</span> <span class="inlinecode">[&lt;=],</span> <span class="inlinecode"><span class="id" title="var">etc</span>.</span> <span class="inlinecode"></span>
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="Imp.html#AId"><span class="id" title="constructor">AId</span></a> <a class="idref" href="Imp.html#AId"><span class="id" title="constructor">:</span></a> <a class="idref" href="Imp.html#AId"><span class="id" title="constructor">string</span></a> <a class="idref" href="Imp.html#AId"><span class="id" title="constructor">&gt;-&gt;</span></a> <a class="idref" href="Imp.html#AId"><span class="id" title="constructor">aexp</span></a>.<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">:</span></a> <a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">nat</span></a> <a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">&gt;-&gt;</span></a> <a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">aexp</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="bool_to_bexp"><span class="id" title="definition">bool_to_bexp</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Imp.html#BTrue"><span class="id" title="constructor">BTrue</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Imp.html#BFalse"><span class="id" title="constructor">BFalse</span></a>.<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="Imp.html#bool_to_bexp"><span class="id" title="definition">bool_to_bexp</span></a> <a class="idref" href="Imp.html#bool_to_bexp"><span class="id" title="definition">:</span></a> <a class="idref" href="Imp.html#bool_to_bexp"><span class="id" title="definition">bool</span></a> <a class="idref" href="Imp.html#bool_to_bexp"><span class="id" title="definition">&gt;-&gt;</span></a> <a class="idref" href="Imp.html#bool_to_bexp"><span class="id" title="definition">bexp</span></a>.<br/>

<br/>
<span class="id" title="keyword">Bind</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">aexp</span>.<br/>
<span class="id" title="keyword">Bind</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">bexp</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">imp</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">&quot;</span></a>x + y" := (<a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">&quot;</span></a>x - y" := (<a class="idref" href="Imp.html#AMinus"><span class="id" title="constructor">AMinus</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="ecd9390a06cb87a38cb0a2350ca063ec"><span class="id" title="notation">&quot;</span></a>x * y" := (<a class="idref" href="Imp.html#AMult"><span class="id" title="constructor">AMult</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="97f8f39c17bfb48ea37b674eccb827ca"><span class="id" title="notation">&quot;</span></a>x &lt;= y" := (<a class="idref" href="Imp.html#BLe"><span class="id" title="constructor">BLe</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="102d8c3ecbd7653efa317bf9b975bd1a"><span class="id" title="notation">&quot;</span></a>x = y" := (<a class="idref" href="Imp.html#BEq"><span class="id" title="constructor">BEq</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="4e566555556823b18f25685336f5099e"><span class="id" title="notation">&quot;</span></a>x &amp;&amp; y" := (<a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">&quot;</span></a>'~' b" := (<a class="idref" href="Imp.html#BNot"><span class="id" title="constructor">BNot</span></a> <span class="id" title="var">b</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 75, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="example_aexp"><span class="id" title="definition">example_aexp</span></a> := (3 <a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ecd9390a06cb87a38cb0a2350ca063ec"><span class="id" title="notation">*</span></a> 2<a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">imp</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="example_bexp"><span class="id" title="definition">example_bexp</span></a> := (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Imp.html#4e566555556823b18f25685336f5099e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">~(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#97f8f39c17bfb48ea37b674eccb827ca"><span class="id" title="notation">&lt;=</span></a> 4<a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">imp</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>.<br/>

<br/>
</div>

<div class="doc">
One downside of these coercions is that they can make it a little
    harder for humans to calculate the types of expressions.  If you
    get confused, try doing <span class="inlinecode"><span class="id" title="keyword">Set</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="var">Coercions</span></span> to see exactly
    what is going on. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set Printing Coercions</span>.<br/>

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="Imp.html#example_bexp"><span class="id" title="definition">example_bexp</span></a>.<br/>

<br/>
<span class="id" title="keyword">Unset Printing Coercions</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab346"></a><h2 class="section">評価</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
算術とブールの評価器は、状態を引数に追加するという自明な方法で変数を扱うように拡張できます: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="aeval"><span class="id" title="definition">aeval</span></a> (<span class="id" title="var">st</span> : <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a>) (<span class="id" title="var">a</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#a"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#ANum"><span class="id" title="constructor">ANum</span></a> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AId"><span class="id" title="constructor">AId</span></a> <span class="id" title="var">x</span> =&gt; <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">x</span>                                <br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#APlus"><span class="id" title="constructor">APlus</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AMinus"><span class="id" title="constructor">AMinus</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>  =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#AMult"><span class="id" title="constructor">AMult</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">*</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="beval"><span class="id" title="definition">beval</span></a> (<span class="id" title="var">st</span> : <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a>) (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#BTrue"><span class="id" title="constructor">BTrue</span></a>       =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#BFalse"><span class="id" title="constructor">BFalse</span></a>      =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#BEq"><span class="id" title="constructor">BEq</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>   =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#BLe"><span class="id" title="constructor">BLe</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>   =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Nat.html#01f84f7b4db7ca25b5fbdf8f04a7bebc"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#BNot"><span class="id" title="constructor">BNot</span></a> <span class="id" title="var">b1</span>     =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">b1</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>  =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">b1</span>) (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
We specialize our notation for total maps to the specific case of
    states, i.e. using <span class="inlinecode">(<span class="id" title="var">_</span></span> <span class="inlinecode">!-&gt;</span> <span class="inlinecode">0)</span> as empty state. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="empty_st"><span class="id" title="definition">empty_st</span></a> := (<a class="idref" href="Maps.html#bc1c5e34127128228512ba20d13f5577"><span class="id" title="notation">_</span></a> <a class="idref" href="Maps.html#bc1c5e34127128228512ba20d13f5577"><span class="id" title="notation">!-&gt;</span></a> 0).<br/>

<br/>
</div>

<div class="doc">
Now we can add a notation for a "singleton state" with just one
    variable bound to a value. 
</div>
<div class="code">
<span class="id" title="keyword">Notation</span> <a name="ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">&quot;</span></a>a '!-&gt;' x" := (<a class="idref" href="Maps.html#t_update"><span class="id" title="definition">t_update</span></a> <a class="idref" href="Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <span class="id" title="var">a</span> <span class="id" title="var">x</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 100).<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="aexp1"><span class="id" title="definition">aexp1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> (<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 5) (3 <a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">+</span></a> <a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ecd9390a06cb87a38cb0a2350ca063ec"><span class="id" title="notation">*</span></a> 2<a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">imp</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 13.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="bexp1"><span class="id" title="definition">bexp1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> (<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 5) (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Imp.html#4e566555556823b18f25685336f5099e"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">~(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#97f8f39c17bfb48ea37b674eccb827ca"><span class="id" title="notation">&lt;=</span></a> 4<a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">imp</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab347"></a><h1 class="section">コマンド</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
さて、Imp コマンド（「文(statement)」と呼ばれることもあります）の構文と挙動を定義する準備が出来ました。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab348"></a><h2 class="section">構文</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
非形式的には、コマンド <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> は以下の BNF で表現されます。
<pre>
     c ::= SKIP | x ::= a | c ;; c | TEST b THEN c ELSE c FI 
         | WHILE b DO c END 
</pre>
    （すこし不格好な具象構文を使っていますが、これはImpの構文をCoqのNotationの機能を使って記述するためです。
    特に、<span class="inlinecode"><span class="id" title="var">TEST</span></span>は標準ライブラリの<span class="inlinecode"><span class="id" title="keyword">if</span></span>や<span class="inlinecode"><span class="id" title="var">IF</span></span>との衝突を避けてのものです。）
    例えば、Imp における階乗の計算は以下のようになります。
<pre>
     Z ::= X;; 
     Y ::= 1;; 
     WHILE ~(Z = 0) DO 
       Y ::= Y * Z;; 
       Z ::= Z - 1 
     END 
</pre>
   このコマンドが終わったとき、変数 <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span> は変数 <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> の初期値の階乗を持つでしょう。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
以下に、コマンドの抽象構文の形式的定義を示します。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="com"><span class="id" title="inductive">com</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="CSkip"><span class="id" title="constructor">CSkip</span></a><br/>
&nbsp;&nbsp;| <a name="CAss"><span class="id" title="constructor">CAss</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<span class="id" title="var">a</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="CSeq"><span class="id" title="constructor">CSeq</span></a> (<span class="id" title="var">c1</span> <span class="id" title="var">c2</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>)<br/>
&nbsp;&nbsp;| <a name="CIf"><span class="id" title="constructor">CIf</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) (<span class="id" title="var">c1</span> <span class="id" title="var">c2</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>)<br/>
&nbsp;&nbsp;| <a name="CWhile"><span class="id" title="constructor">CWhile</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) (<span class="id" title="var">c</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>).<br/>

<br/>
</div>

<div class="doc">
式と同様、Impプログラムを読み書きしやすくするために、いくつかの <span class="inlinecode"><span class="id" title="keyword">Notation</span></span> 宣言が使えます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Bind</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">com</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="9838f34589a76e1d4e404cd35557c73e"><span class="id" title="notation">&quot;</span></a>'SKIP'" :=<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#CSkip"><span class="id" title="constructor">CSkip</span></a> : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">&quot;</span></a>x '::=' a" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#CAss"><span class="id" title="constructor">CAss</span></a> <span class="id" title="var">x</span> <span class="id" title="var">a</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">&quot;</span></a>c1 ;; c2" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#CSeq"><span class="id" title="constructor">CSeq</span></a> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="83a07334581e0deb166d05032f77769f"><span class="id" title="notation">&quot;</span></a>'WHILE' b 'DO' c 'END'" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#CWhile"><span class="id" title="constructor">CWhile</span></a> <span class="id" title="var">b</span> <span class="id" title="var">c</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">&quot;</span></a>'TEST' c1 'THEN' c2 'ELSE' c3 'FI'" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#CIf"><span class="id" title="constructor">CIf</span></a> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">c3</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">imp_scope</span>.<br/>

<br/>
</div>

<div class="doc">
例えば先の階乗関数を Coq での形式的な定義として記述し直すと、以下のようになります。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="fact_in_coq"><span class="id" title="definition">fact_in_coq</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 1<a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">~(</span></a><a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#102d8c3ecbd7653efa317bf9b975bd1a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#ecd9390a06cb87a38cb0a2350ca063ec"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a><a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">-</span></a> 1<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a>)%<span class="id" title="var">imp</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab349"></a><h2 class="section">Desugaring notations</h2>

<div class="paragraph"> </div>

 Coq offers a rich set of features to manage the increasing
    complexity of the objects we work with, such as coercions
    and notations. However, their heavy usage can make for quite
    overwhelming syntax. It is often instructive to "turn off"
    those features to get a more elementary picture of things,
    using the following commands:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="keyword">Unset</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="var">Notations</span></span> (undo with <span class="inlinecode"><span class="id" title="keyword">Set</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="var">Notations</span></span>)

</li>
<li> <span class="inlinecode"><span class="id" title="keyword">Set</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="var">Coercions</span></span> (undo with <span class="inlinecode"><span class="id" title="keyword">Unset</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="var">Coercions</span></span>)

</li>
<li> <span class="inlinecode"><span class="id" title="keyword">Set</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="keyword">All</span></span> (undo with <span class="inlinecode"><span class="id" title="keyword">Unset</span></span> <span class="inlinecode"><span class="id" title="keyword">Printing</span></span> <span class="inlinecode"><span class="id" title="keyword">All</span></span>)

</li>
</ul>

<div class="paragraph"> </div>

    These commands can also be used in the middle of a proof,
    to elaborate the current goal and context.
 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Unset</span> <span class="id" title="keyword">Printing</span> <span class="id" title="var">Notations</span>.<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="Imp.html#fact_in_coq"><span class="id" title="definition">fact_in_coq</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="keyword">Printing</span> <span class="id" title="var">Notations</span>.<br/>

<br/>
<span class="id" title="keyword">Set Printing Coercions</span>.<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="Imp.html#fact_in_coq"><span class="id" title="definition">fact_in_coq</span></a>.<br/>
<span class="id" title="keyword">Unset Printing Coercions</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab350"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="keyword">Locate</span></span> command</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab351"></a><h3 class="section">Finding notations</h3>

<div class="paragraph"> </div>

 When faced with unknown notation, use <span class="inlinecode"><span class="id" title="keyword">Locate</span></span> with a <i>string</i>
    containing one of its symbols to see its possible
    interpretations. 
</div>
<div class="code">
<span class="id" title="keyword">Locate</span> "&amp;&amp;".<br/>

<br/>
<span class="id" title="keyword">Locate</span> ";;".<br/>

<br/>
<span class="id" title="keyword">Locate</span> "WHILE".<br/>

<br/>
</div>

<div class="doc">
<a name="lab352"></a><h3 class="section">Finding identifiers</h3>

<div class="paragraph"> </div>

 When used with an identifier, the command <span class="inlinecode"><span class="id" title="keyword">Locate</span></span> prints
    the full path to every value in scope with the same name.
    This is useful to troubleshoot problems due to variable
    shadowing. 
</div>
<div class="code">
<span class="id" title="keyword">Locate</span> <span class="id" title="var">aexp</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab353"></a><h2 class="section">他の例</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
代入: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="plus2"><span class="id" title="definition">plus2</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#040a5752226a8185c7d6fc9125b7a4ea"><span class="id" title="notation">+</span></a> 2.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="XtimesYinZ"><span class="id" title="definition">XtimesYinZ</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ecd9390a06cb87a38cb0a2350ca063ec"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="subtract_slowly_body"><span class="id" title="definition">subtract_slowly_body</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">-</span></a> 1 <a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">-</span></a> 1.<br/>

<br/>
</div>

<div class="doc">
<a name="lab354"></a><h3 class="section">ループ</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="subtract_slowly"><span class="id" title="definition">subtract_slowly</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">~(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#102d8c3ecbd7653efa317bf9b975bd1a"><span class="id" title="notation">=</span></a> 0<a class="idref" href="Imp.html#e5a2f8c4cfacb82c023ce3487633feff"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#subtract_slowly_body"><span class="id" title="definition">subtract_slowly_body</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a>)%<span class="id" title="var">imp</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="subtract_3_from_5_slowly"><span class="id" title="definition">subtract_3_from_5_slowly</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 3 <a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 5 <a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#subtract_slowly"><span class="id" title="definition">subtract_slowly</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab355"></a><h3 class="section">無限ループ:</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="loop"><span class="id" title="definition">loop</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#9838f34589a76e1d4e404cd35557c73e"><span class="id" title="notation">SKIP</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab356"></a><h1 class="section">コマンドの評価</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
次に、Imp のコマンドの実行が何を意味するかを定義する必要があります。
    <span class="inlinecode"><span class="id" title="var">WHILE</span></span> ループが終了しなくても良くするため、評価関数の定義を少し変わった形にしています ... 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab357"></a><h2 class="section">関数としての評価（失敗版）</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
以下は <span class="inlinecode"><span class="id" title="var">WHILE</span></span> 以外のコマンドの評価関数を定義しようとした、最初の試みです。 
<div class="paragraph"> </div>

 The following declaration is needed to be able to use the
    notations in match patterns. 
</div>
<div class="code">
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="ceval_fun_no_while"><span class="id" title="definition">ceval_fun_no_while</span></a> (<span class="id" title="var">st</span> : <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a>) (<span class="id" title="var">c</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Imp.html#9838f34589a76e1d4e404cd35557c73e"><span class="id" title="notation">SKIP</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">x</span> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <span class="id" title="var">a1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">a1</span><a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">)</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">c1</span> <a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a> <span class="id" title="var">c2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">st'</span> := <a class="idref" href="Imp.html#ceval_fun_no_while"><span class="id" title="definition">ceval_fun_no_while</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">c1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#ceval_fun_no_while"><span class="id" title="definition">ceval_fun_no_while</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <span class="id" title="var">c2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">TEST</span></a> <span class="id" title="var">b</span> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">THEN</span></a> <span class="id" title="var">c1</span> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">ELSE</span></a> <span class="id" title="var">c2</span> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">FI</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">then</span> <a class="idref" href="Imp.html#ceval_fun_no_while"><span class="id" title="definition">ceval_fun_no_while</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">c1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Imp.html#ceval_fun_no_while"><span class="id" title="definition">ceval_fun_no_while</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <span class="id" title="var">c2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <span class="id" title="var">b</span> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a> <span class="id" title="var">c</span> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a>  <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span>.<br/>

<br/>
</div>

<div class="doc">
In a traditional functional programming language like OCaml or
    Haskell we could add the <span class="inlinecode"><span class="id" title="var">WHILE</span></span> case as follows:

<div class="paragraph"> </div>

        Fixpoint ceval_fun (st : state) (c : com) : state :=
          match c with
            ...
            | WHILE b DO c END =&gt;
                if (beval st b)
                  then ceval_fun st (c ;; WHILE b DO c END)
                  else st
          end.

<div class="paragraph"> </div>

    Coq doesn't accept such a definition ("Error: Cannot guess
    decreasing argument of fix") because the function we want to
    define is not guaranteed to terminate. Indeed, it <i>doesn't</i> always
    terminate: for example, the full version of the <span class="inlinecode"><span class="id" title="var">ceval_fun</span></span>
    function applied to the <span class="inlinecode"><a class="idref" href="Imp.html#loop"><span class="id" title="definition">loop</span></a></span> program above would never
    terminate. Since Coq is not just a functional programming
    language but also a consistent logic, any potentially
    non-terminating function needs to be rejected. Here is
    an (invalid!) program showing what would go wrong if Coq
    allowed non-terminating recursive functions:

<div class="paragraph"> </div>

         Fixpoint loop_false (n : nat) : False := loop_false n.

<div class="paragraph"> </div>

    That is, propositions like <span class="inlinecode"><a class="idref" href="ProofObjects.html#Props.False"><span class="id" title="inductive">False</span></a></span> would become provable
    (<span class="inlinecode"><span class="id" title="var">loop_false</span></span> <span class="inlinecode">0</span> would be a proof of <span class="inlinecode"><a class="idref" href="ProofObjects.html#Props.False"><span class="id" title="inductive">False</span></a></span>), which
    would be a disaster for Coq's logical consistency.

<div class="paragraph"> </div>

    Thus, because it doesn't terminate on all inputs,
    of <span class="inlinecode"><span class="id" title="var">ceval_fun</span></span> cannot be written in Coq -- at least not without
    additional tricks and workarounds (see chapter <span class="inlinecode"><span class="id" title="library">ImpCEvalFun</span></span>
    if you're curious about what those might be). 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab358"></a><h2 class="section">関係としての評価</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
改善策はこうです。
    <span class="inlinecode"><a class="idref" href="Auto.html#Repeat.ceval"><span class="id" title="inductive">ceval</span></a></span> を関数ではなく関係(<i>relation</i>) として定義します。
    つまり、上の <span class="inlinecode"><a class="idref" href="Imp.html#aevalR_extended.aevalR"><span class="id" title="inductive">aevalR</span></a></span> と <span class="inlinecode"><a class="idref" href="Imp.html#AExp.bevalR"><span class="id" title="inductive">bevalR</span></a></span> と同様に <span class="inlinecode"><span class="id" title="keyword">Type</span></span> ではなく <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> で定義するのです。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
これは重要な変更です。
    厄介な回避策から解放されるばかりでなく、定義での柔軟性も与えてくれます。
    例えば、もし言語に<span class="inlinecode"><span class="id" title="var">any</span></span>のような並行性の要素を導入したら、評価の定義を非決定的に書きたくなるでしょう。
    つまり、それは全域でないだけでなく、そもそも関数ですらないかも知れないのです！ 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">ceavl</span></span> 関係に対する表記として <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> <span class="inlinecode">=[</span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> を使います。
    <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> <span class="inlinecode">=[</span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> と書いたら、プログラム <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> を初期状態 <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> で評価すると、その結果は最終状態 <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> になる、ということを意味します。
    これは「<span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> は状態 <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> を <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> にする」と読みます。 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab359"></a><h3 class="section">操作的意味論</h3>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
評価の推論規則を読みやすく非形式的に書くと、以下のようになります。
<pre>
                           -----------------                            (E_Skip) 
                           st =[ SKIP ]=&gt; st 
 
                           aeval st a1 = n 
                   --------------------------------                     (E_Ass) 
                   st =[ x := a1 ]=&gt; (x !-&gt; n ; st) 
 
                           st  =[ c1 ]=&gt; st' 
                           st' =[ c2 ]=&gt; st'' 
                         ---------------------                            (E_Seq) 
                         st =[ c1;;c2 ]=&gt; st'' 
 
                          beval st b1 = true 
                           st =[ c1 ]=&gt; st' 
                ---------------------------------------                (E_IfTrue) 
                st =[ TEST b1 THEN c1 ELSE c2 FI ]=&gt; st' 
 
                         beval st b1 = false 
                           st =[ c2 ]=&gt; st' 
                ---------------------------------------               (E_IfFalse) 
                st =[ TEST b1 THEN c1 ELSE c2 FI ]=&gt; st' 
 
                         beval st b = false 
                    -----------------------------                  (E_WhileFalse) 
                    st =[ WHILE b DO c END ]=&gt; st 
 
                          beval st b = true 
                           st =[ c ]=&gt; st' 
                  st' =[ WHILE b DO c END ]=&gt; st'' 
                  --------------------------------                  (E_WhileTrue) 
                  st  =[ WHILE b DO c END ]=&gt; st'' 
</pre>
 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
以下に形式的な定義を挙げます。
    上の推論規則とどのように対応するか、確認しておきましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;st '=[' c ']=&gt;' st'"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="ceval"><span class="id" title="inductive">ceval</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="E_Skip"><span class="id" title="constructor">E_Skip</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#9838f34589a76e1d4e404cd35557c73e"><span class="id" title="notation">SKIP</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a><br/>
&nbsp;&nbsp;| <a name="E_Ass"><span class="id" title="constructor">E_Ass</span></a>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <a class="idref" href="Imp.html#a1"><span class="id" title="variable">a1</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a><a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a name="E_Seq"><span class="id" title="constructor">E_Seq</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">st''</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a>  <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c1"><span class="id" title="variable">c1</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c2"><span class="id" title="variable">c2</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st''"><span class="id" title="variable">st''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a>  <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c1"><span class="id" title="variable">c1</span></a> <a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a> <a class="idref" href="Imp.html#c2"><span class="id" title="variable">c2</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st''"><span class="id" title="variable">st''</span></a><br/>
&nbsp;&nbsp;| <a name="E_IfTrue"><span class="id" title="constructor">E_IfTrue</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c1"><span class="id" title="variable">c1</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">TEST</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">THEN</span></a> <a class="idref" href="Imp.html#c1"><span class="id" title="variable">c1</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">ELSE</span></a> <a class="idref" href="Imp.html#c2"><span class="id" title="variable">c2</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">FI</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a><br/>
&nbsp;&nbsp;| <a name="E_IfFalse"><span class="id" title="constructor">E_IfFalse</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c2"><span class="id" title="variable">c2</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">TEST</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">THEN</span></a> <a class="idref" href="Imp.html#c1"><span class="id" title="variable">c1</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">ELSE</span></a> <a class="idref" href="Imp.html#c2"><span class="id" title="variable">c2</span></a> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">FI</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a><br/>
&nbsp;&nbsp;| <a name="E_WhileFalse"><span class="id" title="constructor">E_WhileFalse</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">st</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a><br/>
&nbsp;&nbsp;| <a name="E_WhileTrue"><span class="id" title="constructor">E_WhileTrue</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">st''</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a>  <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st''"><span class="id" title="variable">st''</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a>  <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st''"><span class="id" title="variable">st''</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a name="d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">&quot;</span></a>st =[ c ]=&gt; st'" := (<a class="idref" href="Imp.html#ceval"><span class="id" title="inductive">ceval</span></a> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>).<br/>

<br/>
</div>

<div class="doc">
評価を関数ではなく関係として定義することのコストは、あるプログラムを実行した結果がとある状態になる、というのを Coq の計算機構にやってもらう代わりに、その「証明」を構築する必要がある、ということです。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="ceval_example1"><span class="id" title="definition">ceval_example1</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 2<a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">TEST</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#97f8f39c17bfb48ea37b674eccb827ca"><span class="id" title="notation">&lt;=</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">THEN</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 3<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">ELSE</span></a> <a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">FI</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 4 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 2<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#E_Seq"><span class="id" title="constructor">E_Seq</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 2).<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#E_Ass"><span class="id" title="constructor">E_Ass</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#E_IfFalse"><span class="id" title="constructor">E_IfFalse</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Imp.html#E_Ass"><span class="id" title="constructor">E_Ass</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab360"></a><h4 class="section">練習問題: ★★, standard (ceval_example2)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Example</span> <a name="ceval_example2"><span class="id" title="definition">ceval_example2</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 0<a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 1<a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a> <a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> 2<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#Z"><span class="id" title="definition">Z</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 2 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 1 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 0<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab361"></a><h4 class="section">Exercise: 3 stars, standard, optional (pup_to_n)</h4>


<div class="paragraph"> </div>

    Write an Imp program that sums the numbers from <span class="inlinecode">1</span> to
   <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> (inclusive: <span class="inlinecode">1</span> <span class="inlinecode">+</span> <span class="inlinecode">2</span> <span class="inlinecode">+</span> <span class="inlinecode">...</span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>) in the variable <span class="inlinecode"><a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a></span>.
   Prove that this program executes as intended for <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> = <span class="inlinecode">2</span>
   (this is trickier than you might expect). 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="pup_to_n"><span class="id" title="definition">pup_to_n</span></a> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="pup_to_2_ceval"><span class="id" title="lemma">pup_to_2_ceval</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 2<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">)</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#pup_to_n"><span class="id" title="axiom">pup_to_n</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">(</span></a><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 0 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 3 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 1 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 2 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a> <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">!-&gt;</span></a> 0 <a class="idref" href="Maps.html#8d30c24efec4c4217ffea53676b55c2e"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 2<a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab362"></a><h2 class="section">評価の決定性</h2>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
評価の定義を計算的なものから関係的なものに変更するのはとても良いことです。
    というのも、評価が全関数でなければならないという不自然な要求から解放されるからです。
    しかしこの変更は新たな疑問を生みます。
    2つ目の評価の定義は本当に部分関数なのか？
    それとも、同じ状態 <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> から始めて、あるコマンド <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> を違った方法で評価し、2つの異なる出力状態 <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> と <span class="inlinecode"><a class="idref" href="Imp.html#st''"><span class="id" title="variable">st''</span></a></span> に至るのが可能なのか？
    というものです。

<div class="paragraph"> </div>

    実際には、こうなることはありません。
    評価関係 <span class="inlinecode"><a class="idref" href="Auto.html#Repeat.ceval"><span class="id" title="inductive">ceval</span></a></span> は確かに部分関数です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="ceval_deterministic"><span class="id" title="lemma">ceval_deterministic</span></a>: <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st1</span> <span class="id" title="var">st2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st1"><span class="id" title="variable">st1</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st2"><span class="id" title="variable">st2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st1"><span class="id" title="variable">st1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#st2"><span class="id" title="variable">st2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st1</span> <span class="id" title="var">st2</span> <span class="id" title="var">E1</span> <span class="id" title="var">E2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">st2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">E1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st2</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">E2</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;-  <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">st'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">st'0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">EQ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{  <span class="id" title="tactic">apply</span> <span class="id" title="var">IHE1_1</span>; <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">st'0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHE1_2</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHE1</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H5</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHE1</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H4</span>.<br/>
&nbsp;&nbsp;- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">st'</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">st'0</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">EQ1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{  <span class="id" title="tactic">apply</span> <span class="id" title="var">IHE1_1</span>; <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">st'0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHE1_2</span>. <span class="id" title="tactic">assumption</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab363"></a><h1 class="section">Imp プログラムに関する推論</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
「プログラミング言語の基礎」では、Imp におけるプログラムの推論手法としてより強力で系統だったテクニックに触れていきます。
    しかし、そのままの定義を用いてもある程度は推論できます。
    いくつかの例を見ていきましょう。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="plus2_spec"><span class="id" title="lemma">plus2_spec</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">n</span> <span class="id" title="var">st'</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#plus2"><span class="id" title="definition">plus2</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 2.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st</span> <span class="id" title="var">n</span> <span class="id" title="var">st'</span> <span class="id" title="var">HX</span> <span class="id" title="var">Heval</span>.<br/>

<br/>
</div>

<div class="doc">
Inverting <span class="inlinecode"><span class="id" title="var">Heval</span></span> essentially forces Coq to expand one step of
      the <span class="inlinecode"><a class="idref" href="Auto.html#Repeat.ceval"><span class="id" title="inductive">ceval</span></a></span> computation -- in this case revealing that <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span>
      must be <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> extended with the new value of <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>, since <span class="inlinecode"><a class="idref" href="Imp.html#plus2"><span class="id" title="definition">plus2</span></a></span>
      is an assignment. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Heval</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heval</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Maps.html#t_update_eq"><span class="id" title="axiom">t_update_eq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab364"></a><h4 class="section">練習問題: ★★★, standard, recommended (XtimesYinZ_spec)</h4>


<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Imp.html#XtimesYinZ"><span class="id" title="definition">XtimesYinZ</span></a></span> の仕様を書いて証明しなさい。
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_XtimesYinZ_spec"><span class="id" title="definition">manual_grade_for_XtimesYinZ_spec</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab365"></a><h4 class="section">練習問題: ★★★, standard, recommended (loop_never_stops)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="loop_never_stops"><span class="id" title="lemma">loop_never_stops</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">~(</span></a><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#loop"><span class="id" title="definition">loop</span></a> <a class="idref" href="Imp.html#d602dfe99961027ee7b07f704d78b039"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#611abc97cba304de784fa909dbdea1fa"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">contra</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Imp.html#loop"><span class="id" title="definition">loop</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">contra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#9838f34589a76e1d4e404cd35557c73e"><span class="id" title="notation">SKIP</span></a> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a>)%<span class="id" title="var">imp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">loopdef</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eqn</span>:<span class="id" title="var">Heqloopdef</span>.<br/>

<br/>
</div>

<div class="doc">
Proceed by induction on the assumed derivation showing that
      <span class="inlinecode"><span class="id" title="var">loopdef</span></span> terminates.  Most of the cases are immediately
      contradictory (and so can be solved in one step with
      <span class="inlinecode"><span class="id" title="tactic">discriminate</span></span>). 
</div>
<div class="code">

<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab366"></a><h4 class="section">練習問題: ★★★, standard (no_whiles_eqv)</h4>


<div class="paragraph"> </div>

    以下の関数を考える。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span>.<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="no_whiles"><span class="id" title="definition">no_whiles</span></a> (<span class="id" title="var">c</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#9838f34589a76e1d4e404cd35557c73e"><span class="id" title="notation">SKIP</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="Imp.html#1415d381b898f10db78e714a0a964c11"><span class="id" title="notation">::=</span></a> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">c1</span> <a class="idref" href="Imp.html#5604146224f04ce8ff933bc02eb29824"><span class="id" title="notation">;;</span></a> <span class="id" title="var">c2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> (<a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a> <span class="id" title="var">c1</span>) (<a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a> <span class="id" title="var">c2</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">TEST</span></a> <span class="id" title="var">_</span> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">THEN</span></a> <span class="id" title="var">ct</span> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">ELSE</span></a> <span class="id" title="var">cf</span> <a class="idref" href="Imp.html#f24c9b004b84dc97722b1c3c18c5829f"><span class="id" title="notation">FI</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#andb"><span class="id" title="definition">andb</span></a> (<a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a> <span class="id" title="var">ct</span>) (<a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a> <span class="id" title="var">cf</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">WHILE</span></a> <span class="id" title="var">_</span> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">DO</span></a> <span class="id" title="var">_</span> <a class="idref" href="Imp.html#83a07334581e0deb166d05032f77769f"><span class="id" title="notation">END</span></a>  =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">imp_scope</span>.<br/>

<br/>
</div>

<div class="doc">
この性質はプログラムが while ループを含まない場合 <span class="inlinecode"><a class="idref" href="Basics.html#true"><span class="id" title="constructor">true</span></a></span> を返します。
    <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span> を使って <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> が while ループのないプログラムのとき、かつそのときに限り <span class="inlinecode"><a class="idref" href="Imp.html#no_whilesR"><span class="id" title="inductive">no_whilesR</span></a></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> が証明可能となる性質 <span class="inlinecode"><a class="idref" href="Imp.html#no_whilesR"><span class="id" title="inductive">no_whilesR</span></a></span> を書きなさい。
    さらに、それが <span class="inlinecode"><a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a></span> と等価であることを示しなさい。
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="no_whilesR"><span class="id" title="inductive">no_whilesR</span></a>: <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;<br/>
.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="no_whiles_eqv"><span class="id" title="lemma">no_whiles_eqv</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">c</span>, <a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#df1ced36fc33ce188051218bca314374"><span class="id" title="notation">&lt;-&gt;</span></a> <a class="idref" href="Imp.html#no_whilesR"><span class="id" title="inductive">no_whilesR</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab367"></a><h4 class="section">練習問題: ★★★★, standard (no_whiles_terminating)</h4>


<div class="paragraph"> </div>

    while ループを含まない Imp プログラムは必ず停止します。
    この性質を定理 <span class="inlinecode"><span class="id" title="var">no_whiles_terminating</span></span> として記述し、証明しなさい。

<div class="paragraph"> </div>

    <span class="inlinecode"><a class="idref" href="Imp.html#no_whiles"><span class="id" title="definition">no_whiles</span></a></span> と <span class="inlinecode"><a class="idref" href="Imp.html#no_whilesR"><span class="id" title="inductive">no_whilesR</span></a></span> のどちらでも好きなほうを使いなさい。 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_no_whiles_terminating"><span class="id" title="definition">manual_grade_for_no_whiles_terminating</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab368"></a><h1 class="section">追加の練習問題</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab369"></a><h4 class="section">練習問題: ★★★, standard (stack_compiler)</h4>


<div class="paragraph"> </div>

    古い HP の電卓、Forth や Postscript などのプログラミング言語、および Java Virtual Machine などの抽象機械はすべて、「スタック(<i>stack</i>)」を使って算術式を評価します。
    例えば、
<pre>
      (2*3)+(3*(4-2)) 
</pre>
   という式は
<pre>
      2 3 * 3 4 2 - * + 
</pre>
   と記述され、以下のように実行されるでしょう:
   （処理されるプログラムを右に、スタックの状態を左に書いています。）
<pre>
      [ ]           |    2 3 * 3 4 2 - * + 
      [2]           |    3 * 3 4 2 - * + 
      [3, 2]        |    * 3 4 2 - * + 
      [6]           |    3 4 2 - * + 
      [3, 6]        |    4 2 - * + 
      [4, 3, 6]     |    2 - * + 
      [2, 4, 3, 6]  |    - * + 
      [2, 3, 6]     |    * + 
      [6, 6]        |    + 
      [12]          | 
</pre>
  この練習問題の目標は、<span class="inlinecode"><a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a></span> をスタック機械の命令列に変換する小さなコンパイラを書き、その正当性を証明することです。

<div class="paragraph"> </div>

  スタック言語の命令セットは、以下の命令から構成されます:
<ul class="doclist">
<li> <span class="inlinecode"><a class="idref" href="Imp.html#SPush"><span class="id" title="constructor">SPush</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span>: 数 <span class="inlinecode"><a class="idref" href="Basics.html#n"><span class="id" title="variable">n</span></a></span> をスタックにプッシュする。

</li>
<li> <span class="inlinecode"><a class="idref" href="Imp.html#SLoad"><span class="id" title="constructor">SLoad</span></a></span> <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span>: ストアから識別子 <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> に対応する値を読み込み、スタックにプッシュする。

</li>
<li> <span class="inlinecode"><a class="idref" href="Imp.html#SPlus"><span class="id" title="constructor">SPlus</span></a></span>:   スタックの先頭の 2 つの数をポップし、それらを足して、
                  結果をスタックにプッシュする。

</li>
<li> <span class="inlinecode"><a class="idref" href="Imp.html#SMinus"><span class="id" title="constructor">SMinus</span></a></span>:  上と同様。ただし引く。

</li>
<li> <span class="inlinecode"><a class="idref" href="Imp.html#SMult"><span class="id" title="constructor">SMult</span></a></span>:   上と同様。ただし掛ける。 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="sinstr"><span class="id" title="inductive">sinstr</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
| <a name="SPush"><span class="id" title="constructor">SPush</span></a> (<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
| <a name="SLoad"><span class="id" title="constructor">SLoad</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>)<br/>
| <a name="SPlus"><span class="id" title="constructor">SPlus</span></a><br/>
| <a name="SMinus"><span class="id" title="constructor">SMinus</span></a><br/>
| <a name="SMult"><span class="id" title="constructor">SMult</span></a>.<br/>

<br/>
</div>

<div class="doc">
スタック言語のプログラムを評価するための関数を書きなさい。
    関数は入力として、状態、数のリストで表現されたスタック（スタックの先頭要素はリストの先頭）、および命令のリストで表現されたプログラムを受け取り、受け取ったプログラムの実行後のスタックを返す。
    下にある例で、その関数のテストをしなさい。

<div class="paragraph"> </div>

    上の仕様では、スタックが 2 つ未満の要素しか含まずに <span class="inlinecode"><a class="idref" href="Imp.html#SPlus"><span class="id" title="constructor">SPlus</span></a></span> や <span class="inlinecode"><a class="idref" href="Imp.html#SMinus"><span class="id" title="constructor">SMinus</span></a></span>、<span class="inlinecode"><a class="idref" href="Imp.html#SMult"><span class="id" title="constructor">SMult</span></a></span> 命令に至った場合を明示していないままなことに注意しましょう。
    我々のコンパイラはそのような不正な形式のプログラムは生成しないので、ある意味でこれは私たちがすることと無関係です。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="s_execute"><span class="id" title="definition">s_execute</span></a> (<span class="id" title="var">st</span> : <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a>) (<span class="id" title="var">stack</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">prog</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#sinstr"><span class="id" title="inductive">sinstr</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="s_execute1"><span class="id" title="definition">s_execute1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#s_execute"><span class="id" title="axiom">s_execute</span></a> <a class="idref" href="Imp.html#empty_st"><span class="id" title="definition">empty_st</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a><a class="idref" href="Imp.html#SPush"><span class="id" title="constructor">SPush</span></a> 5<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SPush"><span class="id" title="constructor">SPush</span></a> 3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SPush"><span class="id" title="constructor">SPush</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SMinus"><span class="id" title="constructor">SMinus</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a>2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> 5<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Example</span> <a name="s_execute2"><span class="id" title="definition">s_execute2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#s_execute"><span class="id" title="axiom">s_execute</span></a> (<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#ba84b24570fb3a89fbbf23462f3909cd"><span class="id" title="notation">!-&gt;</span></a> 3) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a>3<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a><a class="idref" href="Imp.html#SPush"><span class="id" title="constructor">SPush</span></a> 4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SLoad"><span class="id" title="constructor">SLoad</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SMult"><span class="id" title="constructor">SMult</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SPlus"><span class="id" title="constructor">SPlus</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a>15<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> 4<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
次に、<span class="inlinecode"><a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a></span> をスタック機械のプログラムにコンパイルする関数を書きなさい。
    このプログラムを実行した後の状態は、単に式の評価結果をスタックに積んだのと同じでなければなりません。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="s_compile"><span class="id" title="definition">s_compile</span></a> (<span class="id" title="var">e</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Imp.html#sinstr"><span class="id" title="inductive">sinstr</span></a><br/>
&nbsp;&nbsp;. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
After you've defined <span class="inlinecode"><a class="idref" href="Imp.html#s_compile"><span class="id" title="definition">s_compile</span></a></span>, prove the following to test
    that it works. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="s_compile1"><span class="id" title="definition">s_compile1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#s_compile"><span class="id" title="axiom">s_compile</span></a> (<a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a> <a class="idref" href="Imp.html#bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">-</span></a> <a class="idref" href="Imp.html#bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">(</span></a>2 <a class="idref" href="Imp.html#ecd9390a06cb87a38cb0a2350ca063ec"><span class="id" title="notation">*</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="Imp.html#bec100dd937ffc06b7e2521070b6294c"><span class="id" title="notation">)</span></a>)%<span class="id" title="var">imp</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a><a class="idref" href="Imp.html#SLoad"><span class="id" title="constructor">SLoad</span></a> <a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SPush"><span class="id" title="constructor">SPush</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SLoad"><span class="id" title="constructor">SLoad</span></a> <a class="idref" href="Imp.html#Y"><span class="id" title="definition">Y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SMult"><span class="id" title="constructor">SMult</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Imp.html#SMinus"><span class="id" title="constructor">SMinus</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab370"></a><h4 class="section">練習問題: ★★★★, advanced (stack_compiler_correct)</h4>


<div class="paragraph"> </div>

    一つ前の練習問題で実装したコンパイラの正当性を証明します。
    スタックに二つ未満しか要素がない状態で <span class="inlinecode"><a class="idref" href="Imp.html#SPlus"><span class="id" title="constructor">SPlus</span></a></span> や <span class="inlinecode"><a class="idref" href="Imp.html#SMinus"><span class="id" title="constructor">SMinus</span></a></span> 、 <span class="inlinecode"><a class="idref" href="Imp.html#SMult"><span class="id" title="constructor">SMult</span></a></span> 命令が来たときの仕様が規定されていないことを思い出してください。
    （正当性を簡単に示すために、戻って定義を書き換えた方が良いと気づくこともあるでしょう！）

<div class="paragraph"> </div>

    以下の定理を証明しなさい。
    まずは使える帰納法の仮定を得るため、より一般的な補題を述べる必要があるでしょう。
    主定理は補題の系として得られます。 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="s_compile_correct"><span class="id" title="lemma">s_compile_correct</span></a> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">st</span> : <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a>) (<span class="id" title="var">e</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#s_execute"><span class="id" title="axiom">s_execute</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> (<a class="idref" href="Imp.html#s_compile"><span class="id" title="axiom">s_compile</span></a> <a class="idref" href="Imp.html#e"><span class="id" title="variable">e</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Imp.html#aeval"><span class="id" title="definition">aeval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab371"></a><h4 class="section">Exercise: 3 stars, standard, optional (short_circuit)</h4>


<div class="paragraph"> </div>

    Most modern programming languages use a "short-circuit" evaluation
    rule for boolean <span class="inlinecode"><a class="idref" href="ProofObjects.html#Props.And.and"><span class="id" title="inductive">and</span></a></span>: to evaluate <span class="inlinecode"><a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#b1"><span class="id" title="variable">b1</span></a></span> <span class="inlinecode"><a class="idref" href="Basics.html#b2"><span class="id" title="variable">b2</span></a></span>, first evaluate
    <span class="inlinecode"><a class="idref" href="Basics.html#b1"><span class="id" title="variable">b1</span></a></span>.  If it evaluates to <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span>, then the entire <span class="inlinecode"><a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a></span>
    expression evaluates to <span class="inlinecode"><a class="idref" href="Basics.html#false"><span class="id" title="constructor">false</span></a></span> immediately, without evaluating
    <span class="inlinecode"><a class="idref" href="Basics.html#b2"><span class="id" title="variable">b2</span></a></span>.  Otherwise, <span class="inlinecode"><a class="idref" href="Basics.html#b2"><span class="id" title="variable">b2</span></a></span> is evaluated to determine the result of the
    <span class="inlinecode"><a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a></span> expression.

<div class="paragraph"> </div>

    Write an alternate version of <span class="inlinecode"><a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a></span> that performs short-circuit
    evaluation of <span class="inlinecode"><a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a></span> in this manner, and prove that it is
    equivalent to <span class="inlinecode"><a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a></span>.  (N.b. This is only true because expression
    evaluation in Imp is rather simple.  In a bigger language where
    evaluating an expression might diverge, the short-circuiting <span class="inlinecode"><a class="idref" href="Imp.html#BAnd"><span class="id" title="constructor">BAnd</span></a></span>
    would <i>not</i> be equivalent to the original, since it would make more
    programs terminate.) 
</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Module</span> <a name="BreakImp"><span class="id" title="module">BreakImp</span></a>.<br/>
</div>

<div class="doc">
<a name="lab372"></a><h4 class="section">Exercise: 4 stars, advanced (break_imp)</h4>


<div class="paragraph"> </div>

    Imperative languages like C and Java often include a <span class="inlinecode"><span class="id" title="var">break</span></span> or
    similar statement for interrupting the execution of loops. In this
    exercise we consider how to add <span class="inlinecode"><span class="id" title="var">break</span></span> to Imp.  First, we need to
    enrich the language of commands with an additional case. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="BreakImp.com"><span class="id" title="inductive">com</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="BreakImp.CSkip"><span class="id" title="constructor">CSkip</span></a><br/>
&nbsp;&nbsp;| <a name="BreakImp.CBreak"><span class="id" title="constructor">CBreak</span></a>                        <br/>
&nbsp;&nbsp;| <a name="BreakImp.CAss"><span class="id" title="constructor">CAss</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) (<span class="id" title="var">a</span> : <a class="idref" href="Imp.html#aexp"><span class="id" title="inductive">aexp</span></a>)<br/>
&nbsp;&nbsp;| <a name="BreakImp.CSeq"><span class="id" title="constructor">CSeq</span></a> (<span class="id" title="var">c1</span> <span class="id" title="var">c2</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>)<br/>
&nbsp;&nbsp;| <a name="BreakImp.CIf"><span class="id" title="constructor">CIf</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) (<span class="id" title="var">c1</span> <span class="id" title="var">c2</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>)<br/>
&nbsp;&nbsp;| <a name="BreakImp.CWhile"><span class="id" title="constructor">CWhile</span></a> (<span class="id" title="var">b</span> : <a class="idref" href="Imp.html#bexp"><span class="id" title="inductive">bexp</span></a>) (<span class="id" title="var">c</span> : <a class="idref" href="Imp.html#com"><span class="id" title="inductive">com</span></a>).<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="7f70e2897343b7d76650f4ac2027bdd6"><span class="id" title="notation">&quot;</span></a>'SKIP'" :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#BreakImp.CSkip"><span class="id" title="constructor">CSkip</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a name="2ef01607f686dd305e8697551d3617d9"><span class="id" title="notation">&quot;</span></a>'BREAK'" :=<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#BreakImp.CBreak"><span class="id" title="constructor">CBreak</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a name="1d621cca83da3e6ea01799f598e8cdb1"><span class="id" title="notation">&quot;</span></a>x '::=' a" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#BreakImp.CAss"><span class="id" title="constructor">CAss</span></a> <span class="id" title="var">x</span> <span class="id" title="var">a</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60).<br/>
<span class="id" title="keyword">Notation</span> <a name="733c60b89bda6acf05b699d895c51842"><span class="id" title="notation">&quot;</span></a>c1 ;; c2" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#BreakImp.CSeq"><span class="id" title="constructor">CSeq</span></a> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a name="3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">&quot;</span></a>'WHILE' b 'DO' c 'END'" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#BreakImp.CWhile"><span class="id" title="constructor">CWhile</span></a> <span class="id" title="var">b</span> <span class="id" title="var">c</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
<span class="id" title="keyword">Notation</span> <a name="56b6d0147d319ef2d0a309de6ad54432"><span class="id" title="notation">&quot;</span></a>'TEST' c1 'THEN' c2 'ELSE' c3 'FI'" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Imp.html#BreakImp.CIf"><span class="id" title="constructor">CIf</span></a> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">c3</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 80, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>

<br/>
</div>

<div class="doc">
Next, we need to define the behavior of <span class="inlinecode"><span class="id" title="var">BREAK</span></span>.  Informally,
    whenever <span class="inlinecode"><span class="id" title="var">BREAK</span></span> is executed in a sequence of commands, it stops
    the execution of that sequence and signals that the innermost
    enclosing loop should terminate.  (If there aren't any
    enclosing loops, then the whole program simply terminates.)  The
    final state should be the same as the one in which the <span class="inlinecode"><span class="id" title="var">BREAK</span></span>
    statement was executed.

<div class="paragraph"> </div>

    One important point is what to do when there are multiple loops
    enclosing a given <span class="inlinecode"><span class="id" title="var">BREAK</span></span>. In those cases, <span class="inlinecode"><span class="id" title="var">BREAK</span></span> should only
    terminate the <i>innermost</i> loop. Thus, after executing the
    following...

<div class="paragraph"> </div>

       X ::= 0;;
       Y ::= 1;;
       WHILE ~(0 = Y) DO
         WHILE true DO
           BREAK
         END;;
         X ::= 1;;
         Y ::= Y - 1
       END

<div class="paragraph"> </div>

    ... the value of <span class="inlinecode"><a class="idref" href="Imp.html#X"><span class="id" title="definition">X</span></a></span> should be <span class="inlinecode">1</span>, and not <span class="inlinecode">0</span>.

<div class="paragraph"> </div>

    One way of expressing this behavior is to add another parameter to
    the evaluation relation that specifies whether evaluation of a
    command executes a <span class="inlinecode"><span class="id" title="var">BREAK</span></span> statement: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="BreakImp.result"><span class="id" title="inductive">result</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a><br/>
&nbsp;&nbsp;| <a name="BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a>.<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;st '=[' c ']=&gt;' st' '/' s"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="var">st'</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>).<br/>

<br/>
</div>

<div class="doc">
Intuitively, <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> <span class="inlinecode">=[</span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> <span class="inlinecode">/</span> <span class="inlinecode"><a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a></span> means that, if <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> is started in
    state <span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span>, then it terminates in state <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> and either signals
    that the innermost surrounding loop (or the whole program) should
    exit immediately (<span class="inlinecode"><a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a></span>) or that execution should continue
    normally (<span class="inlinecode"><a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a></span>).

<div class="paragraph"> </div>

    The definition of the "<span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> <span class="inlinecode">=[</span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span> <span class="inlinecode">/</span> <span class="inlinecode"><a class="idref" href="Lists.html#s"><span class="id" title="variable">s</span></a></span>" relation is very
    similar to the one we gave above for the regular evaluation
    relation (<span class="inlinecode"><a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a></span> <span class="inlinecode">=[</span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a></span>) -- we just need to handle the
    termination signals appropriately:

<div class="paragraph"> </div>

<ul class="doclist">
<li> If the command is <span class="inlinecode"><span class="id" title="var">SKIP</span></span>, then the state doesn't change and
      execution of any enclosing loop can continue normally.

<div class="paragraph"> </div>


</li>
<li> If the command is <span class="inlinecode"><span class="id" title="var">BREAK</span></span>, the state stays unchanged but we
      signal a <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a></span>.

<div class="paragraph"> </div>


</li>
<li> If the command is an assignment, then we update the binding for
      that variable in the state accordingly and signal that execution
      can continue normally.

<div class="paragraph"> </div>


</li>
<li> If the command is of the form <span class="inlinecode"><span class="id" title="var">TEST</span></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><span class="id" title="var">THEN</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#R.c1"><span class="id" title="constructor">c1</span></a></span> <span class="inlinecode"><span class="id" title="var">ELSE</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#R.c2"><span class="id" title="constructor">c2</span></a></span> <span class="inlinecode"><span class="id" title="var">FI</span></span>, then
      the state is updated as in the original semantics of Imp, except
      that we also propagate the signal from the execution of
      whichever branch was taken.

<div class="paragraph"> </div>


</li>
<li> If the command is a sequence <span class="inlinecode"><a class="idref" href="IndProp.html#R.c1"><span class="id" title="constructor">c1</span></a></span> <span class="inlinecode">;;</span> <span class="inlinecode"><a class="idref" href="IndProp.html#R.c2"><span class="id" title="constructor">c2</span></a></span>, we first execute
      <span class="inlinecode"><a class="idref" href="IndProp.html#R.c1"><span class="id" title="constructor">c1</span></a></span>.  If this yields a <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a></span>, we skip the execution of <span class="inlinecode"><a class="idref" href="IndProp.html#R.c2"><span class="id" title="constructor">c2</span></a></span>
      and propagate the <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a></span> signal to the surrounding context;
      the resulting state is the same as the one obtained by
      executing <span class="inlinecode"><a class="idref" href="IndProp.html#R.c1"><span class="id" title="constructor">c1</span></a></span> alone. Otherwise, we execute <span class="inlinecode"><a class="idref" href="IndProp.html#R.c2"><span class="id" title="constructor">c2</span></a></span> on the state
      obtained after executing <span class="inlinecode"><a class="idref" href="IndProp.html#R.c1"><span class="id" title="constructor">c1</span></a></span>, and propagate the signal
      generated there.

<div class="paragraph"> </div>


</li>
<li> Finally, for a loop of the form <span class="inlinecode"><span class="id" title="var">WHILE</span></span> <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> <span class="inlinecode"><span class="id" title="var">DO</span></span> <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> <span class="inlinecode"><span class="id" title="var">END</span></span>, the
      semantics is almost the same as before. The only difference is
      that, when <span class="inlinecode"><a class="idref" href="Poly.html#MumbleGrumble.b"><span class="id" title="constructor">b</span></a></span> evaluates to true, we execute <span class="inlinecode"><a class="idref" href="IndProp.html#c"><span class="id" title="definition">c</span></a></span> and check the
      signal that it raises.  If that signal is <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a></span>, then the
      execution proceeds as in the original semantics. Otherwise, we
      stop the execution of the loop, and the resulting state is the
      same as the one resulting from the execution of the current
      iteration.  In either case, since <span class="inlinecode"><span class="id" title="var">BREAK</span></span> only terminates the
      innermost loop, <span class="inlinecode"><span class="id" title="var">WHILE</span></span> signals <span class="inlinecode"><a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a></span>. 
</li>
</ul>

<div class="paragraph"> </div>

 Based on the above description, complete the definition of the
    <span class="inlinecode"><a class="idref" href="Auto.html#Repeat.ceval"><span class="id" title="inductive">ceval</span></a></span> relation. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="BreakImp.ceval"><span class="id" title="inductive">ceval</span></a> : <a class="idref" href="Imp.html#BreakImp.com"><span class="id" title="inductive">com</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#BreakImp.result"><span class="id" title="inductive">result</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="Imp.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="BreakImp.E_Skip"><span class="id" title="constructor">E_Skip</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#BreakImp.CSkip"><span class="id" title="constructor">CSkip</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a><br/>
&nbsp;&nbsp;<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a name="086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">&quot;</span></a>st '=[' c ']=&gt;' st' '/' s" := (<a class="idref" href="Imp.html#ceval"><span class="id" title="inductive">ceval</span></a> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">s</span> <span class="id" title="var">st'</span>).<br/>

<br/>
</div>

<div class="doc">
Now prove the following properties of your definition of <span class="inlinecode"><a class="idref" href="Auto.html#Repeat.ceval"><span class="id" title="inductive">ceval</span></a></span>: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="BreakImp.break_ignore"><span class="id" title="lemma">break_ignore</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#2ef01607f686dd305e8697551d3617d9"><span class="id" title="notation">BREAK</span></a><a class="idref" href="Imp.html#733c60b89bda6acf05b699d895c51842"><span class="id" title="notation">;;</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="BreakImp.while_continue"><span class="id" title="lemma">while_continue</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">s</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">END</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <a name="BreakImp.while_stops_on_break"><span class="id" title="lemma">while_stops_on_break</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">END</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab373"></a><h4 class="section">Exercise: 3 stars, advanced, optional (while_break_true)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="BreakImp.while_break_true"><span class="id" title="lemma">while_break_true</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">WHILE</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">DO</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#3fd1e52a090806ce836276193f17f135"><span class="id" title="notation">END</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#BreakImp.SContinue"><span class="id" title="constructor">SContinue</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Imp.html#beval"><span class="id" title="definition">beval</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">exists</span></a> <span class="id" title="var">st''</span><a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="Imp.html#st''"><span class="id" title="variable">st''</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st'"><span class="id" title="variable">st'</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#BreakImp.SBreak"><span class="id" title="constructor">SBreak</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
<div class="paragraph"> </div>

<a name="lab374"></a><h4 class="section">Exercise: 4 stars, advanced, optional (ceval_deterministic)</h4>

</div>
<div class="code">
<span class="id" title="keyword">Theorem</span> <a name="BreakImp.ceval_deterministic"><span class="id" title="lemma">ceval_deterministic</span></a>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">c</span>:<a class="idref" href="Imp.html#BreakImp.com"><span class="id" title="inductive">com</span></a>) <span class="id" title="var">st</span> <span class="id" title="var">st1</span> <span class="id" title="var">st2</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st1"><span class="id" title="variable">st1</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#s1"><span class="id" title="variable">s1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st"><span class="id" title="variable">st</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">=[</span></a> <a class="idref" href="Imp.html#c"><span class="id" title="variable">c</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="Imp.html#st2"><span class="id" title="variable">st2</span></a> <a class="idref" href="Imp.html#086ae7c8f19c780f0834138ad70f19a8"><span class="id" title="notation">/</span></a> <a class="idref" href="Imp.html#s2"><span class="id" title="variable">s2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Imp.html#st1"><span class="id" title="variable">st1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#st2"><span class="id" title="variable">st2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">/\</span></a> <a class="idref" href="Imp.html#s1"><span class="id" title="variable">s1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.8.2/stdlib//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Imp.html#s2"><span class="id" title="variable">s2</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
 <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
<font size=-2>&#9744;</font> 
</div>
<div class="code">
<span class="id" title="keyword">End</span> <a class="idref" href="Imp.html#BreakImp"><span class="id" title="module">BreakImp</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab375"></a><h4 class="section">Exercise: 4 stars, standard, optional (add_for_loop)</h4>


<div class="paragraph"> </div>

    Add C-style <span class="inlinecode"><span class="id" title="keyword">for</span></span> loops to the language of commands, update the
    <span class="inlinecode"><a class="idref" href="Auto.html#Repeat.ceval"><span class="id" title="inductive">ceval</span></a></span> definition to define the semantics of <span class="inlinecode"><span class="id" title="keyword">for</span></span> loops, and add
    cases for <span class="inlinecode"><span class="id" title="keyword">for</span></span> loops as needed so that all the proofs in this
    file are accepted by Coq.

<div class="paragraph"> </div>

    A <span class="inlinecode"><span class="id" title="keyword">for</span></span> loop should be parameterized by (a) a statement executed
    initially, (b) a test that is run on each iteration of the loop to
    determine whether the loop should continue, (c) a statement
    executed at the end of each loop iteration, and (d) a statement
    that makes up the body of the loop.  (You don't need to worry
    about making up a concrete Notation for <span class="inlinecode"><span class="id" title="keyword">for</span></span> loops, but feel free
    to play with this too if you like.) 
</div>
<div class="code">

<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">表紙</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a><hr/>
<a href="https://github.com/sfja/sfja">ソフトウェアの基礎 日本語化プロジェクト</a>
</div>

</div>

</body>
</html>
